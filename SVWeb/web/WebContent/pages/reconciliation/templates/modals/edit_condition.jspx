<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<f:view>
    <ui:composition>
        <rich:modalPanel id="conditionModalPanel" autosized="true" minWidth="200" minHeight="100">
            <f:facet name="header">
                <h:panelGroup id="conditionModalHeader">
                    <h:outputText value="#{lblRec.new_rec_condition}" rendered="#{MbRcnConditions.newMode}"/>
                    <h:outputText value="#{lblRec.edit_rec_condition}" rendered="#{MbRcnConditions.editMode}"/>
                </h:panelGroup>
            </f:facet>
            <f:facet name="controls"/>

            <h:form id="conditionEditForm">
                <script type="text/javascript">
                    //<!--
                    function checkConditionFields() {
                        var checked = true;
                        if (document.getElementById('conditionEditForm:instId').value == "") {
                            document.getElementById('conditionEditForm:instIdError').style.display = "inline";
                            checked = false;
                        }
                        if (document.getElementById('conditionEditForm:newReconType').value == "") {
                            document.getElementById('conditionEditForm:newReconTypeError').style.display = "inline";
                            checked = false;
                        }
                        if (document.getElementById('conditionEditForm:newConditionType').value == "") {
                            document.getElementById('conditionEditForm:newConditionTypeError').style.display = "inline";
                            checked = false;
                        }
                        if (document.getElementById('conditionEditForm:newPurpose') != null) {
                            if (document.getElementById('conditionEditForm:newPurpose').value == "") {
                                document.getElementById('conditionEditForm:newPurposeError').style.display = "inline";
                                checked = false;
                            }
                        }
                        if (document.getElementById('conditionEditForm:newProvider') != null) {
                            if (document.getElementById('conditionEditForm:newProvider').value == "") {
                                document.getElementById('conditionEditForm:newProviderError').style.display = "inline";
                                checked = false;
                            }
                        }
                        return checked;
                    }
                    //-->
                </script>

                <h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
                    <h:panelGrid columns="2" styleClass="cardholderdata" width="100%" columnClasses="firstColModal, width250">
                        <h:outputLabel value="* #{lblCommon.institution}: " title="#{lblCommon.institution}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                            <h:selectOneMenu id="instId"
                                             value="#{MbRcnConditions.newCondition.instId}"
                                             label="#{lblCommon.institution}"
                                             onblur="hideErrorField(this)"
                                             disabled="#{MbRcnConditions.editMode}">
                                <f:selectItem itemValue=""/>
                                <f:selectItems value="#{MbRcnConditions.institutions}"/>
                            </h:selectOneMenu>
                            <h:outputFormat id="instIdError"
                                            value="#{lblMsg.value_request}" styleClass="errorMarker"
                                            style="display:none;">
                                <f:param name="fieldName" value="#{lblCommon.institution}"/>
                            </h:outputFormat>
                        </h:panelGrid>

                        <h:outputLabel value="#{lblCommon.name}: " title="#{lblCommon.name}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                            <h:inputText id="newName" maxlength="200"
                                         value="#{MbRcnConditions.newCondition.name}"
                                         label="#{lblCommon.name}">
                                <f:validateLength minimum="3"/>
                                <a4j:support event="onchange" limitToList="true" ajaxSingle="true"/>
                            </h:inputText>
                        </h:panelGrid>

                        <h:outputLabel value="* #{lblRec.recon_type}: " title="#{lblRec.recon_type}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                            <h:selectOneMenu id="newReconType"
                                             value="#{MbRcnConditions.newCondition.reconType}"
                                             label="#{lblRec.recon_type}"
                                             onblur="hideErrorField(this)">
                                <f:selectItem itemValue=""/>
                                <f:selectItems value="#{MbRcnConditions.reconciliationTypes}"/>
                            </h:selectOneMenu>
                            <h:outputFormat id="newReconTypeError"
                                            value="#{lblMsg.value_request}" styleClass="errorMarker"
                                            style="display:none;">
                                <f:param name="fieldName" value="#{lblRec.recon_type}"/>
                            </h:outputFormat>
                        </h:panelGrid>

                        <h:outputLabel value="* #{lblRec.condition_type}: " title="#{lblRec.condition_type}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                            <h:selectOneMenu id="newConditionType"
                                             value="#{MbRcnConditions.newCondition.condType}"
                                             label="#{lblRec.condition_type}"
                                             onblur="hideErrorField(this)">
                                <f:selectItem itemValue=""/>
                                <f:selectItems value="#{MbRcnConditions.conditionTypes}"/>
                            </h:selectOneMenu>
                            <h:outputFormat id="newConditionTypeError"
                                            value="#{lblMsg.value_request}" styleClass="errorMarker"
                                            style="display:none;">
                                <f:param name="fieldName" value="#{lblRec.condition_type}"/>
                            </h:outputFormat>
                        </h:panelGrid>

                        <h:outputLabel value="* #{lblPmo.provider}: " title="#{lblPmo.provider}"
                                       rendered="#{MbRcnConditions.isRendered('provider')}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0"
                                     rendered="#{MbRcnConditions.isRendered('provider')}">
                            <h:selectOneMenu id="newProvider"
                                             value="#{MbRcnConditions.newCondition.providerId}"
                                             label="#{lblPmo.provider}"
                                             onblur="hideErrorField(this)">
                                <f:selectItem itemValue=""/>
                                <f:selectItems value="#{MbRcnConditions.providers}"/>
                                <a4j:support event="onchange"
                                             reRender="newPurpose"
                                             ajaxSingle="true"
                                             limitToList="true"/>
                            </h:selectOneMenu>
                            <h:outputFormat id="newProviderError"
                                            value="#{lblMsg.value_request}" styleClass="errorMarker"
                                            style="display:none;">
                                <f:param name="fieldName" value="#{lblPmo.provider}"/>
                            </h:outputFormat>
                        </h:panelGrid>

                        <h:outputLabel value="* #{lblPmo.purpose}: " title="#{lblPmo.purpose}"
                                       rendered="#{MbRcnConditions.isRendered('purpose')}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0"
                                     rendered="#{MbRcnConditions.isRendered('purpose')}">
                            <h:selectOneMenu id="newPurpose"
                                             value="#{MbRcnConditions.newCondition.purposeId}"
                                             label="#{lblPmo.purpose}"
                                             onblur="hideErrorField(this)">
                                <f:selectItem itemValue=""/>
                                <f:selectItems value="#{MbRcnConditions.purposes}"/>
                            </h:selectOneMenu>
                            <h:outputFormat id="newPurposeError"
                                            value="#{lblMsg.value_request}" styleClass="errorMarker"
                                            style="display:none;">
                                <f:param name="fieldName" value="#{lblPmo.purpose}"/>
                            </h:outputFormat>
                        </h:panelGrid>

                        <h:outputLabel value="#{lblCommon.language}: " title="#{lblCommon.language}"/>
                        <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                            <h:selectOneMenu id="language"
                                             value="#{MbRcnConditions.newCondition.lang}"
                                             label="#{lblCommon.language}"
                                             onblur="hideErrorField(this)"
                                             disabled="#{MbRcnConditions.editMode}">
                                <f:selectItems value="#{MbRcnConditions.languages}"/>
                            </h:selectOneMenu>
                        </h:panelGrid>

                        <h:outputLabel value="#{lblOpr.condition}: " title="#{lblOpr.condition}"/>
                        <h:inputTextarea id="newCondition" value="#{MbRcnConditions.newCondition.condition}"
                                         rows="5" cols="150"
                                         onkeypress="if (!limitText(event,this,1000)) return false;" label="#{lblOpr.condition}">
                            <f:validateLength maximum="1000" />
                        </h:inputTextarea>
                    </h:panelGrid>
                </h:panelGroup>

                <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
                    <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
                        <h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
                            <h:outputText/>
                            <bre:taggedCommandButton value="#{lblForm.save}"
                                                     type="submit"
                                                     action="#{MbRcnConditions.save}"
                                                     reRender="conditionsForm, conditionsBtnForm, detailsTab"
                                                     onclick="if (!checkConditionFields()) return false; disableModalPanelBtns(this)"
                                                     oncomplete="enableModalPanelBtns(this);
                                                                 if (#{usession.noErrorResponse}) {
                                                                     #{rich:component('conditionModalPanel')}.hide();
                                                                 }"/>
                            <bre:taggedCommandButton value="#{lblForm.cancel}"
                                                     action="#{MbRcnConditions.cancel}"
                                                     immediate="true"
                                                     limitToList="true"
                                                     oncomplete="#{rich:component('conditionModalPanel')}.hide()"
                                                     reRender="conditionEditForm">
                                <f:actionListener type="ru.bpc.jsf.A4JFormReset" />
                            </bre:taggedCommandButton>
                        </h:panelGrid>
                    </h:panelGroup>
                </h:panelGroup>
            </h:form>
        </rich:modalPanel>
    </ui:composition>
</f:view>
</html>