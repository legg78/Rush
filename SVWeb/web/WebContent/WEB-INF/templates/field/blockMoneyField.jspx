<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:bm="http://www.bpc.ru/jsf/misc"
      xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
      xmlns:c="http://java.sun.com/jstl/core">
<ui:composition>
    <h:outputLabel id="#{attribute}_LABEL"
                   for="#{attribute}"
                   value="#{bean.objectAttrs[attribute].shortDesc} #{bean.objectAttrs[attribute].minCount == 1?'*':''}:"
                   rendered="#{bean.objectAttrs[attribute].visible}"
                   title="#{bean.objectAttrs[attribute].shortDesc}" />

    <h:panelGroup layout="block" rendered="#{bean.objectAttrs[attribute].visible}">
        <h:panelGrid cellpadding="0" cellspacing="0" columns="1" >
            <h:inputText id="#{attribute}"
                         value="#{value}"
                         label="#{bean.objectAttrs[attribute].shortDesc}"
                         disabled="#{!bean.objectAttrs[attribute].updatable}"
                         rendered="#{bean.objectAttrs[attribute].visible}"
                         maxlength="#{bean.objectAttrs[attribute].maxLength}"
                         onkeypress="if (!numbersOnly(this, event, true)) {return false;}">
                <bm:numericMaskConverter numericType="double" />
                <f:attribute name="decDigits"
                             value="#{CurrencyUtils.currencyObjectsMap[currency].exponent}" />

                <a4j:support event="onchange"
                             rendered="#{bean.objectAttrs[attribute].dependence}"
                             action="#{bean.applyDependence}"
                             reRender="#{bean.dependentElements}">
                    <a4j:actionparam assignTo="#{bean.elementName}" value="#{attribute}" />
                </a4j:support>

                <a4j:support event="onkeypress" ajaxSingle="true" limitToList="true" reRender="#{attribute}"/>
            </h:inputText>

            <bm:jsMask for="#{attribute}"
                       decDigits="#{CurrencyUtils.currencyObjectsMap[currency].exponent}" />
        </h:panelGrid>

        <h:panelGroup>
            <h:graphicImage url="/images/icon_warning.png"
                            rendered="#{!bean.objectAttrs[attribute].valid}"
                            height="16px"
                            width="16px"
                            title="#{lblApp.element_invalid_format}" />
            <h:graphicImage url="/images/stop-icon.png"
                            rendered="#{!bean.objectAttrs[attribute].validRequired}"
                            height="16px"
                            width="16px"
                            title="#{lblApp.element_is_required}" />
        </h:panelGroup>
    </h:panelGroup>
</ui:composition>
</html>