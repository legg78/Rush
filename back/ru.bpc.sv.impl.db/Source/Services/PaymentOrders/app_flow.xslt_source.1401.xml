<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:ns="http://sv.bpc.in/SVAP">
<xsl:template match="/ns:application">
<application xmlns="http://sv.bpc.in/SVAP">                      
    <application_number><xsl:value-of select="ns:application_number"/></application_number>
    <application_date><xsl:value-of select="ns:application_date"/></application_date>
    <application_type>APTPPMNO</application_type>
    <application_flow_id>1401</application_flow_id>
    <application_status>APST0006</application_status>
    <operator_id><xsl:value-of select="ns:operator_id"/></operator_id>
    <institution_id><xsl:value-of select="ns:institution_id"/></institution_id>
    <customer_type>ENTTCOMP</customer_type>
    <xsl:if test="ns:customer">    
        <customer id="customer_1">
            <command><xsl:value-of select="ns:customer/ns:command"/></command>
            <customer_category><xsl:value-of select="ns:customer/ns:customer_category"/></customer_category>
            <customer_number><xsl:value-of select="ns:customer/ns:customer_number"/></customer_number>
            <customer_relation><xsl:value-of select="ns:customer/ns:customer_relation"/></customer_relation>
            <resident><xsl:value-of select="ns:customer/ns:resident"/></resident>
            <nationality><xsl:value-of select="ns:customer/ns:nationality"/></nationality>
            <credit_rating><xsl:value-of select="ns:customer/ns:credit_rating"/></credit_rating>
            <money_laundry_risk><xsl:value-of select="ns:customer/ns:money_laundry_risk"/></money_laundry_risk>
            <money_laundry_reason><xsl:value-of select="ns:customer/ns:money_laundry_reason"/></money_laundry_reason>
            <contract id="contract_1">
                <command><xsl:value-of select="ns:customer/ns:contract/ns:command"/></command>
                <xsl:choose>
                    <xsl:when test="ns:customer/ns:contract/ns:contract_type">
                        <contract_type><xsl:value-of select="ns:customer/ns:contract/ns:contract_type"/></contract_type>
                    </xsl:when>
                    <xsl:otherwise>
                        <contract_type>CNTPSRVP</contract_type>
                    </xsl:otherwise>
                </xsl:choose>   
                <product_id><xsl:value-of select="ns:customer/ns:contract/ns:product_id"/></product_id>
                <contract_number><xsl:value-of select="ns:customer/ns:contract/ns:contract_number"/></contract_number>
                <start_date><xsl:value-of select="ns:customer/ns:contract/ns:start_date"/></start_date>
                <xsl:if test="ns:customer/ns:contract/ns:end_date">
                    <end_date><xsl:value-of select="ns:customer/ns:contract/ns:end_date"/></end_date>
                </xsl:if>
                <xsl:for-each select="ns:customer/ns:contract/ns:account">
                    <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                    <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                    <xsl-if test="ns:command">
                        <command><xsl:value-of select="ns:command"/></command>
                    </xsl-if>
                    <xsl-if test="ns:account_number">
                        <account_number><xsl:value-of select="ns:account_number"/></account_number>
                    </xsl-if>
                    <xsl-if test="ns:currency">
                        <currency><xsl:value-of select="ns:currency"/></currency>
                    </xsl-if>
                    <xsl-if test="ns:account_type">
                        <account_type><xsl:value-of select="ns:account_type"/></account_type>
                    </xsl-if>
                    <xsl-if test="ns:account_status">
                        <account_status><xsl:value-of select="ns:account_status"/></account_status>
                    </xsl-if>
                    <xsl:for-each select="ns:payment_order">
                        <payment_purpose_id><xsl:value-of select="ns:payment_purpose_id"/></payment_purpose_id>
                        <xsl-if test="ns:payment_amount">
                            <payment_amount><xsl:value-of select="ns:payment_amount"/></payment_amount>
                        </xsl-if>
                        <xsl-if test="ns:currency">
                            <currency><xsl:value-of select="ns:currency"/></currency>
                        </xsl-if>
                        <xsl-if test="ns:payment_amount_algo">
                            <payment_amount_algo><xsl:value-of select="ns:payment_amount_algo"/></payment_amount_algo>
                        </xsl-if>
                        <xsl-if test="ns:payment_date">
                            <payment_date><xsl:value-of select="ns:payment_date"/></payment_date>
                        </xsl-if>
                        <xsl-if test="ns:is_payment_order_template">
                            <is_payment_order_template><xsl:value-of select="ns:is_payment_order_template"/></is_payment_order_template>
                        </xsl-if>
                        <xsl-if test="ns:event_type">
                            <event_type><xsl:value-of select="ns:event_type"/></event_type>
                        </xsl-if>
                    </xsl:for-each>
                    <xsl-if test="ns:account_object">
                        <account_object>
                            <account_link_flag>
                                <xsl:value-of select="ns:customer/ns:contract/ns:account/ns:account_object/ns:account_link_flag"/>
                            </account_link_flag>
                        </account_object>
                    </xsl-if>
                </xsl:for-each>
                <xsl:for-each select="ns:customer/ns:contract/ns:service">
                    <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                    <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                    <xsl:for-each select="ns:service_object">
                        <xsl:attribute name="ref-id"><xsl:value-of select="@ref-id"/></xsl:attribute>

                        <xsl:for-each select="ns:attribute_char">
                            <xsl:element name="attribute_char">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                                <attribute_value_char><xsl:value-of select="ns:attribute_value_char"/></attribute_value_char>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                        <xsl:for-each select="ns:attribute_num">
                            <xsl:element name="attribute_num">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                                <attribute_value_num><xsl:value-of select="ns:attribute_value_num"/></attribute_value_num>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                        <xsl:for-each select="ns:attribute_date">
                            <xsl:element name="attribute_date">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>

                                <attribute_value_date><xsl:value-of select="ns:attribute_value_date"/></attribute_value_date>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                        <xsl:for-each select="ns:attribute_fee">
                            <xsl:element name="attribute_date">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                                <xsl-if test="ns:fee_percent_value">
                                    <fee_percent_value><xsl:value-of select="ns:fee_percent_value"/></fee_percent_value>
                                </xsl-if>
                                <xsl-if test="ns:fee_fixed_value">
                                    <fee_fixed_value><xsl:value-of select="ns:fee_fixed_value"/></fee_fixed_value>
                                </xsl-if>
                                <xsl-if test="ns:fee_rate_calc">
                                    <fee_rate_calc><xsl:value-of select="ns:fee_rate_calc"/></fee_rate_calc>
                                </xsl-if>
                                <xsl-if test="ns:currency">
                                    <currency><xsl:value-of select="ns:currency"/></currency>
                                </xsl-if>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                        <xsl:for-each select="ns:attribute_cycle">
                            <xsl:element name="attribute_cycle">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                                <xsl-if test="ns:cycle_start_date">
                                    <cycle_start_date><xsl:value-of select="ns:cycle_start_date"/></cycle_start_date>
                                </xsl-if>
                                <xsl-if test="ns:cycle_length">
                                    <cycle_length><xsl:value-of select="ns:cycle_length"/></cycle_length>
                                </xsl-if>
                                <xsl-if test="ns:cycle_length_type">
                                    <cycle_length_type><xsl:value-of select="ns:cycle_length_type"/></cycle_length_type>
                                </xsl-if>
                                <xsl-if test="ns:currency">
                                    <currency><xsl:value-of select="ns:currency"/></currency>
                                </xsl-if>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                        <xsl:for-each select="ns:attribute_limit">
                            <xsl:element name="attribute_limit">
                                <xsl:attribute name="value"><xsl:value-of select="@value"/></xsl:attribute>
                                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                                <xsl-if test="ns:limit_count_value">
                                    <limit_count_value><xsl:value-of select="ns:limit_count_value"/></limit_count_value>
                                </xsl-if>
                                <xsl-if test="ns:limit_sum_value">
                                    <limit_sum_value><xsl:value-of select="ns:limit_sum_value"/></limit_sum_value>
                                </xsl-if>
                                <xsl-if test="ns:currency">
                                    <currency><xsl:value-of select="ns:currency"/></currency>
                                </xsl-if>
                                <xsl-if test="ns:start_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                                <xsl-if test="ns:end_date">
                                    <start_date><xsl:value-of select="ns:start_date"/></start_date>
                                </xsl-if>
                            </xsl:element>
                        </xsl:for-each>
                    </xsl:for-each>   
                </xsl:for-each>
            </contract>
            <company id="company_1">
                <command><xsl:value-of select="ns:customer/ns:company/ns:command"/></command>
                <incorp_form><xsl:value-of select="ns:customer/ns:company/ns:incorp_form"/></incorp_form>
                <xsl:for-each select="ns:customer/ns:company/ns:company_name">
                    <xsl:element name="company_name">
                        <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                        <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                            <company_short_name><xsl:value-of select="ns:company_short_name"/></company_short_name>
                            <company_full_name><xsl:value-of select="ns:company_full_name"/></company_full_name>
                    </xsl:element>
                </xsl:for-each>
                <presence_on_location><xsl:value-of select="ns:customer/ns:company/ns:presence_on_location"/></presence_on_location>
                <authorized_capital><xsl:value-of select="ns:customer/ns:company/ns:authorized_capital"/></authorized_capital>
                <authorized_capital_currency><xsl:value-of select="ns:customer/ns:company/ns:authorized_capital_currency"/></authorized_capital_currency>
                <xsl:for-each select="ns:customer/ns:company/ns:identity_card">
                <xsl:element name="identity_card">
                    <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                    <command><xsl:value-of select="ns:command"/></command>
                    <id_type><xsl:value-of select="ns:id_type"/></id_type>
                    <id_series><xsl:value-of select="ns:id_series"/></id_series>
                    <id_number><xsl:value-of select="ns:id_number"/></id_number>
                    <id_issuer><xsl:value-of select="ns:id_issuer"/></id_issuer>
                    <id_issue_date><xsl:value-of select="ns:id_issue_date"/></id_issue_date>
                    <id_expire_date><xsl:value-of select="ns:id_expire_date"/></id_expire_date>
                    <id_desc><xsl:value-of select="ns:id_desc"/></id_desc>
                </xsl:element>
                </xsl:for-each>
            </company>
            <xsl:for-each select="ns:customer/ns:contact">
                <xsl:element name="contact">
                    <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                    <command><xsl:value-of select="ns:command"/></command>
                    <contact_type><xsl:value-of select="ns:contact_type"/></contact_type>
                    <preferred_lang><xsl:value-of select="ns:preferred_lang"/></preferred_lang>
                    <person id="person_1">
                        <command><xsl:value-of select="ns:person/ns:command"/></command>
                        <person_title><xsl:value-of select="ns:person/ns:person_title"/></person_title>
                        <xsl:for-each select="ns:person/ns:person_name">
                        <xsl:element name="person_name">
                            <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                            <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                            <surname><xsl:value-of select="ns:surname"/></surname>
                            <first_name><xsl:value-of select="ns:first_name"/></first_name>
                            <second_name><xsl:value-of select="ns:second_name"/></second_name>
                        </xsl:element>
                        </xsl:for-each>
                        <suffix><xsl:value-of select="ns:person/ns:suffix"/></suffix>
                        <birthday><xsl:value-of select="ns:person/ns:birthday"/></birthday>
                        <gender><xsl:value-of select="ns:person/ns:gender"/></gender>
                        <xsl:for-each select="ns:person/ns:identity_card">
                        <xsl:element name="identity_card">
                            <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                            <command><xsl:value-of select="ns:command"/></command>
                            <id_type><xsl:value-of select="ns:id_type"/></id_type>
                            <id_series><xsl:value-of select="ns:id_series"/></id_series>
                            <id_number><xsl:value-of select="ns:id_number"/></id_number>
                            <id_issuer><xsl:value-of select="ns:id_issuer"/></id_issuer>
                            <id_issue_date><xsl:value-of select="ns:id_issue_date"/></id_issue_date>
                            <id_expire_date><xsl:value-of select="ns:id_expire_date"/></id_expire_date>
                        </xsl:element>
                        </xsl:for-each>
                    </person>
                    <xsl:for-each select="ns:contact_data">
                    <xsl:element name="contact_data">
                        <commun_method><xsl:value-of select="ns:commun_method"/></commun_method>
                        <commun_address><xsl:value-of select="ns:commun_address"/></commun_address>
                    </xsl:element>
                    </xsl:for-each>
                </xsl:element>
            </xsl:for-each>
            <xsl:for-each select="ns:customer/ns:address">
            <xsl:element name="address">
                <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                <command><xsl:value-of select="ns:command"/></command>
                <address_type><xsl:value-of select="ns:address_type"/></address_type>
                <country><xsl:value-of select="ns:country"/></country>
                <xsl:for-each select="ns:address_name">
                    <xsl:element name="address_name">
                        <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
                        <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                            <region><xsl:value-of select="ns:region"/></region>
                            <city><xsl:value-of select="ns:city"/></city>
                            <street><xsl:value-of select="ns:street"/></street>
                    </xsl:element>
                </xsl:for-each>
                <house><xsl:value-of select="ns:house"/></house>
                <apartment><xsl:value-of select="ns:apartment"/></apartment>
                <postal_code><xsl:value-of select="ns:postal_code"/></postal_code>
            </xsl:element>
            </xsl:for-each>
        </customer>
    </xsl:if>
    <payment_purpose>
        <command><xsl:value-of select="ns:payment_purpose/ns:command"/></command>
        <xsl:if test="ns:payment_purpose/ns:object_id">
            <object_id><xsl:value-of select="ns:payment_purpose/ns:object_id"/></object_id>
        </xsl:if>
        <operation_type>OPTP0060</operation_type>
        <xsl:if test="ns:payment_purpose/ns:mcc">
            <mcc><xsl:value-of select="ns:payment_purpose/ns:mcc"/></mcc>
        </xsl:if>
        <xsl:if test="ns:payment_purpose/ns:payment_purpose_number">
            <payment_purpose_number><xsl:value-of select="ns:payment_purpose/ns:payment_purpose_number"/></payment_purpose_number>
        </xsl:if>
        <xsl:for-each select="ns:label">
            <xsl:element name="label">
                <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                <xsl:value-of select="."/>
            </xsl:element>
        </xsl:for-each>
        <xsl:if test="ns:payment_purpose/ns:terminal_id">
            <terminal_id><xsl:value-of select="ns:payment_purpose/ns:terminal_id"/></terminal_id>
        </xsl:if>
        <payment_service>
            <command><xsl:value-of select="ns:payment_purpose/ns:payment_service/ns:command"/></command>
            <xsl:if test="ns:payment_purpose/ns:payment_service/ns:object_id">
                <object_id><xsl:value-of select="ns:payment_purpose/ns:payment_service/ns:object_id"/></object_id>
            </xsl:if>
            <xsl:for-each select="ns:payment_purpose/ns:payment_service/ns:label">
                <xsl:element name="label">
                    <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                    <xsl:value-of select="."/>
                </xsl:element>
            </xsl:for-each>
            <xsl:if test="ns:payment_purpose/ns:payment_service/ns:short_name">
                <short_name><xsl:value-of select="ns:payment_purpose/ns:payment_service/ns:short_name"/></short_name>
            </xsl:if>
            <xsl:for-each select="ns:payment_purpose/ns:payment_service/ns:description">
                <xsl:element name="description">
                    <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                    <xsl:value-of select="."/>
                </xsl:element>
            </xsl:for-each>
            <xsl:if test="ns:payment_purpose/ns:payment_service/ns:direction">
                <direction><xsl:value-of select="ns:payment_purpose/ns:payment_service/ns:direction"/></direction>
            </xsl:if>    
        </payment_service>
        <service_provider>
            <command><xsl:value-of select="ns:command"/></command>
            <xsl:if test="ns:object_id">
                <object_id><xsl:value-of select="ns:object_id"/></object_id>
            </xsl:if>
            <xsl:for-each select="ns:label">
                <xsl:element name="label">
                    <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                    <xsl:value-of select="."/>
                </xsl:element>
            </xsl:for-each>
            <xsl:if test="ns:short_name">
                <short_name><xsl:value-of select="ns:short_name"/></short_name>
            </xsl:if>
            <xsl:for-each select="ns:description">
                <xsl:element name="description">
                    <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                    <xsl:value-of select="."/>
                </xsl:element>
            </xsl:for-each>
            <xsl:if test="ns:region_code">
                <region_code><xsl:value-of select="ns:region_code"/></region_code>
            </xsl:if>
            <xsl:if test="ns:provider_number">
                <provider_number><xsl:value-of select="ns:provider_number"/></provider_number>
            </xsl:if>
        </service_provider>
        <xsl:for-each select="ns:payment_purpose/ns:payment_parameter">
            <payment_parameter>
                <command><xsl:value-of select="ns:command"/></command>
                <xsl:if test="ns:object_id">
                    <object_id><xsl:value-of select="ns:object_id"/></object_id>
                </xsl:if>
                <xsl:if test="ns:payment_parameter_name">
                    <payment_parameter_name><xsl:value-of select="ns:payment_parameter_name"/></payment_parameter_name>
                </xsl:if>
                <xsl:if test="ns:data_type">
                    <data_type><xsl:value-of select="ns:data_type"/></data_type>
                </xsl:if>
                <xsl:if test="ns:lov_id">
                    <lov_id><xsl:value-of select="ns:lov_id"/></lov_id>
                </xsl:if>
                <xsl:if test="ns:pattern">
                    <pattern><xsl:value-of select="ns:pattern"/></pattern>
                </xsl:if>
                <xsl:for-each select="ns:label">
                    <xsl:element name="label">
                        <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                        <xsl:value-of select="."/>
                    </xsl:element>
                </xsl:for-each>
                <xsl:for-each select="ns:description">
                    <xsl:element name="description">
                        <xsl:attribute name="language"><xsl:value-of select="@language"/></xsl:attribute>
                        <xsl:value-of select="."/>
                    </xsl:element>
                </xsl:for-each>
            </payment_parameter>
        </xsl:for-each>
    </payment_purpose>
</application>
</xsl:template>
</xsl:stylesheet>