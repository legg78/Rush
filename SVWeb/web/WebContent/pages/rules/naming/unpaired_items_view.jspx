<?xml version="1.0" encoding="UTF-8"?>
<html	xmlns="http://www.w3.org/1999/xhtml"
         xmlns:f="http://java.sun.com/jsf/core"
         xmlns:h="http://java.sun.com/jsf/html"
         xmlns:ui="http://java.sun.com/jsf/facelets"
         xmlns:a4j="http://richfaces.org/a4j"
         xmlns:rich="http://richfaces.org/rich"
         xmlns:bm="http://www.bpc.ru/jsf/misc"
         xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
         xmlns:bpct="http://www.bpc.ru/jsf/tiles">
<ui:composition>
    <rich:modalPanel id="unpairedCaseCreationMP" autosized="true" minWidth="1300" minHeight="600">
        <f:facet name="header">
            <h:outputText value="Unpaired case creation" />
        </f:facet>

        <f:facet name="controls"/>

        <h:form id="unpairedCaseCreationForm">
            <h:panelGroup styleClass="search_block" layout="block">
                <h:panelGrid styleClass="filter-table field-cont threeColumnTable" columns="4"
                             columnClasses="firstCol,secondCol,firstCol,secondCol">

                    <h:outputLabel for="cardNumber" value="#{lblOpr.card_number}:" />
                    <h:inputText id="cardNumber" value="#{MbDspApplications.originalCaseFilter.cardMask}" styleClass="width250" />

                    <h:outputLabel for="merchantName" value="#{lblAcq.merchant_number}:" />
                    <h:inputText id="merchantName" value="#{MbDspApplications.originalCaseFilter.merchantName}" styleClass="width250" />

                    <h:outputLabel for="authCode" value="#{lblOpr.auth_code}" />
                    <h:inputText id="authCode" value="#{MbDspApplications.originalCaseFilter.authCode}" styleClass="width250" />

                    <h:outputLabel for="termNumber" value="#{lblAcq.terminal_number}" />
                    <h:inputText id="termNumber" value="#{MbDspApplications.originalCaseFilter.terminalNumber}" styleClass="width250" />

                    <h:outputLabel for="arn" value="#{lblOpr.arn}" />
                    <h:inputText id="arn" value="#{MbDspApplications.originalCaseFilter.arn}" styleClass="width250" />

                    <h:outputLabel for="merchNumber" value="#{lblAcq.merchant_number}" />
                    <h:inputText id="merchNumber" value="#{MbDspApplications.originalCaseFilter.merchantNumber}" styleClass="width250" />

                    <h:outputLabel for="hostDateFrom" value="#{lblOpr.host_date_from}:" />
                    <h:panelGrid columns="1" cellpadding="0" cellspacing="0">
                        <rich:calendar id="hostDateFrom" value="#{MbDspApplications.originalCaseFilter.hostDateFrom}" buttonIcon="/images/calendar.gif" datePattern="#{usession.datePattern}" inputStyle="width: 190px; max-width:200px" zindex="1000"  />
                    </h:panelGrid>

                    <h:outputLabel for="hostDateTo" value="#{lblOpr.host_date_to}:" />
                    <h:panelGrid columns="1" cellpadding="0" cellspacing="0">
                        <rich:calendar id="hostDateTo" value="#{MbDspApplications.originalCaseFilter.hostDateTo}"  buttonIcon="/images/calendar.gif" datePattern="#{usession.datePattern}" inputStyle="width: 190px; max-width:200px" zindex="1000"  />
                    </h:panelGrid>

                </h:panelGrid>

                <h:panelGrid columns="1">
                    <bre:taggedCommandButton type="submit"
                                             value="#{lblForm.search}"
                                             action="#{MbDspApplications.searchOperations}"
                                             reRender="originalTableWrapper"
                                             style="width:85px;" />
                </h:panelGrid>

            </h:panelGroup>

            <h:outputText value="List of unpaired items" />
            <h:panelGroup id="unpairedTableWrapper" layout="block">
                <rich:extendedDataTable id="unpairedTransactionTable"
                                        value="#{MbDspApplications.unpairedDisputeOperations}"
                                        var="item"
                                        styleClass="res-table"
                                        headerClass="res-table-header"
                                        rowClasses=",odd"
                                        height="200px"
                                        selectedClass="res-table-selected"
                                        onRowClick="changeSelectedUnpairedId('#{item.id}');">

                    <rich:column id="messageType" width="7%">
                        <f:facet name="header">
                            <h:outputText value="Message Type" />
                        </f:facet>
                        <h:outputText value="#{item.msgType}" />
                    </rich:column>

                    <rich:column id="cardNumber" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Card number" />
                        </f:facet>
                        <h:outputText value="#{item.cardMask}" />
                    </rich:column>

                    <rich:column id="RC" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Reason code" />
                        </f:facet>
                        <h:outputText value="#{item.reasonCode}" />
                    </rich:column>

                    <rich:column id="MMT" width="9%">
                        <f:facet name="header">
                            <h:outputText value="MMT" />
                        </f:facet>
                        <h:outputText value="#{item.memberMessageText}" />
                    </rich:column>

                    <rich:column id="settlmentAmount" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Settlement amount" />
                        </f:facet>
                        <h:outputText value="#{fmt:formatMoney(item.sttlAmount, CurrencyUtils.currencyObjectsMap[item.sttlCurrency].exponent)}" />
                    </rich:column>

                    <rich:column id="settlementCurrency" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Settlement currency" />
                        </f:facet>
                        <h:outputText value="#{CurrencyUtils.currencyShortNamesMap[item.sttlCurrency]}" />
                    </rich:column>

                    <rich:column id="merchantName" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Merchant name" />
                        </f:facet>
                        <h:outputText value="#{item.merchantName}" />
                    </rich:column>

                    <rich:column id="termNumber" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Terminal number" />
                        </f:facet>
                        <h:outputText value="#{item.terminalNumber}" />
                    </rich:column>

                    <rich:column id="merchNumber" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Merchant number" />
                        </f:facet>
                        <h:outputText value="#{item.merchantNumber}" />
                    </rich:column>

                    <rich:column id="authCode" width="9%">
                        <f:facet name="header">
                            <h:outputText value="Auth. code" />
                        </f:facet>
                        <h:outputText value="#{item.authCode}" />
                    </rich:column>

                    <rich:column id="ARN" width="8%">
                        <f:facet name="header">
                            <h:outputText value="ARN" />
                        </f:facet>
                        <h:outputText value="#{item.networkRefnum}" />
                    </rich:column>

                </rich:extendedDataTable>
            </h:panelGroup>

            <h:outputText value="List of original transactions" />
            <h:panelGroup id="originalTableWrapper" layout="block">
                <rich:extendedDataTable id="originalTransactionTable"
                                        var="item"
                                        value="#{MbDspApplications.operationOriginalCase}"
                                        styleClass="res-table"
                                        headerClass="res-table-header"
                                        rowClasses=",odd"
                                        height="200px"
                                        selectedClass="res-table-selected"
                                        onRowClick="changeSelectedOperationId('#{item.id}');">

                    <rich:column id="operationDate" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Operation date" />
                        </f:facet>
                        <h:outputText value="#{item.operDate}">
                            <f:convertDateTime pattern="#{usession.datePattern}" timeZone="#{CommonUtils.timeZone}" />
                        </h:outputText>
                    </rich:column>

                    <rich:column id="cardNumber" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Card number" />
                        </f:facet>
                        <h:outputText value="#{item.cardMask}" />
                    </rich:column>

                    <rich:column id="operationAmount" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Operation amount" />
                        </f:facet>
                        <h:outputText value="#{fmt:formatMoney(item.operAmount, CurrencyUtils.currencyObjectsMap[item.operCurrency].exponent)}" />
                    </rich:column>

                    <rich:column id="operationCurrency" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Operation currency" />
                        </f:facet>
                        <h:outputText value="#{CurrencyUtils.currencyShortNamesMap[item.operCurrency]}" />
                    </rich:column>

                    <rich:column id="merchantName" width="11%" sortBy="#{'merchant_name'}">
                        <f:facet name="header">
                            <h:outputText value="Merchant name" />
                        </f:facet>
                        <h:outputText value="#{item.merchantName}" />
                    </rich:column>

                    <rich:column id="terminalNumber" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Terminal number" />
                        </f:facet>
                        <h:outputText value="#{item.terminalNumber}" />
                    </rich:column>

                    <rich:column id="merchantNumber" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Merchant number" />
                        </f:facet>
                        <h:outputText value="#{item.merchantNumber}" />
                    </rich:column>

                    <rich:column id="authCode" width="11%">
                        <f:facet name="header">
                            <h:outputText value="Auth. code" />
                        </f:facet>
                        <h:outputText value="#{item.authCode}" />
                    </rich:column>

                    <rich:column id="ARN" width="10%">
                        <f:facet name="header">
                            <h:outputText value="ARN" />
                        </f:facet>
                        <h:outputText value="#{item.networkRefnum}" />
                    </rich:column>

                </rich:extendedDataTable>

            </h:panelGroup>

            <h:panelGroup id="buttonsPanel">
            <h:panelGrid columns="2">
                <bre:taggedCommandButton id="match"
                                         type="submit"
                                         value="Match"
                                         reRender="mainTableWrapper"
                                         style="width:85px;"
                                         action="#{MbDspApplications.createDisputeUnpairedCase}"
                                         oncomplete="if(#{usession.noErrorResponse}){Richfaces.hideModalPanel('unpairedCaseCreationMP');}"
                                         disabled="#{!MbDspApplications.matchDisplay}"
                />

                <bre:taggedCommandButton value="#{lblForm.cancel}" immediate="true" onclick="Richfaces.hideModalPanel('unpairedCaseCreationMP')">
                    <f:actionListener type="ru.bpc.jsf.A4JFormReset" />
                </bre:taggedCommandButton>
            </h:panelGrid>
            </h:panelGroup>

        </h:form>

    </rich:modalPanel>
</ui:composition>
</html>