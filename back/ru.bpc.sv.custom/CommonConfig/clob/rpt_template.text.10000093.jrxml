<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReissuedCardsRpt" pageWidth="842" pageHeight="595" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    <property name="ireport.zoom" value="1.5"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <subDataset name="dataset1">
        <queryString language="xPath">
            <![CDATA[/report]]>
        </queryString>
        <field name="inst_id" class="java.lang.String">
            <fieldDescription><![CDATA[/report/inst_id]]></fieldDescription>
        </field>
        <field name="inst" class="java.lang.String">
            <fieldDescription><![CDATA[/report/inst]]></fieldDescription>
        </field>
        <field name="start_date" class="java.lang.String">
            <fieldDescription><![CDATA[/report/start_date]]></fieldDescription>
        </field>
        <field name="end_date" class="java.lang.String">
            <fieldDescription><![CDATA[/report/end_date]]></fieldDescription>
        </field>
    </subDataset>
    <parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["D:\\work\\Reports\\"]]></defaultValueExpression>
    </parameter>
    <queryString language="xPath">
        <![CDATA[/report/cards/card]]>
    </queryString>
    <field name="inst_id" class="java.lang.String">
        <fieldDescription><![CDATA[inst_id]]></fieldDescription>
    </field>
    <field name="inst" class="java.lang.String">
        <fieldDescription><![CDATA[inst]]></fieldDescription>
    </field>
    <field name="account_number" class="java.lang.String">
        <fieldDescription><![CDATA[account_number]]></fieldDescription>
    </field>
    <field name="card_number" class="java.lang.String">
        <fieldDescription><![CDATA[card_number]]></fieldDescription>
    </field>
    <field name="expir_date" class="java.lang.String">
        <fieldDescription><![CDATA[expir_date]]></fieldDescription>
    </field>
    <field name="status" class="java.lang.String">
        <fieldDescription><![CDATA[status]]></fieldDescription>
    </field>
    <field name="cardholder_id" class="java.lang.String">
        <fieldDescription><![CDATA[cardholder_id]]></fieldDescription>
    </field>
    <field name="currency" class="java.lang.String">
        <fieldDescription><![CDATA[currency]]></fieldDescription>
    </field>
    <field name="ledger_balance" class="java.lang.Double">
        <fieldDescription><![CDATA[ledger_balance]]></fieldDescription>
    </field>
    <field name="company" class="java.lang.String">
        <fieldDescription><![CDATA[company]]></fieldDescription>
    </field>
    <field name="person_name" class="java.lang.String">
        <fieldDescription><![CDATA[person_name]]></fieldDescription>
    </field>
    <group name="inst_agent_net">
        <groupExpression><![CDATA[$F{inst}]]></groupExpression>
        <groupHeader>
            <band height="101">
                <textField>
                    <reportElement x="0" y="10" width="65" height="20"/>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="12" isBold="false" pdfEncoding="Cp1251"/>
                    </textElement>
                    <textFieldExpression><![CDATA["Институт:"]]></textFieldExpression>
                </textField>
                <staticText>
                    <reportElement mode="Opaque" x="128" y="61" width="98" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Номер карты ]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="281" y="61" width="63" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="2" rightPadding="1">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Срок действия ]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="226" y="61" width="55" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Статус карты ]]></text>
                </staticText>
                <textField isBlankWhenNull="true">
                    <reportElement x="65" y="10" width="490" height="20"/>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="12" isBold="false" pdfEncoding="Cp1251"/>
                    </textElement>
                    <textFieldExpression><![CDATA[($F{inst} == null) ? "": $F{inst_id} + " «" + $F{inst} + "»"]]></textFieldExpression>
                </textField>
                <staticText>
                    <reportElement mode="Opaque" x="0" y="61" width="128" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Номер счета ]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="627" y="61" width="123" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Ф.И.О. держателя карты]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="428" y="61" width="48" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="1" rightPadding="1">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Валюта счета ]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="344" y="61" width="84" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Идентификатор держателя
карты
]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="476" y="61" width="55" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3" rightPadding="1">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Основной баланс ]]></text>
                </staticText>
                <staticText>
                    <reportElement mode="Opaque" x="531" y="61" width="96" height="40" backcolor="#A2CDF8"/>
                    <box leftPadding="3" rightPadding="1">
                        <topPen lineWidth="0.5"/>
                        <leftPen lineWidth="0.5"/>
                        <bottomPen lineWidth="0.5"/>
                        <rightPen lineWidth="0.5"/>
                    </box>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                    </textElement>
                    <text><![CDATA[Эмбоссированное наименование компании]]></text>
                </staticText>
                <textField>
                    <reportElement x="0" y="30" width="55" height="20"/>
                    <textElement verticalAlignment="Middle">
                        <font fontName="Arial" size="12" isBold="false" pdfEncoding="Cp1251"/>
                    </textElement>
                    <textFieldExpression><![CDATA["Период :"]]></textFieldExpression>
                </textField>
                <componentElement>
                    <reportElement x="55" y="30" width="500" height="20"/>
                    <jr:list xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd" printOrder="Vertical">
                        <datasetRun subDataset="dataset1">
                            <dataSourceExpression><![CDATA[((net.sf.jasperreports.engine.data.JRXmlDataSource)$P{REPORT_DATA_SOURCE}).dataSource("/report")]]></dataSourceExpression>
                        </datasetRun>
                        <jr:listContents height="20" width="500">
                            <textField isBlankWhenNull="true">
                                <reportElement x="0" y="0" width="377" height="20"/>
                                <textElement verticalAlignment="Middle">
                                    <font fontName="Arial" size="12" isBold="false" pdfEncoding="Cp1251"/>
                                </textElement>
                                <textFieldExpression><![CDATA[$F{start_date} + " - " + $F{end_date}]]></textFieldExpression>
                            </textField>
                        </jr:listContents>
                    </jr:list>
                </componentElement>
            </band>
        </groupHeader>
        <groupFooter>
            <band height="26"/>
        </groupFooter>
    </group>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="28" splitType="Stretch">
            <staticText>
                <reportElement x="0" y="0" width="555" height="24"/>
                <box leftPadding="1"/>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="16" isBold="true" pdfEncoding="Cp1251"/>
                </textElement>
                <text><![CDATA[Перевыпущенные карты ]]></text>
            </staticText>
        </band>
    </title>
    <detail>
        <band height="20" splitType="Stretch">
            <textField isStretchWithOverflow="true">
                <reportElement stretchType="RelativeToBandHeight" x="0" y="0" width="128" height="20"/>
                <box leftPadding="3">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{account_number}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00;-###0.00" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="226" y="0" width="55" height="20"/>
                <box leftPadding="2" rightPadding="1">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{status}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00;-###0.00" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="344" y="0" width="84" height="20"/>
                <box leftPadding="0" rightPadding="3">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement textAlignment="Right" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{cardholder_id}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00;-###0.00" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="476" y="0" width="55" height="20"/>
                <box leftPadding="0" rightPadding="3">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement textAlignment="Right" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ledger_balance}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00;-###0.00" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="531" y="0" width="96" height="20"/>
                <box leftPadding="3" rightPadding="0">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{company}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement stretchType="RelativeToBandHeight" x="128" y="0" width="98" height="20"/>
                <box leftPadding="3">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="10" isStrikeThrough="false" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{card_number}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true">
                <reportElement stretchType="RelativeToBandHeight" x="281" y="0" width="63" height="20"/>
                <box leftPadding="1" bottomPadding="1">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{expir_date}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00;-###0.00" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="428" y="0" width="48" height="20"/>
                <box leftPadding="0" rightPadding="2">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{currency}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true">
                <reportElement stretchType="RelativeToBandHeight" x="627" y="0" width="123" height="20"/>
                <box leftPadding="3" rightPadding="0">
                    <topPen lineWidth="0.5"/>
                    <leftPen lineWidth="0.5"/>
                    <bottomPen lineWidth="0.5"/>
                    <rightPen lineWidth="0.5"/>
                </box>
                <textElement verticalAlignment="Middle">
                    <font fontName="Arial" size="10" pdfEncoding="Cp1251"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{person_name}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport>
