<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
>
<ui:composition>
	<h:form>
		<a4j:jsFunction name="storeTab" ajaxSingle="true" limitToList="true" requestDelay="500"
		                ignoreDupResponses="true" eventsQueue="queue" reRender="err_ajax, #{MbUserGroupsSearch.tabName}">
			<a4j:actionparam name="tabName" assignTo="#{MbUserGroupsSearch.tabName}"/>
		</a4j:jsFunction>
	</h:form>

	<h:panelGroup styleClass="workplace" layout="block" id="workplacePanel">
		<rich:tabPanel switchType="client" id="details" tabClass="tab-cell"
		               activeTabClass="active-tab-cell" headerClass="tabs" headerSpacing="0px"
		               contentClass="tab-content" selectedTab="#{MbUserGroupsSearch.tabName}">

			<rich:tab ontabenter="storeTab('detailsTab')" label="Details" name="detailsTab">
				<f:facet name="label">
					<h:panelGroup styleClass="tab-label" layout="block">
						<h:outputText value="#{lblCommon.details}" title="#{lblCommon.details}"/>
					</h:panelGroup>
				</f:facet>

				<h:panelGroup id="detailsTab" layout="block">
					<h:form id="groupDetailsForm">
						<h:panelGroup id="groupDetailsWrapper" layout="block" styleClass="carddata-wrapper"
						              style="height: 100%; overflow-y: auto;overflow-x: hidden;position:relative;">
							<rich:dataTable id="groupDetailsTable"
							                value="#{MbUserGroupsSearch.emptyTable}"
							                var="field"
							                styleClass="res-table noHeader" width="100%">
								<rich:columnGroup rowClasses=",odd"
								                  columnClasses="firstCol alignLeft width20, width80 width250 noPadding">
									<rich:column styleClass="detailsCategory expandedBranch">
										<h:graphicImage url="/images/minus.gif" onclick="showHideDetails(this)"/>
										<h:outputLabel value="#{lblPrd.general_data}:"/>
									</rich:column>
									<rich:column>
										<script>updateHeight();</script>
									</rich:column>

									<rich:column breakBefore="true">
										<h:outputLabel value="#{lblCommon.id}: " title="#{lblCommon.id}"/>
									</rich:column>
									<rich:column>
										<h:outputLabel value="#{MbUserGroupsSearch.activeItem.id}"
										               title="#{MbUserGroupsSearch.activeItem.id}"/>
									</rich:column>

									<rich:column breakBefore="true">
										<h:outputLabel value="#{lblCommon.name}: " title="#{lblCommon.name}"/>
									</rich:column>
									<rich:column>
										<h:outputLabel value="#{MbUserGroupsSearch.activeItem.name}"
										               title="#{MbUserGroupsSearch.activeItem.name}"/>
									</rich:column>

									<rich:column breakBefore="true">
										<h:outputLabel value="#{lblCommon.institution}: " title="#{lblCommon.institution}"/>
									</rich:column>
									<rich:column>
										<h:outputLabel value="#{DictUtils.institutesMap[MbUserGroupsSearch.activeItem.instId.toString()]}"
										               title="#{DictUtils.institutesMap[MbUserGroupsSearch.activeItem.instId.toString()]}"/>
									</rich:column>
								</rich:columnGroup>
							</rich:dataTable>
							<script>setDetailsState("groupDetailsForm:groupDetailsTable");</script>
						</h:panelGroup>
						<h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
							<h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
								<h:panelGrid columns="2" style="vertical-align: top;" cellpadding="0" cellspacing="0">
									<h:panelGroup styleClass="stdButton"></h:panelGroup>
								</h:panelGrid>
							</h:panelGroup>
						</h:panelGroup>
					</h:form>
				</h:panelGroup>
			</rich:tab>

			<rich:tab ontabenter="storeTab('usersTab')" label="Users" name="usersTab" style="height:100%;">
				<f:facet name="label">
					<h:panelGroup styleClass="tab-label" layout="block">
						<h:outputText value="#{lblAcm.users}" title="#{lblAcm.users}"/>
					</h:panelGroup>
				</f:facet>

				<h:panelGroup id="usersTab" layout="block" styleClass="carddata-wrapper"
				              style="height: 100%;overflow:hidden;position:relative;">
					<ui:include src="/pages/administrative/users_management/list_users_bottom.jspx"></ui:include>
				</h:panelGroup>

			</rich:tab>

		</rich:tabPanel>
	</h:panelGroup>

	<script>
        //<![CDATA[
        function updateHeight(){
            updateGridHeight();
        }

        layout =
            {
                SEARCH_FORM_ID:                 'groupsSearchForm',
                SEARCH_RESULT_FORM_ID:          'groupsForm',
                SEARCH_RESULT_FORM_WRAPPER_ID:  'mainTableWrapper',
                SEARCH_RESULT_FOOTER_FORM_ID:   'groupsBtnForm',
                TAB_PANEL_ID:                   'workplacePanel',

                TAB_DATA:      [{
                    TAB_FORM_ID:            'groupDetailsForm',
                    TAB_FORM_WRAPPER_ID:    'groupDetailsWrapper',
                    CORRECTING_HEIGHT:      Stretch.TABS + Stretch.BUTTONS
                },
                    {
                        TAB_FORM_ID:            'bottomUsersForm',
                        TAB_FORM_WRAPPER_ID:    'bottomUsersTableWrapper',
                        CORRECTING_HEIGHT:      Stretch.TABS + Stretch.BUTTONS
                    }]

            };
        jQuery(window).resize(updateHeight);

        updateHeight();
        //]]>
	</script>
</ui:composition>
</html>
