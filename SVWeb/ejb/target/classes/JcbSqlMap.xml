<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
		PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
		"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="jcb">

	<sql id="limitationOpen">
		SELECT *
		FROM (
	</sql>

	<sql id="limitationOpenCount">
		SELECT count(*)
		FROM (
	</sql>

	<sql id="limitationClose">
		) q
		<isNotNull property="limitation" prepend=" WHERE ">$limitation$</isNotNull>
	</sql>
	<sql id="paginatedOpen">
		SELECT *
		FROM(
		SELECT a.*, rownum r
		FROM(
		<include refid="limitationOpen"/>
	</sql>

	<sql id="paginatedClose">
		<include refid="limitationClose"/>
		) a
		WHERE rownum <![CDATA[<]]>= (#range.end# + 1)
		)
		WHERE r >= (#range.start# + 1)
	</sql>

	<select id="get-fin-messages" parameterClass="qparams" resultClass="java.util.LinkedHashMap">
		SELECT *
		FROM JCB_UI_FIN_VW
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="id">id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="lang">lang = #filters[].value#</isEqual>
		</iterate>
	</select>

	<insert id="register-file" parameterClass="map">
		INSERT INTO jcb_file(id, session_file_id, is_incoming, network_id, inst_id, proc_date, is_rejected)
		VALUES (jcb_file_seq.nextval, #session_file_id#, #is_incoming#, #network_id#, #inst_id#, #file_date#, #is_rejected#)
	</insert>

	<resultMap id="map-get-jcb-fin-messages"
			   class="ru.bpc.sv2.ps.jcb.JcbFinMessage">
		<result column="id" property="id" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="split_hash" property="splitHash" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="status" property="status" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="status_desc" property="statusDesc" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="inst_id" property="instId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="inst_name" property="instName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="network_id" property="networkId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="network_name" property="networkName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="file_id" property="fileId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="file_name" property="fileName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="is_incoming" property="isIncoming" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="is_reversal" property="isReversal" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="is_rejected" property="isRejected" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="reject_id" property="rejectId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="dispute_id" property="disputeId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="dispute_rn" property="disputeRn" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="impact" property="impact" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="mti" property="mti" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="de002" property="de002" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de003_1" property="de0031" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de003_2" property="de0032" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de003_3" property="de0033" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de002_mask" property="de002Mask" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de004" property="de004" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de005" property="de005" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de006" property="de006" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de009" property="de009" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de010" property="de010" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de012" property="de012" jdbcType="VARCHAR" javaType="java.util.Date"/>
		<result column="de014" property="de014" jdbcType="VARCHAR" javaType="java.util.Date"/>
		<result column="de016" property="de016" jdbcType="VARCHAR" javaType="java.util.Date"/>
		<result column="de022_1" property="de0221" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_2" property="de0222" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_3" property="de0223" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_4" property="de0224" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_5" property="de0225" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_6" property="de0226" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_7" property="de0227" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_8" property="de0228" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_9" property="de0229" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_10" property="de02210" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_11" property="de02211" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de022_12" property="de02212" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de023" property="de023" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="de024" property="de024" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de025" property="de025" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de026" property="de026" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de030_1" property="de0301" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de030_2" property="de0302" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de031" property="de031" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de032" property="de032" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de033" property="de033" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de037" property="de037" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de038" property="de038" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de040" property="de040" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de041" property="de041" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de042" property="de042" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_1" property="de0431" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_2" property="de0432" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_3" property="de0433" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_4" property="de0434" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_5" property="de0435" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de043_6" property="de0436" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de049" property="de049" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de050" property="de050" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de051" property="de051" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de054" property="de054" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de055" property="de055" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de071" property="de071" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de072" property="de072" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de093" property="de093" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de094" property="de094" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de100" property="de100" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3001" property="p3001" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3002" property="p3002" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3003" property="p3003" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3005" property="p3005" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3007_1" property="p30071" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3007_2" property="p30072" jdbcType="VARCHAR" javaType="java.util.Date"/>
		<result column="p3008" property="p3008" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3009" property="p3009" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="p3011" property="p3011" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3012" property="p3012" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3013" property="p3013" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3014" property="p3014" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3201" property="p3201" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3202" property="p3202" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3203" property="p3203" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3205" property="p3205" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3206" property="p3206" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3207" property="p3207" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3208" property="p3208" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3209" property="p3209" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="p3210" property="p3210" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3211" property="p3211" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3250" property="p3250" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="p3251" property="p3251" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3302" property="p3302" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f26" property="emv9f26" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f02" property="emv9f02" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="emv_9f27" property="emv9f27" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f10" property="emv9f10" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f36" property="emv9f36" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_95" property="emv95" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_82" property="emv82" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9a" property="emv9a" jdbcType="VARCHAR" javaType="java.util.Date"/>
		<result column="emv_9c" property="emv9c" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="emv_9f37" property="emv9f37" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_5f2a" property="emv5f2a" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="emv_9f33" property="emv9f33" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f34" property="emv9f34" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f1a" property="emv9f1a" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="emv_9f35" property="emv9f35" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="emv_84" property="emv84" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f09" property="emv9f09" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f03" property="emv9f03" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="emv_9f1e" property="emv9f1e" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="emv_9f41" property="emv9f41" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="emv_4f" property="emv4f" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="lang" property="lang" jdbcType="VARCHAR" javaType="java.lang.String"/>
	</resultMap>

	<select id="get-jcb-fin-messages"
			parameterClass="qparams"
			resultMap="map-get-jcb-fin-messages">
		<include refid="paginatedOpen" />
		SELECT
			  id
			, split_hash
			, status
			, status_desc
			, inst_id
			, inst_name
			, network_id
			, network_name
			, file_id
			, file_name
			, is_incoming
			, is_reversal
			, is_rejected
			, reject_id
			, dispute_id
			, dispute_rn
			, impact
			, mti
			, de002
			, de003_1
			, de003_2
			, de003_3
			, de002_mask
			, de004
			, de005
			, de006
			, de009
			, de010
			, de012
			, de014
			, de016
			, de022_1
			, de022_2
			, de022_3
			, de022_4
			, de022_5
			, de022_6
			, de022_7
			, de022_8
			, de022_9
			, de022_10
			, de022_11
			, de022_12
			, de023
			, de024
			, de025
			, de026
			, de030_1
			, de030_2
			, de031
			, de032
			, de033
			, de037
			, de038
			, de040
			, de041
			, de042
			, de043_1
			, de043_2
			, de043_3
			, de043_4
			, de043_5
			, de043_6
			, de049
			, de050
			, de051
			, de054
			, de055
			, de071
			, de072
			, de093
			, de094
			, de100
			, p3001
			, p3002
			, p3003
			, p3005
			, p3007_1
			, p3007_2
			, p3008
			, p3009
			, p3011
			, p3012
			, p3013
			, p3014
			, p3201
			, p3202
			, p3203
			, p3205
			, p3206
			, p3207
			, p3208
			, p3209
			, p3210
			, p3211
			, p3250
			, p3251
			, p3302
			, emv_9f26
			, emv_9f02
			, emv_9f27
			, emv_9f10
			, emv_9f36
			, emv_95
			, emv_82
			, emv_9a
			, emv_9c
			, emv_9f37
			, emv_5f2a
			, emv_9f33
			, emv_9f34
			, emv_9f1a
			, emv_9f35
			, emv_84
			, emv_9f09
			, emv_9f03
			, emv_9f1e
			, emv_9f41
			, emv_4f
			, lang
		FROM
			jcb_ui_fin_vw
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="id">id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="lang">lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="de002Mask">de002_mask = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="de037">de037 = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">file_name = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="de012">de012 = #filters[].value#</isEqual>
		</iterate>
		ORDER BY
			id DESC
		<include refid="paginatedClose" />
	</select>

	<select id="get-jcb-fin-messages-count"
			parameterClass="qparams"
			resultClass="int">
		SELECT
			count(1)
		FROM
			jcb_ui_fin_vw
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="id">id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="lang">lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="de002Mask">de002_mask = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="networkId">network_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">file_name = #filters[].value#</isEqual>
		</iterate>
	</select>

	<resultMap id="map-get-jcb-addendums"
			   class="ru.bpc.sv2.ps.jcb.JcbAddendum">
		<result column="id" property="id" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="fin_id" property="finId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="file_id" property="fileId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="is_incoming" property="isIncoming" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="mti" property="mti" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de024" property="de024" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de032" property="de032" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de033" property="de033" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de071" property="de071" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="de093" property="de093" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de094" property="de094" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="de100" property="de100" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3600" property="p3600" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3600_1" property="p36001" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="p3600_2" property="p36002" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3600_3" property="p36003" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3601" property="p3601" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3602" property="p3602" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3604" property="p3604" jdbcType="VARCHAR" javaType="java.lang.String"/>
	</resultMap>

	<select id="get-jcb-addendums"
			parameterClass="qparams"
			resultMap="map-get-jcb-addendums">
		SELECT
			  id
			, fin_id
			, file_id
			, is_incoming
			, mti
			, de024
			, de032
			, de033
			, de071
			, de093
			, de094
			, de100
			, p3600
			, p3600_1
			, p3600_2
			, p3600_3
			, p3601
			, p3602
			, p3604
		FROM
			jcb_ui_add_vw
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="finId">fin_id = #filters[].value#</isEqual>
		</iterate>
		ORDER BY
			id ASC
	</select>

	<select id="get-jcb-addendums-count"
			parameterClass="qparams"
			resultClass="int">
		SELECT
			count(1)
		FROM
			jcb_ui_add_vw
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="finId">fin_id = #filters[].value#</isEqual>
		</iterate>
	</select>

	<resultMap id="map-get-jcb-files"
			   class="ru.bpc.sv2.ps.jcb.JcbFile">
		<result column="id" property="id" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="inst_id" property="instituteId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="inst_name" property="instituteName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="network_id" property="networkId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="is_incoming" property="isIncoming" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="proc_date" property="procDate" jdbcType="DATE" javaType="java.util.Date"/>
		<result column="session_id" property="sessionId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="file_name" property="fileName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="file_id" property="fileId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="is_rejected" property="isRejected" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="reject_id" property="rejectId" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="header_mti" property="headerMti" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="header_de024" property="headerDe024" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="p3901" property="p3901" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3901_1" property="p39011" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3901_2" property="p39012" jdbcType="DATE" javaType="java.util.Date"/>
		<result column="p3901_3" property="p39013" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="p3901_4" property="p39014" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="header_de071" property="headerDe071" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="trailer_mti" property="trailerMti" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="trailer_de024" property="trailerDe024" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="p3902" property="p3902" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="p3903" property="p3903" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="trailer_de071" property="trailerDe071" jdbcType="NUMBER" javaType="java.lang.Long"/>
	</resultMap>

	<select id="get-jcb-files"
			parameterClass="qparams"
			resultMap="map-get-jcb-files">
		<include refid="paginatedOpen"/>
		SELECT
			  j.id
			, j.inst_id
			, i.name AS inst_name
			, j.network_id
			, j.is_incoming
			, j.proc_date
			, f.session_id
			, f.file_name
			, j.session_file_id AS file_id
			, j.is_rejected
			, j.reject_id
			, j.header_mti
			, j.header_de024
			, j.p3901
			, j.p3901_1
			, j.p3901_2
			, j.p3901_3
			, j.p3901_4
			, j.header_de071
			, j.trailer_mti
			, j.trailer_de024
			, j.p3902
			, j.p3903
			, j.trailer_de071
		FROM
			  jcb_ui_file_vw j
			, prc_session_file f
			, ost_ui_institution_sys_vw i
		WHERE
			  j.id = f.id(+)
		AND
			  j.inst_id = i.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">i.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">f.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">f.file_name like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="dateFrom">j.proc_date >= TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
			<isEqual property="filters[].element" compareValue="dateTo">j.proc_date <![CDATA[<=]]> TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
		</iterate>
		ORDER BY
			  f.session_id DESC
			, j.id DESC
		<include refid="paginatedClose"/>
	</select>

	<select id="get-jcb-files-count"
			parameterClass="qparams"
			resultClass="int">
		SELECT
			  count(1)
		FROM
			  jcb_ui_file_vw j
			, prc_session_file f
			, ost_ui_institution_sys_vw i
		WHERE
			  j.id = f.id(+)
		AND
			  j.inst_id = i.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">i.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">f.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">f.file_name like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="dateFrom">j.proc_date >= TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
			<isEqual property="filters[].element" compareValue="dateTo">j.proc_date <![CDATA[<=]]> TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
		</iterate>
	</select>

	<select id="get-jcb-file-fin-messages"
			parameterClass="qparams"
			resultMap="map-get-jcb-fin-messages">
		<include refid="paginatedOpen" />
		SELECT
			  j.id
			, j.split_hash
			, j.status
			, j.status_desc
			, j.inst_id
			, j.inst_name
			, j.network_id
			, j.network_name
			, j.file_id
			, j.file_name
			, j.is_incoming
			, j.is_reversal
			, j.is_rejected
			, j.reject_id
			, j.dispute_id
			, j.dispute_rn
			, j.impact
			, j.mti
			, j.de002
			, j.de003_1
			, j.de003_2
			, j.de003_3
			, j.de002_mask
			, j.de004
			, j.de005
			, j.de006
			, j.de009
			, j.de010
			, j.de012
			, j.de014
			, j.de016
			, j.de022_1
			, j.de022_2
			, j.de022_3
			, j.de022_4
			, j.de022_5
			, j.de022_6
			, j.de022_7
			, j.de022_8
			, j.de022_9
			, j.de022_10
			, j.de022_11
			, j.de022_12
			, j.de023
			, j.de024
			, j.de025
			, j.de026
			, j.de030_1
			, j.de030_2
			, j.de031
			, j.de032
			, j.de033
			, j.de037
			, j.de038
			, j.de040
			, j.de041
			, j.de042
			, j.de043_1
			, j.de043_2
			, j.de043_3
			, j.de043_4
			, j.de043_5
			, j.de043_6
			, j.de049
			, j.de050
			, j.de051
			, j.de054
			, j.de055
			, j.de071
			, j.de072
			, j.de093
			, j.de094
			, j.de100
			, j.p3001
			, j.p3002
			, j.p3003
			, j.p3005
			, j.p3007_1
			, j.p3007_2
			, j.p3008
			, j.p3009
			, j.p3011
			, j.p3012
			, j.p3013
			, j.p3014
			, j.p3201
			, j.p3202
			, j.p3203
			, j.p3205
			, j.p3206
			, j.p3207
			, j.p3208
			, j.p3209
			, j.p3210
			, j.p3211
			, j.p3250
			, j.p3251
			, j.p3302
			, j.emv_9f26
			, j.emv_9f02
			, j.emv_9f27
			, j.emv_9f10
			, j.emv_9f36
			, j.emv_95
			, j.emv_82
			, j.emv_9a
			, j.emv_9c
			, j.emv_9f37
			, j.emv_5f2a
			, j.emv_9f33
			, j.emv_9f34
			, j.emv_9f1a
			, j.emv_9f35
			, j.emv_84
			, j.emv_9f09
			, j.emv_9f03
			, j.emv_9f1e
			, j.emv_9f41
			, j.emv_4f
			, j.lang
		FROM
			  jcb_ui_fin_vw j
			, jcb_ui_file_vw f
		WHERE
			  j.file_id = f.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">j.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">f.session_file_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">j.file_name like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileId">j.file_id like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="dateFrom">j.de012 >= TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
			<isEqual property="filters[].element" compareValue="dateTo">j.de012 <![CDATA[<=]]> TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
		</iterate>
		ORDER BY
			  f.session_file_id DESC
			, j.id DESC
		<include refid="paginatedClose" />
	</select>

	<select id="get-jcb-file-fin-messages-count"
			parameterClass="qparams"
			resultClass="int">
		SELECT
			  count(1)
		FROM
			  jcb_ui_fin_vw j
			, jcb_ui_file_vw f
		WHERE
			  j.file_id = f.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">j.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">f.session_file_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">j.file_name like #filters[].value#</isEqual>
		</iterate>
	</select>
</sqlMap>