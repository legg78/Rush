<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="cst">
	<sql id="limitationOpen">
            SELECT *
            FROM (                
    </sql>
    
    <sql id="limitationOpenCount">
            SELECT count(*)
            FROM (                
    </sql>
    
    <sql id="limitationClose">               
            	) q
            <isNotNull property="limitation" prepend=" WHERE ">$limitation$</isNotNull>
    </sql>

	<sql id="paginatedOpen">
			SELECT *
			FROM(
				SELECT a.*, rownum r
				FROM(
		<include refid="limitationOpen"/>         
	</sql>

	<sql id="paginatedClose">
		<include refid="limitationClose"/>
					) a
				WHERE rownum <![CDATA[<]]>= (#range.end# + 1)
			)
			WHERE r >= (#range.start# + 1)
	</sql>

</sqlMap>