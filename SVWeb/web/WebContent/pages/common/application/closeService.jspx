<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:bpct="http://www.bpc.ru/jsf/tiles" xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
	  xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j">
<ui:composition>

	<link rel="stylesheet" type="text/css"
		  href="#{request.contextPath}/css/pages/common/application/wizardStartPage.css" />
	<link rel="stylesheet" type="text/css"
		  href="#{request.contextPath}/css/pages/common/application/appWizOldCustomerContract.css" />

	<f:loadBundle var="lblOst" basename="ru.bpc.sv2.ui.bundles.Ost" />
	<f:loadBundle var="lblApp" basename="ru.bpc.sv2.ui.bundles.App" />
	<f:loadBundle var="lblIss" basename="ru.bpc.sv2.ui.bundles.Iss" />
	<f:loadBundle var="lblPrd" basename="ru.bpc.sv2.ui.bundles.Prd" />

	<bpct:customerSearchModalPanels id="custSearchPanels"
									extraIdColon="stepPageInclude:" beanName="MbAppWizCloseService"
									selectMethodName="selectCustomer" reRenderList="customerNumber" />

	<h:form id="appWizCloseService">
		<a4j:loadScript src="/js/calendarUtils.js"></a4j:loadScript>

		<rich:calendar buttonIcon="/images/calendar.gif" id="calendar" datePattern="#{usession.fullDatePattern}"
					   timeZone="#{CommonUtils.timeZone}"
					   onchanged="#{rich:component('calendar')}.customInput.value=event.rich.component.getSelectedDateString();"
					   zindex="1000" inputClass="hidden" buttonClass="hidden" showApplyButton="true" />

		<script type="text/javascript">
			#{rich:component('calendar')}.customExpand=customExpand;
		</script>


		<h:panelGrid styleClass="filter-table field-cont twoColumnTable"
					 columns="2"  columnClasses="firstCol250px,secondCol250px">

			<h:outputLabel value="#{lblCommon.entity_type}: "
						   title="#{lblCommon.entity_type}"
					/>

			<h:selectOneMenu id="entityTypeSelection" value="#{MbAppWizCloseService.activeEntity}">
				<a4j:support event="onchange" reRender="objectTypeSelection"/>
				<f:selectItem itemValue=""/>
				<f:selectItems value="#{MbAppWizCloseService.entityList}"/>
			</h:selectOneMenu>

			<h:outputLabel value="#{lblApp.object}: "
						   title="#{lblApp.object}"
					/>

			<h:selectOneMenu id="objectTypeSelection" value="#{MbAppWizCloseService.activeObject}"
							 valueChangeListener="#{MbAppWizCloseService.beforeChangeActiveObject}">
				<f:selectItem itemValue=""/>
				<a4j:support event="onchange" action="#{MbAppWizCloseService.prepareServices}"
							 reRender="serviceGroup"/>
				<f:selectItems value="#{MbAppWizCloseService.objectList}"/>
			</h:selectOneMenu>

			<h:outputLabel value="* #{lblPrd.services}: "
						   title="#{lblApp.customer_type}"
					/>
			<h:outputLabel value=""/>
		</h:panelGrid>

		<rich:extendedDataTable
				id="serviceGroup"
				height="150px"
				var="item"
				value="#{MbAppWizCloseService.services}"
				selectionMode="single"
				width="100%"
				enableContextMenu="false">

			<rich:column id="name" label="#{lblCommon.name}" title="Name" width="40%">
				<f:facet name="header">
					<h:outputText value="#{lblCommon.name}" title="#{lblCommon.name}"/>
				</f:facet>
				<h:outputText value="#{item.label}" title="#{item.label}"/>
			</rich:column>

			<rich:column id="startDate" label="#{lblCommon.start_date}" title="startDate" width="30%">
				<f:facet name="header">
					<h:outputText value="#{lblCommon.start_date}" title="#{lblCommon.start_date}"/>
				</f:facet>
				<h:inputText id="inputStartDate" style="max-width:125px" onkeypress="return false"
							 value="#{item.startDate}" readonly="true">
					<f:convertDateTime pattern="#{usession.fullDatePattern}"
									   timeZone="#{CommonUtils.timeZone}" />
				</h:inputText>

			</rich:column>

			<rich:column id="endDate" label="#{lblCommon.end_date}" title="endDate" width="30%">
				<f:facet name="header">
					<h:outputText value="#{lblCommon.end_date}" title="#{lblCommon.end_date}"/>
				</f:facet>
				<h:inputText id="val3" style="max-width:125px" onkeypress="return false"
							 value="#{item.endDate}"
							 onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('val3')}, #{rich:element('val3Btn')});">
					<f:convertDateTime pattern="#{usession.fullDatePattern}"
									   timeZone="#{CommonUtils.timeZone}" />
				</h:inputText>
				<h:graphicImage 
						value="/images/calendar.gif"
						onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('val3')}, #{rich:element('val3Btn')});"
						id="val3Btn" style="padding-left: 78%; padding-top: 3px" />
			</rich:column>
		</rich:extendedDataTable>

		<ui:include src="/pages/common/application/appWizActions.jspx" />

	</h:form>

</ui:composition>
</html>
