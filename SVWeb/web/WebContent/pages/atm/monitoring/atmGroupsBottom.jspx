<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
      xmlns:bm="http://www.bpc.ru/jsf/misc">

<ui:composition>
    <h:form id="atmGroupsForm">
        <h:panelGroup id="atmGroupsTableWrapper" layout="block"
                      style="padding:0px;margin:0px;height:100%;">


            <rich:extendedDataTable id="atmGroupsTable" var="item"
                                    tableState="#{MbAtmGroups.tableState}"
                                    value="#{MbAtmGroups.dataModel}" selection="#{MbAtmGroups.itemSelection}"
                                    rows="#{MbAtmGroups.rowsNum}" height="255px" selectionMode="single"
                                    rowClasses=",odd" headerClass="res-table-header"
                                    selectedClass="res-table-selected" styleClass="res-table"
                                    enableContextMenu="true"
                                    noDataLabel="#{lblCommon['no_records_found']}"
                                    reRender="btnPanel">

                <a4j:support event="onselectionchange" eventsQueue="queue"
                             reRender="btnPanel" />

                <rich:column id="name" label="#{lblCommon.name}" sortBy="#{'name'}" width="15%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.name}" title="#{lblCommon.name}" />
                    </f:facet>
                    <h:outputText value="#{item.name}" title="#{item.name}" />
                </rich:column>

                <rich:column id="description" label="#{lblCommon.description}" sortBy="#{'description'}" width="15%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.description}" title="#{lblCommon.description}" />
                    </f:facet>
                    <h:outputText value="#{item.description}" title="#{item.description}" />
                </rich:column>

                <rich:column id="institution" label="#{lblCommon.institution}" sortBy="#{'instName'}" width="15%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.institution}" title="#{lblCommon.institution}" />
                    </f:facet>
                    <bm:entityDisplay  entityId="#{item.instId}"
                                       value="#{item.instName}"/>
                </rich:column>

                <rich:column id="agent_name" label="#{lblCommon.agent}" sortBy="#{'agentName'}" width="20%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.agent}" title="#{lblCommon.agent}" />
                    </f:facet>
                    <bm:entityDisplay  entityId="#{item.agentNumber}" value="#{item.agentName}"/>
                </rich:column>

                <rich:column id="modifier_name" label="#{lblCommon.modifier}" sortBy="#{'modifierName'}" width="20%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.modifier}" title="#{lblCommon.modifier}" />
                    </f:facet>
                    <h:outputText value="#{item.modifierName}"
                                  title="#{item.modifierName}" />
                </rich:column>

                <rich:column id="lang" label="#{lblCommon.language}" sortBy="#{'lang'}" width="10%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.language}" title="#{lblCommon.language}" />
                    </f:facet>
                    <h:outputText value="#{item.lang}" title="#{item.lang}" />
                </rich:column>


                <rich:column id="is_private" label="#{lblCommon.is_private}" sortBy="#{'isPrivate'}" width="5%">
                    <f:facet name="header">
                        <h:outputText value="#{lblCommon.is_private}" title="#{lblCommon.is_private}" />
                    </f:facet>
                    <h:selectBooleanCheckbox disabled="true"  value="#{item.private}"/>
                </rich:column>

            </rich:extendedDataTable>
        </h:panelGroup>


        <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
            <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
                <h:panelGrid id="btnPanel" styleClass="fw buttons_block" columns="2" columnClasses=", table_tools_state">
                    <h:panelGroup>

                        <bre:taggedCommandButton id="addBtn"
                                                 reRender="arrayModalHeader, arrayModalDiv"
                                                 value="#{lblForm.add}"
                                                 oncomplete="#{rich:component('arrayModalPanel')}.show()"
                                                 action="#{MbAtmGroups.add}"
                                                 disabled="#{MbAtmGroups.atm.id == null}"
                                                 image="/images/create_doc.gif"
                                />

                        <bre:taggedCommandButton id="deleteBtn"
                                                 value="#{lblForm.delete}"
                                                 oncomplete="#{rich:component('deleteAtmGroupViewId:confirmPanel')}.show()"
                                                 disabled="#{MbAtmGroups.activeItem == null || !MbAtmGroups.canDeleteGroup}"
                                                 image="/images/delete.gif"
                                />
                    </h:panelGroup>

                    <h:panelGroup>
                        <h:graphicImage url="/images/green-tick.png" title="#{lblCommon.save_table_state}" styleClass="action_icon"
                                        onclick="saveElemTableState();"/>
                        <h:graphicImage url="/images/red-cross.png" title="#{lblCommon.delete_table_state}" styleClass="action_icon"
                                        onclick="deleteElemTableState();"/>
                        <a4j:queue name="tablestatequeue"/>
                        <a4j:jsFunction name="saveElemTableState" action="#{MbAtmGroups.saveTableStateDB}" eventsQueue="tablestatequeue"/>
                        <a4j:jsFunction name="deleteElemTableState" action="#{MbAtmGroups.deleteTableStateDB}" eventsQueue="tablestatequeue"/>
                    </h:panelGroup>
                </h:panelGrid>
            </h:panelGroup>
        </h:panelGroup>

    </h:form>

    <ui:include src="/pages/atm/monitoring/add_atm_group.jspx">
        <ui:param name="rerenderList"
                  value="atmGroupsForm:atmGroupsTable, atmGroupsForm:btnPanel" />
    </ui:include>



    <ui:include src="/pages/utils/confirmPanel.jspx">
        <ui:param name="backingBean" value="#{MbAtmGroups}"/>
        <ui:param name="yesAction" value="delete"/>
        <ui:param name="warningMsg" value="#{lblMsg.confirm_delete}"/>
        <ui:param name="rerenderList" value="atmGroupsTable, btnPanel"/>
        <ui:param name="confirmQuestion" value=" "/>
        <ui:param name="subviewId" value="deleteAtmGroupViewId"/>
        <ui:param name="yes" value="#{lblForm.ok}"/>
        <ui:param name="no" value="#{lblForm.cancel}"/>
    </ui:include>

</ui:composition>


</html>