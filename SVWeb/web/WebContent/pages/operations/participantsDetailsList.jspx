<?xml version="1.0" encoding="UTF-8"?>
<html 	xmlns="http://www.w3.org/1999/xhtml" 
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:h="http://java.sun.com/jsf/html" 
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:bm="http://www.bpc.ru/jsf/misc"
		xmlns:a4j="http://richfaces.org/a4j" 
		xmlns:rich="http://richfaces.org/rich"
		xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<ui:composition>
	<h:form id="participantsDetailsForm">
		<h:panelGroup id="participantsDetailsWrapper" layout="block" styleClass="carddata-wrapper" 
				style="height: 100%; overflow-y: auto;overflow-x: hidden;position:relative;">
			<rich:dataTable id="participantsDetailsTable"
					value="#{(participantsBean==null ? MbParticipants : participantsBean).participantsList}"
					var="item" rowKeyVar="index" rowClasses="odd, even"
					styleClass="res-table noHeader" width="100%"
					columnClasses="firstCol alignLeft width20, width80 width250 noPadding">
				<rich:columnGroup rowClasses="even,odd" 
						columnClasses="firstCol alignLeft width20, width80 width250 noPadding">
					
					<rich:column styleClass="detailsCategory expandedBranch">
						<h:graphicImage url="/images/minus.gif" onclick="showHideDetails(this)"/>
						<h:outputLabel value="#{DictUtils.allArticlesDesc[item.participantType]}:"
								title="#{DictUtils.allArticlesDesc[item.participantType]}:"
								rendered="#{item.participantType != null}"/>
						<h:outputLabel value="#{lblCommon.details}" title="#{lblCommon.details}"
								rendered="#{item.participantType == null}"/>
					</rich:column>
					
					<rich:column>
						<script>updateHeight();</script>
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.institution}: " title="#{lblCommon.institution}"/>
					</rich:column>
					<rich:column>
						<bm:entityDisplay  entityId="#{item.instId}"
									value="#{item.instName}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblOpr.network}: " title="#{lblOpr.network}"/>
					</rich:column>
					<rich:column>
						<div class="#{EntityIcons.objectsMap['ENTTNETW'][item.networkId]}"/>
						<h:outputLabel
								value="#{item.networkId} - #{item.networkName}"
								title="#{item.networkId} - #{item.networkName}"
								rendered="#{item.networkId != null}"
								/>
						<h:outputLabel value="" 
								rendered="#{item.networkId == null}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.client_id_type}: " title="#{lblCommon.client_id_type}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel  
								value="#{DictUtils.articles[item.clientIdType]}"
								title="#{DictUtils.articles[item.clientIdType]}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.client_id_value}: " title="#{lblCommon.client_id_value}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{item.clientIdValue}"
								title="#{item.clientIdValue}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.customer}: " title="#{lblPrd.customer}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.customerName}" title="#{item.customerName}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblOpr.auth_code}: " title="#{lblOpr.auth_code}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.authCode}" title="#{item.authCode}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_type}: " title="#{lblIss.card_type}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.cardTypeName}" title="#{item.cardTypeName}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_mask}: " title="#{lblIss.card_mask}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.cardMask}" title="#{item.cardMask}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_expir_date}: " title="#{lblIss.card_expir_date}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel 
								value="#{fmt:formatDate(item.cardExpirDate, 'MM/yy', CommonUtils.timeZoneId)}"
								title="#{fmt:formatDate(item.cardExpirDate, 'MM/yy', CommonUtils.timeZoneId)}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_service_code}: " title="#{lblIss.card_service_code}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.cardServiceCode}" title="#{item.cardServiceCode}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_country}: " title="#{lblIss.card_country}"/>
					</rich:column>
					<rich:column>
						<div class="#{CountryUtils.flag[item.cardCountry]}"/>
						<h:outputLabel value="#{CountryUtils.countryMap[item.cardCountry]}" 
								title="#{CountryUtils.countryMap[item.cardCountry]}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_network}: " title="#{lblIss.card_network}"/>
					</rich:column>
					<rich:column>
						<div class="#{EntityIcons.objectsMap['ENTTNETW'][item.cardNetworkId]}"/>
						<h:outputLabel value="#{item.cardNetworkName}" title="#{item.cardNetworkName}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblIss.card_inst}: " title="#{lblIss.card_inst}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.cardInstName}" title="#{item.cardInstName}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblAcc.account_type}: " title="#{lblAcc.account_type}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{DictUtils.articles[item.accountType]}" 
								title="#{DictUtils.articles[item.accountType]}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblAcc.account_number}: " title="#{lblAcc.account_number}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{item.accountNumber}" 
								title="#{item.accountNumber}"/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblAcc.account_amount}: " title="#{lblAcc.account_amount}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{fmt:formatMoney(item.accountAmount, CurrencyUtils.currencyObjectsMap[item.accountCurrency].exponent)} #{CurrencyUtils.currencyShortNamesMap[item.accountCurrency]}"
								title="#{fmt:formatMoney(item.accountAmount, CurrencyUtils.currencyObjectsMap[item.accountCurrency].exponent)} #{CurrencyUtils.currencyShortNamesMap[item.accountCurrency]}"
								rendered="#{item.accountAmount != null}"
								/>
						<h:outputLabel value=""
								rendered="#{item.accountAmount == null}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblAcc.account_currency}: " title="#{lblAcc.account_currency}"/>
					</rich:column>
					<rich:column>
						<div class="#{EntityIcons.objectsMapS['ENTT0046'][item.accountCurrency]}"/>
						<h:outputLabel id="accCurr" 
								value="#{CurrencyUtils.currencyMap[item.accountCurrency]}"
								title="#{CurrencyUtils.currencyMap[item.accountCurrency]}"
								/>
					</rich:column>

					<rich:column breakBefore="true" rendered="#{item.participantType=='PRTYACQ'}">
						<h:outputLabel value="#{lblAcq.merchant_id}: " title="#{lblAcq.merchant_id}"/>
					</rich:column>
					<rich:column rendered="#{item.participantType=='PRTYACQ'}">
						<h:outputLabel value="#{item.merchantId}" title="#{item.merchantId}"/>
					</rich:column>

					<rich:column breakBefore="true" rendered="#{item.participantType=='PRTYACQ'}">
						<h:outputLabel value="#{lblAcq.terminal_id}: " title="#{lblAcq.terminal_id}"/>
					</rich:column>
					<rich:column rendered="#{item.participantType=='PRTYACQ'}">
						<h:outputLabel value="#{item.terminalId}" title="#{item.terminalId}"/>
					</rich:column>
				</rich:columnGroup>
			</rich:dataTable>

			<script>setDetailsState("participantsDetailsForm:participantsDetailsTable");makeZebraStyle("participantsDetailsForm:participantsDetailsTable");</script>
		</h:panelGroup>
        <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
            <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons" rendered="#{operEntriesBean==null}">
                <h:panelGrid id="entriesListBtns" styleClass="fw buttons_block" columns="3" columnClasses=",,table_tools_state">
                    <h:panelGroup>
                        <bre:taggedCommandButton id="viewCardNumberBtn"
                                                 value="#{lblIss.view_number_and_token}"
                                                 rendered="#{usession.inRole['VIEW_CARD_NUMBER'] || usession.inRole['VIEW_CARD_TOKEN']}"
                                                 action="#{(participantsBean==null ? MbParticipants : participantsBean).viewCardObjects}"
                                                 disabled="#{(participantsBean==null ? MbParticipants : participantsBean).disabledViewCardObjects}"
                                                 oncomplete="#{rich:component('cardNumberModalPanel')}.show()"
                                                 reRender="cardNumberModalDiv:participantsDetailsTable"
                                                 limitToList="true"/>
                    </h:panelGroup>
                </h:panelGrid>
            </h:panelGroup>
        </h:panelGroup>
    </h:form>

    <ui:include src="/pages/operations/participantsCardNumberModalPanel.jspx"/>
</ui:composition>
</html>
