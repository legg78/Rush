<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<ui:composition>
	<h:form id="reasonMappingForm">
		<h:panelGroup id="reasonMappingWrapper">
			<rich:extendedDataTable id="reasonMappingTable"
				tableState="#{MbReasonMapping.tableState}"
				styleClass="res-table" headerClass="res-table-header"
				rowClasses=",odd" selectedClass="res-table-selected" var="item"
				value="#{MbReasonMapping.reasonMappings}"
				selection="#{MbReasonMapping.itemSelection}"
				rows="#{MbReasonMapping.rowsNum}" height="255px"
				selectionMode="single" width="100%" enableContextMenu="true"
				noDataLabel="#{MbReasonMapping.searching?lblCommon['no_records_found'] : lblCommon['enter_search_criteria_above']}"
				reRender="reasonMappingDetailsTab">

				<a4j:support event="onselectionchange" eventsQueue="queue" reRender="reasonMappingDetailsTab, workplacePanel, btnPanel" />
				
				<rich:column id="id" label="#{lblCommon.id}" sortBy="#{'id'}" width="15%">
					<f:facet name="header">
						<h:outputText value="#{lblCommon.id}" title="#{lblCommon.id}"/>
					</f:facet>
					<h:outputText value="#{item.id}" title="#{item.id}" />
				</rich:column>

				<rich:column id="oper_type" label="#{lblOpr.oper_type}"
					title="Operation type" sortBy="#{'operType'}" width="30%">
					<f:facet name="header">
						<h:outputText value="#{lblOpr.oper_type}" title="#{lblOpr.oper_type}" />
					</f:facet>
					<h:outputText value="#{DictUtils.articles[item.operType]}"
						title="#{DictUtils.articles[item.operType]}" rendered="#{!item.anyOperType}" />
					<h:outputText value="#{item.operType}" rendered="#{item.anyOperType}" />
				</rich:column>

				<rich:column id="reason_dict" label="#{lblOpr.reason_dict}"
					title="Reason dict" sortBy="#{'reasonDict'}" width="55%">
					<f:facet name="header">
						<h:outputText value="#{lblOpr.reason_dict}" title="#{lblOpr.reason_dict}" />
					</f:facet>
					<h:outputText value="#{DictUtils.articles[item.reasonDict]}" title="#{DictUtils.articles[item.reasonDict]}" />
				</rich:column>
			</rich:extendedDataTable>
		</h:panelGroup>

		<h:panelGroup layout="block" styleClass="bottom_search_result_block" style="height:30px; overflow:hidden;">
			<h:panelGroup layout="block" styleClass="bottom_search_result_left">
				<h:panelGrid id="btnPanel" columns="3" styleClass="buttons_block">
					<bre:taggedCommandButton id="addBtn"
						disabled="#{MbOperTypes.activeOperType == null}"
						reRender="reasonMappingModalHeader, reasonMappingModalDiv" value="#{lblForm.add}"
						oncomplete="#{rich:component('reasonMappingModalPanel')}.show()"
						action="#{MbOperTypes.addReasonMapping}" image="/images/create_doc.gif"
						rendered="#{usession.inRole['ADD_REASON_MAPPING']}" />
					<bre:taggedCommandButton id="editBtn"
						reRender="reasonMappingModalHeader, reasonMappingModalDiv" value="#{lblForm.edit}"
						action="#{MbReasonMapping.edit}" oncomplete="#{rich:component('reasonMappingModalPanel')}.show()"
						disabled="#{MbReasonMapping.activeReasonMapping == null}"
						image="/images/edit.gif" rendered="#{usession.inRole['MODIFY_REASON_MAPPING']}" />
					<bre:taggedCommandButton id="deleteReasonMappingBtn"
						reRender="reasonMappingTable, reasonMappingDetailsTab, btnPanel"
						value="#{lblForm.delete}" action="#{MbReasonMapping.delete}"
						onclick="if (!confirm('#{lblMsg.confirm_delete}')) return false;"
						disabled="#{MbReasonMapping.activeReasonMapping == null}"
						rendered="#{usession.inRole['REMOVE_REASON_MAPPING']}"
						image="/images/delete.gif" />
				</h:panelGrid>
			</h:panelGroup>
		</h:panelGroup>
			
	</h:form>
	
	<ui:include src="/pages/operations/reasonMappingEdit.jspx">
		<ui:param name="rerenderList" value="#{MbOperTypes.entityTab}, reasonMappingDetailsTab"></ui:param>
		<ui:param name="lockOperType" value="true"></ui:param>
	</ui:include>

</ui:composition>
</html>