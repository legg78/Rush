<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
	  xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
	  xmlns:bm="http://www.bpc.ru/jsf/misc"
	  >
<ui:composition>
	<rich:modalPanel id="actionValueModalPanel" autosized="true" minWidth="300" minHeight="50"
			rendered="#{usession.inRole['ADD_ACTION_VALUE'] or usession.inRole['MODIFY_ACTION_VALUE']}">
      	<f:facet name="header">
			<h:panelGroup id="actionValueModalHeader">
           	    <h:outputText value="#{lblAcm.set_action_value}"/>
			</h:panelGroup>
		</f:facet>
		<f:facet name="controls">
	    </f:facet>
		<h:form id="actionValueModalForm">
			<h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
		        <h:panelGrid columns="2" styleClass="cardholderdata" width="100%" columnClasses="firstColModal, width250">
		
					<h:outputLabel value="* #{MbAcmActionValues.activeAcmActionValue.label}: " title="#{MbAcmActionValues.activeAcmActionValue.label}"
							rendered="#{MbAcmActionValues.activeAcmActionValue.label != null}"/>
					<a4j:outputPanel rendered="#{MbAcmActionValues.lovId == null}">
						<h:selectOneMenu value="#{MbAcmActionValues.valueType}" style="width:100px">
							<a4j:support event="onchange" reRender="valueHolder"
									limitToList="true" ajaxSingle="true"/>
							<f:selectItem itemValue="#{MbAcmActionValues.valueTypeValue}" itemLabel="#{lblCommon.value}"/>
							<f:selectItem itemValue="#{MbAcmActionValues.valueTypeFunction}" itemLabel="#{lblAcm.function}"/>
						</h:selectOneMenu>
					</a4j:outputPanel>
					
					<h:outputLabel value="#{lblPmo.param_value}: " title="#{lblPmo.param_value}" rendered="#{MbAcmActionValues.lovId == null}"/> 
					
					<h:panelGrid columns="1" cellspacing="0" cellpadding="0" 
							rendered="#{MbAcmActionValues.lovId == null}">
						
						<h:panelGrid columns="1" cellspacing="0" cellpadding="0" id="valueHolder">
							<h:inputText style="width: 250px;padding-left:0;padding-right:0" 
									id="actionValueV" 
									value="#{MbAcmActionValues.newAcmActionValue.valueV}"
									required="true" label="#{MbAcmActionValues.activeAcmActionValue.label}"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.charValue}">
							</h:inputText>
							<h:inputText style="width: 250px;padding-left:0;padding-right:0" 
									id="actionValueN" 
									value="#{MbAcmActionValues.newAcmActionValue.valueN}"
									required="true" label="#{MbAcmActionValues.activeAcmActionValue.label}"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.numberValue}"
									onkeypress="if (!numbersOnly(this, event)) return false;">
								<bm:convertNumberNew minFractionDigits="0"/>
							</h:inputText>
							<rich:calendar buttonIcon="/images/calendar.gif" datePattern="#{usession.datePattern}" inputStyle="width:225px"
									value="#{MbAcmActionValues.newAcmActionValue.valueD}" zindex="1000"
									required="true" label="#{MbAcmActionValues.activeAcmActionValue.label}"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.dateValue}"
									timeZone="#{CommonUtils.timeZone}">
							</rich:calendar>
							<h:inputText style="width: 250px;padding-left:0;padding-right:0" 
									id="actionValueFunction" 
									value="#{MbAcmActionValues.newAcmActionValue.paramFunction}"
									required="true" label="#{MbAcmActionValues.activeAcmActionValue.label}"
									rendered="#{MbAcmActionValues.valueFunction}">
							</h:inputText>
							
							<rich:message for="actionValueV" 
									id="actionValueVError"
									styleClass="errorMarker"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.charValue}"				
							/>
							<rich:message for="actionValueN" 
									id="actionValueNError"
									styleClass="errorMarker"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.numberValue}"				
							/>
							<rich:message for="actionValueD" 
									id="actionValueDError"
									styleClass="errorMarker"
									rendered="#{MbAcmActionValues.valueValue and MbAcmActionValues.dateValue}"				
							/>
							<rich:message for="actionValueFunction" 
									id="actionValueFunctionError"
									styleClass="errorMarker"
									rendered="#{MbAcmActionValues.valueFunction}"				
							/>
						</h:panelGrid>
					</h:panelGrid>
					<h:panelGrid columns="1" cellspacing="0" cellpadding="0" 
							rendered="#{MbAcmActionValues.lovId != null}">
						<h:selectOneMenu label="#{lblCommon.value}"
								id="actionLovValueN" style="width: 250px;" required="true"
								value="#{MbAcmActionValues.newAcmActionValue.valueN}"
								rendered="#{MbAcmActionValues.numberValue}"
								>
							<f:selectItem itemValue=""/>
					    	<f:selectItems value="#{MbAcmActionValues.lovValues}"/>
						</h:selectOneMenu>
						
						<h:selectOneMenu label="#{lblCommon.value}"
								id="actionLovValueV" style="width: 250px;" required="true"
								value="#{MbAcmActionValues.newAcmActionValue.valueV}"
								rendered="#{MbAcmActionValues.charValue}"
								>
							<f:selectItem itemValue=""/>
					    	<f:selectItems value="#{MbAcmActionValues.lovValues}"/>
						</h:selectOneMenu>
						<rich:message for="actionLovValueV" 
								styleClass="errorMarker"												
						/>
						<rich:message for="actionLovValueN" 
								styleClass="errorMarker"
						/>
					</h:panelGrid>
				</h:panelGrid>
			</h:panelGroup>
      	    <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
				<h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
	       	    	<h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
	       	    		<h:outputText/>
                       	<bre:taggedCommandButton
                       			value="#{lblForm.save}" type="submit" action="#{MbAcmActionValues.save}"
                       			onclick="disableModalPanelBtns(this)"
			                   	oncomplete="enableModalPanelBtns(this); if (#{usession.noErrorResponse}) #{rich:component('actionValueModalPanel')}.hide()"
                       			reRender="${rerenderList}"
                        		/>
                       	<bre:taggedCommandButton
                        		value="#{lblForm.cancel}" 
                        		action="#{MbAcmActionValues.cancel}" 
                        		immediate="true"
                        		oncomplete="#{rich:component('actionValueModalPanel')}.hide()">
                        	<f:actionListener type="ru.bpc.jsf.A4JFormReset" />
                		</bre:taggedCommandButton>
		    		</h:panelGrid>
		    	</h:panelGroup>
		    </h:panelGroup>
		</h:form>
	</rich:modalPanel>
</ui:composition>
</html>
