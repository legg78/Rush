<?xml version="1.0" encoding="UTF-8"?>
<html	xmlns="http://www.w3.org/1999/xhtml"
         xmlns:f="http://java.sun.com/jsf/core"
         xmlns:h="http://java.sun.com/jsf/html"
         xmlns:ui="http://java.sun.com/jsf/facelets"
         xmlns:a4j="http://richfaces.org/a4j"
         xmlns:rich="http://richfaces.org/rich"
         xmlns:bm="http://www.bpc.ru/jsf/misc"
         xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
         xmlns:bpct="http://www.bpc.ru/jsf/tiles">
<ui:composition>
    <rich:modalPanel id="commentModalPanel" autosized="true" minWidth="350">
        <f:facet name="header">
            <h:outputText value="#{lblMsg.add_edit_comment}" />
        </f:facet>
        <f:facet name="controls"/>

        <h:form id="commentModalForm">
            <h:panelGroup style="font-weight: bold;" layout="block">
                <h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
                    <h:panelGrid columns="2" styleClass="cardholderdata" columnClasses="firstCol firstColModal, width250">
                        <h:outputText value="#{lblMsg.system_comment}:" title="#{lblMsg.system_comment}"/>
                        <h:selectOneMenu id="systemCommentId"
                                         value="#{MbDspComment.systemComment}"
                                         disabled="#{MbDspComment.userComment != null and not empty MbDspComment.userComment}"
                                         style="width: 300px;">
                            <f:selectItem itemValue=""/>
                            <f:selectItems value="#{MbDspComment.comments}"/>
                            <a4j:support event="onchange" ajaxSingle="true" limitToList="true" reRender="commentModalForm"/>
                        </h:selectOneMenu>

                        <h:outputText value="#{lblMsg.custom_user_comment}:" title="#{lblMsg.custom_user_comment}"/>
                        <h:inputTextarea id="userCommentId"
                                         value="#{MbDspComment.userComment}"
                                         disabled="#{MbDspComment.systemComment != null}"
                                         cols="50" rows="10">
                            <a4j:support event="onchange" ajaxSingle="true" limitToList="true" reRender="commentModalForm"/>
                        </h:inputTextarea>
                    </h:panelGrid>
                </h:panelGroup>
            </h:panelGroup>

            <h:panelGrid columns="1" cellpadding="5">
                <h:outputText value="* #{lblMsg.COMMENT_WARN_LBL}" style="color: #999; text-align: right;" />
            </h:panelGrid>

            <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
                <bre:taggedCommandButton id="saveButtonId"
                                         value="#{lblCommon.save}"
                                         type="submit"
                                         action="#{MbDspComment.addComment}"
                                         oncomplete="if(#{usession.noErrorResponse}){Richfaces.hideModalPanel('commentModalPanel');}"
                                         style="padding-left: 240px;"/>

                <bre:taggedCommandButton id="cancelButtonId"
                                         value="#{lblForm.cancel}"
                                         immediate="true"
                                         onclick="Richfaces.hideModalPanel('commentModalPanel')"
                                         style="padding-left: 10px;">
                    <f:actionListener type="ru.bpc.jsf.A4JFormReset"/>
                </bre:taggedCommandButton>
            </h:panelGroup>
        </h:form>
    </rich:modalPanel>
</ui:composition>
</html>