<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:bm="http://www.bpc.ru/jsf/misc"
	xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
	xmlns:o="http://openfaces.org/">
<ui:composition>


	<!-- PARAMETERS -->

	<rich:modalPanel id="terminalsListModalPanel" autosized="true"
		minWidth="300" minHeight="100">
		<f:facet name="header">
			<h:panelGroup id="terminalsListModalPanelHeader">
				<h:outputText value="#{lblAcq.terminals}" />
			</h:panelGroup>
		</f:facet>
		<f:facet name="controls" />
		<h:form id="terminalsListModalPanelForm">
			<h:panelGrid styleClass="fw" columns="2" columnClasses=",link-cont" id="filtersGroup">
				<h:panelGrid styleClass="filter-table field-cont" columns="4"
					columnClasses="firstColModal, ,firstColModal,">

					<h:outputLabel value="#{lblCommon.type}:" title="#{lblCommon.type}" />
					<h:selectOneMenu id="typeFilter"
						value="#{MbTerminal.filter.terminalType}">
						<f:selectItems value="#{MbTerminal.terminalTypes}" />
					</h:selectOneMenu>

					<h:outputLabel value="#{lblAcq.terminal_number}: "
						title="#{lblAcq.terminal_number}" />
					<h:inputText id="termNumber"
						value="#{MbTerminal.filter.terminalNumber}" />

					<h:outputLabel value="#{lblAcq.merchant_number}: "
						title="#{lblAcq.merchant_number}" />
					<h:inputText id="merchantFilter"
						value="#{MbTerminal.filter.merchantNumber}" />

					<h:outputLabel value="#{lblCommon.status}:"
						title="#{lblCommon.status}" />
					<h:selectOneMenu id="statusFilter"
						value="#{MbTerminal.filter.status}">
						<f:selectItems value="#{MbTerminal.statuses}" />
					</h:selectOneMenu>

					<h:outputLabel for="customerNumber"
						value="#{lblPrd.customer_number}: "
						title="#{lblPrd.customer_number}" />
					<h:inputText value="#{MbTerminal.filter.customerNumber}" id="customerNumber"/>

					<h:outputLabel value="#{lblCommon.institution}:"
						title="#{lblCommon.institution}" />
					<h:selectOneMenu id="instFilter"
						value="#{MbTerminal.filter.instId}">
						<f:selectItem itemValue="" />
						<f:selectItems value="#{MbTerminal.institutions}" />
					</h:selectOneMenu>

				</h:panelGrid>
				<h:panelGrid columns="1">
					<bre:taggedCommandButton image="/_img/icon_search.png"
						type="submit" value="#{lblForm.search}" style="width:85px;"
						action="#{MbTerminal.search}" process="filtersGroup"
						reRender="terminalsListModalPanelForm:terminalsTable"
						limitToList="true" ajaxSingle="true" 
						eventsQueue="queue"
						onclick="disableModalPanelBtns(this);"
						oncomplete="enableModalPanelBtns(this);"/>
				</h:panelGrid>
			</h:panelGrid>
			
			<rich:extendedDataTable
					id="terminalsTable"
					styleClass="res-table"
					headerClass="res-table-header"
					rowClasses=",odd"
					selectedClass="res-table-selected"
					var="item" 
					value="#{MbTerminal.terminals}"
					selection="#{MbTerminal.itemSelection}"
					rows="0"
					height="255px"
					selectionMode="single"
					width="100%"
					enableContextMenu="false"
					noDataLabel="#{MbTerminal.searching?lblCommon['no_records_found'] : lblCommon['enter_search_criteria_above']}"
					
					>
				<a4j:support event="onselectionchange"
					eventsQueue="queue"
					reRender="btnPanel, #{MbTerminal.tabName}, togglePanel"
					oncomplete="flushTabs();setTabLoaded(currentTab); toggleTabs(currentTab); updateHeight();" />

				<rich:column id="id" label="#{lblCommon.id}" title="Id"
					sortExpression="asc" sortBy="#{'id'}" width="10%">
					<f:facet name="header">
						<h:panelGroup>
							<script>
								updateHeight();
							</script>
							<h:outputText value="#{lblCommon.id}" title="#{lblCommon.id}" />
						</h:panelGroup>
					</f:facet>
					<h:outputText value="#{item.id}" />
				</rich:column>

				<rich:column id="terminal_number" label="#{lblAcq.terminal_number}"
					title="Number" sortExpression="asc" sortBy="#{'terminalNumber'}"
					width="25%">
					<f:facet name="header">
						<h:outputText value="#{lblAcq.terminal_number}"
							title="#{lblAcq.terminal_number}" />
					</f:facet>
					<h:outputText value="#{item.terminalNumber}" />
				</rich:column>

				<rich:column id="type" label="#{lblCommon.type}" title="Type"
					width="25%" sortBy="#{'type'}">
					<f:facet name="header">
						<h:outputText value="#{lblCommon.type}" title="#{lblCommon.type}" />
					</f:facet>
					<h:outputText
						value="#{DictUtils.articles[item.terminalType]}"
						title="#{DictUtils.articles[item.terminalType]}" />
				</rich:column>

				<rich:column id="status" label="#{lblCommon.status}" title="Status"
					width="40%" sortBy="#{'status'}">
					<f:facet name="header">
						<h:outputText value="#{lblCommon.status}"
							title="#{lblCommon.status}" />
					</f:facet>
					<h:outputText
						value="#{DictUtils.articles[item.status]}"
						rendered="#{item.status != null}"
						title="#{DictUtils.articles[item.status]}" />
					<h:outputText value="" rendered="#{item.status == null}" />
				</rich:column>
			</rich:extendedDataTable>

			<h:panelGroup layout="block"
				styleClass="bottom_search_result_block_buttons">
				<h:panelGroup layout="block"
					styleClass="bottom_search_result_left_buttons">
					<h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
						<h:outputText />
						<bre:taggedCommandButton id="selectBtn" value="#{lblForm.select}"
							action="#{MbVouchersBatches.loadTerminal}"
							reRender="vouchersBatchSearchForm:terminalFilterGroup, vouchersBatchSearchForm:merchantFilterGroup"
							oncomplete="if (#{usession.noErrorResponse}) Richfaces.hideModalPanel('terminalsListModalPanel'); updateHeight();" />
						<bre:taggedCommandButton value="#{lblForm.cancel}"
							immediate="true" limitToList="true"
							oncomplete="Richfaces.hideModalPanel('terminalsListModalPanel')" />
					</h:panelGrid>
				</h:panelGroup>
			</h:panelGroup>
		</h:form>
	</rich:modalPanel>

</ui:composition>
</html>
