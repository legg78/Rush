<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:bm="http://www.bpc.ru/jsf/misc"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
      xmlns:bpct="http://www.bpc.ru/jsf/tiles">

<ui:composition template="/WEB-INF/templates/navigatable.jspx">
<ui:define name="navigatableContent">

<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/stretch.css"/>
<script type="text/javascript" src="#{request.contextPath}/js/stretch.js"/>


<f:loadBundle var="lblCrd" basename="ru.bpc.sv2.ui.bundles.Crd"/>
<f:loadBundle var="lblInt" basename="ru.bpc.sv2.ui.bundles.Interchange"/>
<f:loadBundle var="lblForm" basename="ru.bpc.sv2.ui.bundles.Form"/>

<a4j:loadScript src="/js/calendarUtils.js"></a4j:loadScript>
<rich:calendar buttonIcon="/images/calendar.gif" id="calendar" datePattern="yyyy-MM-dd HH:mm"
               onchanged="#{rich:component('calendar')}.customInput.value=event.rich.component.getSelectedDateString();"
               zindex="1000" inputClass="hidden" buttonClass="hidden" showApplyButton="true" defaultTime="00:00"/>
<script>
    #{rich:component('calendar')}.customExpand = customExpand;
</script>

<a4j:loadScript src="/js/stretch.js"/>
<a4j:queue name="queue" requestDelay="500" ignoreDupResponses="true" size="1" sizeExceededBehavior="dropNew"/>

<h:form>
    <a4j:jsFunction name="initBean">
        <a4j:actionparam name="param1" assignTo="#{MbInterchangeFee.module}"/>
        <a4j:actionparam name="param2" assignTo="#{MbInterchangeFee.paramsBundle}"/>
        <a4j:actionparam name="param3" assignTo="#{MbInterchangeFee.regionsBundle}"/>
    </a4j:jsFunction>
</h:form>

<script type="text/javascript">
    //<![CDATA[
    window.onload = function () {
        initBean('#{module}', '#{paramsBundle}', '#{regionsBundle}');
    };
    var elements = new Array("stringValue", "digitValue", "booleanValue", "dictValue", "dateValue", "countryValue", "currencyValue", "inValue");
    function showModifierEdit() {
        getModifier().value = document.getElementById("criteriaWindowForm:modifier").value;
        enableAdd();
        var elements = new Array("stringValue", "digitValue", "dateValue", "countryValue", "currencyValue");
        for (var i = 0; i < elements.length; i++) {
            var el = document.getElementById("modifierWindowForm:" + elements[i]);
            if (el != null) {
                el.value = "";
            }
        }
        Richfaces.showModalPanel('modifierEditWindow');
    }
    function getModifier() {
        return  document.getElementById("modifierWindowForm:modifierField");
    }
    function saveModifier() {
        var value = getModifier().value;
        document.getElementById("criteriaWindowForm:modifier").value = value;
    }
    function getValue() {
        var value;
        for (var i = 0; i < elements.length; i++) {
            var el = document.getElementById("modifierWindowForm:" + elements[i]);
            if (el == null || el.value.trim().length == 0) {
                continue;
            }
            if (i == 0 || i == 3 || i == 5 || i == 6) {
                value = "\"" + el.value.trim() + "\"";
            } else if (i == 4) {
                value = "df.parse(\"" + el.value.trim() + "\")";
            } else {
                value = el.value;
            }
            return value;
        }
        return null;
    }
    function getInValue() {
        var elements = new Array("inStringValue", "inDigitValue", "inBooleanValue", "inDictValue", "inDateValue",
                "inCountryValue", "inCurrencyValue");
        var value;
        for (var i = 0; i < elements.length; i++) {
            var el = document.getElementById("modifierWindowForm:" + elements[i]);
            if (el == null || el.value.trim().length == 0) {
                continue;
            }
            if (i == 0 || i == 3 || i == 5 || i == 6) {
                value = "\"" + el.value.trim() + "\"";
            } else if (i == 4) {
                value = "df.parse(\"" + el.value.trim() + "\")";
            } else {
                value = el.value;
            }
            return value;
        }
        return null;
    }
    function resetValues() {
        for (var i = 0; i < elements.length; i++) {
            var el = document.getElementById("modifierWindowForm:" + elements[i]);
            if (el != null) {
                el.value = "";
            }
        }
    }
    function disableAdd() {
        document.getElementById("modifierWindowForm:addExprBtn").disabled = true;
    }
    function enableAdd() {
        document.getElementById("modifierWindowForm:addExprBtn").disabled = false;
    }
    function appendModifierExpression() {
        var value = getValue();
        var parameter = document.getElementById("modifierWindowForm:parameter").value;
        var operator = document.getElementById("modifierWindowForm:operator").value;
        var modifier = getModifier();
        if (modifier.value.trim().length > 0) {
            modifier.value = modifier.value + ' ';
        }
        if (operator == 'IN') {
            modifier.value = modifier.value + 'T(java.util.Arrays).asList(' + value + ').contains(' + parameter + ')';
        } else {
            modifier.value = modifier.value + parameter + operator + value;
        }
        resetValues();
        disableAdd();
    }

    function appendModifierAnd() {
        appendModifier('&&');
    }

    function appendModifier(value) {
        var modifier = getModifier();
        if (modifier.value.trim().length > 0) {
            modifier.value = modifier.value + ' ' + value;
        } else {
            modifier.value = value;
        }
        enableAdd();
    }

    function appendIn() {
        var inValue = document.getElementById("modifierWindowForm:inValue");
        var value=getInValue();
        if (value == null)
            return;
        if (inValue.value.trim().length > 0) {
            inValue.value = inValue.value + ', ' + value;
        } else {
            inValue.value = value;
        }
    }

    function clearModifier() {
        getModifier().value = "";
        enableAdd();
    }

    function backspaceModifier() {
        var modifier = getModifier();
        var value = modifier.value;
        if (value.trim().length > 0) {
            var array = value.split(' ');
            if (array.length == 1) {
                modifier.value = "";
                return;
            }
            value = array[0];
            for (var i = 1; i < array.length - 1; i++) {
                value = value + ' ' + array[i];
            }
            modifier.value = value;
        }
        enableAdd();
    }

    function handleEnter(event) {
        if (event.keyCode == 13) {
            document.getElementById('entitySearchForm:searchBtn').click();
            return false;
        }
        return true;
    }
    //]]>
</script>

<!-- navigation bar -->

<bpct:navBar pageName="#{lblCrd.debts}"/>


<!-- search panel -->
<h:form id="entitySearchForm" onkeypress="handleEnter(event)">
    <h:panelGroup layout="block" styleClass="search_block">
        <h:panelGroup layout="block" styleClass="search_block_inner1">
            <h:panelGroup layout="block" styleClass="search_block_inner2">
                <h:panelGroup layout="block" styleClass="search_block_left">
                    <h:panelGroup style="height:60px" styleClass="search_block_inner search_block_inner-hidden-filter"
                                  layout="block">
                        <h:panelGrid styleClass="fw" columns="2"
                                     columnClasses="top ,link-cont">
                            <h:panelGrid styleClass="filter-table field-cont twoColumnTable" columns="4"
                                         columnClasses="firstCol,secondCol,firstCol,secondCol">

                                <h:outputLabel for="feeId" title="#{lblInt.fee_id}" value="#{lblInt.fee_id}:"/>
                                <h:inputText id="feeId" value="#{MbInterchangeFee.filter.id}"/>

                                <h:outputLabel for="feeType" title="#{lblInt.fee_type}"
                                               value="#{lblInt.fee_type}:"/>
                                <h:selectOneMenu id="feeType" value="#{MbInterchangeFee.filter.type}">
                                    <f:selectItem itemValue=""/>
                                    <f:selectItem itemValue="0" itemLabel="#{lblInt.fixed_value}"/>
                                    <f:selectItem itemValue="1" itemLabel="#{lblInt.percent}"/>
                                    <f:selectItem itemValue="2" itemLabel="#{lblInt.min_fix_percent}"/>
                                    <f:selectItem itemValue="3" itemLabel="#{lblInt.max_fix_percent}"/>
                                    <f:selectItem itemValue="4" itemLabel="#{lblInt.fix_percent}"/>
                                </h:selectOneMenu>

                                <h:outputLabel for="feeCurrency" title="#{lblInt.currency}"
                                               value="#{lblInt.currency}:"/>
                                <h:selectOneMenu id="feeCurrency" value="#{MbInterchangeFee.filter.currency}">
                                    <f:selectItem itemValue=""/>
                                    <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                                </h:selectOneMenu>

                                <h:outputLabel for="feeDestCurrency" title="#{lblInt.dest_currency}"
                                               value="#{lblInt.dest_currency}:"/>
                                <h:selectOneMenu id="feeDestCurrency"
                                                 value="#{MbInterchangeFee.filter.destinationCurrency}">
                                    <f:selectItem itemValue=""/>
                                    <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>

                            <h:panelGrid columns="1">
                                <h:panelGroup styleClass="stdButton">
                                    <bre:taggedCommandButton
                                            action="#{MbInterchangeFee.search}"
                                            reRender="entityTable, dsentity, pagesNum"
                                            id="searchBtn"
                                            image="/_img/icon_search.png" type="submit"
                                            value="#{lblForm.search}"

                                            oncomplete="enableModalPanelBtns(this);"
                                            eventsQueue="queue"
                                            style="width:85px;"/>

                                </h:panelGroup>

                                <h:panelGroup styleClass="link-clear" layout="block">
                                    <h:graphicImage url="/_img/icon_clear.png"/>
                                    <a4j:commandLink value="#{lblForm.clear_all}"
                                                     action="#{MbInterchangeFee.clearFilter}"
                                                     reRender="entitySearchForm, entityForm, entityBtnForm, details">
                                    </a4j:commandLink>
                                </h:panelGroup>
                            </h:panelGrid>

                        </h:panelGrid>
                    </h:panelGroup>
                    <a4j:outputPanel ajaxRendered="true">
                        <h:panelGroup styleClass="show-more-vert" layout="block"/>
                        <h:graphicImage url="/_img/hd_searchblock.gif" styleClass="hd-searchblock"/>
                        <h:panelGroup styleClass="collapse-vert" layout="block"/>
                    </a4j:outputPanel>
                </h:panelGroup>
            </h:panelGroup>
        </h:panelGroup>
    </h:panelGroup>
</h:form>

<rich:modalPanel id="modifierEditWindow" autosized="true" minWidth="300" minHeight="100">
    <f:facet name="header">
        <h:panelGroup id="modifierWindowHeader">
            <h:outputText value="#{lblInt.add_edit_modifier}"/>
        </h:panelGroup>
    </f:facet>
    <f:facet name="controls">
    </f:facet>
    <h:panelGroup id="modifierEditWindowDiv">
        <h:form id="modifierWindowForm">
            <h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
                <h:panelGrid columns="1" style="text-align: center" styleClass="cardholderdata">
                    <h:panelGrid columns="2" columnClasses="column80 column_lpad20, column20">
                        <h:inputTextarea style="min-width: 100%;height: 162px" disabled="true" id="modifierField"
                                         value="#{MbInterchangeFee.activeCriteria.modifier}" cols="40">
                            <f:validateLength maximum="4000"/>
                        </h:inputTextarea>
                        <h:panelGroup>
                            <h:panelGrid columns="1">
                                <bre:taggedCommandButton styleClass="fw" value="#{lblForm.clear_all}"
                                                         image="/_img/icon_clear.png"
                                                         onclick="clearModifier();return false;"/>
                                <bre:taggedCommandButton styleClass="fw" value="#{lblInt.backspace}"
                                                         image="/_img/backspace.png"
                                                         onclick="backspaceModifier();return false;"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2" cellspacing="0" style="margin-top: 50px; width: 105px"
                                         cellpadding="0">
                                <bre:taggedCommandButton styleClass="fw" value="("
                                                         onclick="appendModifier('(');return false;"/>
                                <bre:taggedCommandButton styleClass="fw" value=")"
                                                         onclick="appendModifier(')');return false;"/>
                                <bre:taggedCommandButton styleClass="fw" value="AND"
                                                         onclick="appendModifierAnd();return false;"/>
                                <bre:taggedCommandButton styleClass="fw" value="OR"
                                                         onclick="appendModifier('||');return false;"/>
                            </h:panelGrid>
                        </h:panelGroup>
                        <h:panelGrid columns="3">
                            <h:selectOneMenu id="parameter" style="width: 200px"
                                             label="#{lblInt.parameter}"
                                             immediate="true"
                                             value="#{MbInterchangeFee.parameter}">
                                <a4j:support event="onchange" ajaxSingle="true"
                                             reRender="wrapValue"/>
                                <f:selectItems value="#{MbInterchangeFee.parameters}"/>
                            </h:selectOneMenu>
                            <h:selectOneMenu id="operator"
                                             value="#{MbInterchangeFee.operator}"
                                             immediate="true"
                                             style="width: 50px" label="#{lblInt.operator}">
                                <a4j:support event="onchange" ajaxSingle="true"
                                             reRender="wrapValue"/>
                                <f:selectItems value="#{MbInterchangeFee.operators}" itemLabelEscaped="true"/>
                            </h:selectOneMenu>
                            <h:panelGrid id="wrapValue" columns="1" cellspacing="0" cellpadding="0">
                                <h:panelGroup rendered="#{MbInterchangeFee.operator=='IN'}">
                                    <h:inputText id="inValue"
                                                 style="width: 150px"/>
                                    <h:panelGrid columns="2" style="width: 150px">
                                        <h:inputText id="inStringValue"
                                                     rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='S' and MbInterchangeFee.dictionaries[MbInterchangeFee.parameter]==null and
                                         not MbInterchangeFee.countryParam and not MbInterchangeFee.currencyParam}"
                                                     style="width: 106px"/>
                                        <h:inputText id="inDigitValue"
                                                     rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='N'}"
                                                     style="width: 112px"
                                                     onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;"/>
                                        <h:panelGrid columns="2"
                                                     rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='D'}"
                                                     style="width: 79px">
                                            <h:inputText id="inDateValue"
                                                         style="width: 79px"
                                                         onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('inDateValue')}, #{rich:element('inDateValueBtn')});">
                                                <f:convertDateTime pattern="yyyy-MM-dd HH:mm"
                                                                   timeZone="#{CommonUtils.timeZone}"/>
                                            </h:inputText>
                                            <h:graphicImage
                                                    id="inDateValueBtn"
                                                    value="/images/calendar.gif"
                                                    onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('inDateValue')}, #{rich:element('inDateValueBtn')});"/>
                                        </h:panelGrid>
                                        <h:selectOneMenu id="inBooleanValue" style="width: 112px"
                                                         rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='B'}">
                                            <f:selectItem itemLabel="true" itemValue="true"/>
                                            <f:selectItem itemLabel="false" itemValue="false"/>
                                        </h:selectOneMenu>
                                        <h:selectOneMenu id="inDictValue" style="width: 112px"
                                                         rendered="#{MbInterchangeFee.dictionaries[MbInterchangeFee.parameter]!=null}">
                                            <f:selectItems
                                                    value="#{MbInterchangeFee.paramDict}"/>
                                        </h:selectOneMenu>
                                        <h:selectOneMenu id="inCountryValue" style="width: 112px"
                                                         rendered="#{MbInterchangeFee.countryParam}">
                                            <f:selectItems value="#{CountryUtils.allCountries}"/>
                                        </h:selectOneMenu>
                                        <h:selectOneMenu id="inCurrencyValue" style="width: 112px"
                                                         rendered="#{MbInterchangeFee.currencyParam}">
                                            <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                                        </h:selectOneMenu>
                                        <bre:taggedCommandButton image="/images/plus.png"
                                                                 style="width:38px"
                                                                 onclick="appendIn();return false;"/>
                                    </h:panelGrid>
                                </h:panelGroup>
                                <h:panelGroup rendered="#{MbInterchangeFee.operator!='IN'}">
                                    <h:inputText id="stringValue"
                                                 rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='S' and MbInterchangeFee.dictionaries[MbInterchangeFee.parameter]==null and
                                         not MbInterchangeFee.countryParam and not MbInterchangeFee.currencyParam}"
                                                 style="width: 150px"/>
                                    <h:inputText id="digitValue"
                                                 rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='N'}"
                                                 style="width: 150px"
                                                 onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;"/>
                                    <h:panelGrid columns="2"
                                                 rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='D'}"
                                                 style="width: 150px">
                                        <h:inputText id="dateValue"
                                                     style="width: 130px"
                                                     onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('dateValue')}, #{rich:element('dateValueBtn')});">
                                            <f:convertDateTime pattern="yyyy-MM-dd HH:mm"
                                                               timeZone="#{CommonUtils.timeZone}"/>
                                        </h:inputText>
                                        <h:graphicImage
                                                id="dateValueBtn"
                                                value="/images/calendar.gif"
                                                onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('dateValue')}, #{rich:element('dateValueBtn')});"/>
                                    </h:panelGrid>
                                    <h:selectOneMenu id="booleanValue" style="width: 150px"
                                                     rendered="#{MbInterchangeFee.dataTypes[MbInterchangeFee.parameter]=='B'}">
                                        <f:selectItem itemLabel="true" itemValue="true"/>
                                        <f:selectItem itemLabel="false" itemValue="false"/>
                                    </h:selectOneMenu>
                                    <h:selectOneMenu id="dictValue" style="width: 150px"
                                                     rendered="#{MbInterchangeFee.dictionaries[MbInterchangeFee.parameter]!=null}">
                                        <f:selectItems
                                                value="#{MbInterchangeFee.paramDict}"/>
                                    </h:selectOneMenu>
                                    <h:selectOneMenu id="countryValue" style="width: 150px"
                                                     rendered="#{MbInterchangeFee.countryParam}">
                                        <f:selectItems value="#{CountryUtils.allCountries}"/>
                                    </h:selectOneMenu>
                                    <h:selectOneMenu id="currencyValue" style="width: 150px"
                                                     rendered="#{MbInterchangeFee.currencyParam}">
                                        <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                                    </h:selectOneMenu>
                                </h:panelGroup>
                            </h:panelGrid>
                        </h:panelGrid>
                        <bre:taggedCommandButton id="addExprBtn"
                                                 image="/images/create_doc.gif"
                                                 style="width:100%"
                                                 value="#{lblForm.add}"
                                                 onclick="appendModifierExpression();return false;"/>
                    </h:panelGrid>

                </h:panelGrid>
            </h:panelGroup>
            <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
                <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
                    <h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
                        <h:outputText/>
                        <bre:taggedCommandButton value="#{lblForm.save}"
                                                 onclick="saveModifier();Richfaces.hideModalPanel('modifierEditWindow');return false;"
                                />
                        <bre:taggedCommandButton value="#{lblForm.cancel}"
                                                 onclick="Richfaces.hideModalPanel('modifierEditWindow');return false;"/>
                    </h:panelGrid>
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </h:panelGroup>
</rich:modalPanel>

<rich:modalPanel id="feeEditWindow" autosized="true" minWidth="300" minHeight="100">
    <f:facet name="header">
        <h:panelGroup id="editWindowHeader">
            <h:outputText value="#{lblInt.add_edit_fee}"/>
        </h:panelGroup>
    </f:facet>
    <f:facet name="controls">
    </f:facet>
    <h:panelGroup id="feeEditWindowDiv">
        <h:form id="feeWindowForm">
            <h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
                <h:panelGrid id="fields" columns="2" styleClass="cardholderdata"
                             columnClasses="firstColModal nowrap top, width250">
                    <h:outputLabel value="* #{lblInt.type}:" title="#{lblInt.type}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="type" value="#{MbInterchangeFee.activeItem.type}" label="#{lblInt.type}">
                            <a4j:support event="onchange" ajaxSingle="true"
                                         reRender="amountValue,amountLabel,percentValue,percentLabel"/>
                            <f:selectItem itemValue="0" itemLabel="#{lblInt.fixed_value}"/>
                            <f:selectItem itemValue="1" itemLabel="#{lblInt.percent}"/>
                            <f:selectItem itemValue="2" itemLabel="#{lblInt.min_fix_percent}"/>
                            <f:selectItem itemValue="3" itemLabel="#{lblInt.max_fix_percent}"/>
                            <f:selectItem itemValue="4" itemLabel="#{lblInt.fix_percent}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:panelGroup id="amountLabel" layout="inline">
                        <h:outputLabel value="* #{lblInt.amount}:" title="#{lblInt.amount}"
                                       rendered="#{MbInterchangeFee.activeItem.type!=1}"/>
                    </h:panelGroup>
                    <h:panelGrid id="amountValue" columns="1" cellspacing="0" cellpadding="0">
                        <h:inputText id="amount"
                                     value="#{MbInterchangeFee.activeItem.amount}"
                                     label="#{lblInt.amount}"
                                     required="#{MbInterchangeFee.activeItem.type!=1}"
                                     rendered="#{MbInterchangeFee.activeItem.type!=1}">
                            <f:convertNumber/>
                        </h:inputText>
                        <rich:message for="amount" styleClass="errorMarker" id="amountError"/>
                    </h:panelGrid>

                    <h:panelGroup id="percentLabel" layout="inline">
                        <h:outputLabel value="* #{lblInt.percent}:" title="#{lblInt.percent}"
                                       rendered="#{MbInterchangeFee.activeItem.type!=0}"/>
                    </h:panelGroup>
                    <h:panelGrid id="percentValue" columns="1" cellspacing="0" cellpadding="0">
                        <h:inputText id="percent" value="#{MbInterchangeFee.activeItem.percent}"
                                     label="#{lblInt.percent}"
                                     required="#{MbInterchangeFee.activeItem.type!=0}"
                                     rendered="#{MbInterchangeFee.activeItem.type!=0}"/>
                        <rich:message for="percent" styleClass="errorMarker" id="percentError"/>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.currency}:" title="#{lblInt.currency}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="currency" value="#{MbInterchangeFee.activeItem.currency}"
                                         label="#{lblInt.currency}">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.dest_currency}:" title="#{lblInt.dest_currency}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="destCurrency" value="#{MbInterchangeFee.activeItem.destinationCurrency}"
                                         label="#{lblInt.dest_currency}">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{CurrencyUtils.allCurrencies}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="* #{lblInt.src_amount}:" title="#{lblInt.src_amount}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="srcAmount" value="#{MbInterchangeFee.activeItem.sourceAmount}"
                                         label="#{lblInt.src_amount}"
                                         required="true">
                            <f:selectItem itemValue="0" itemLabel="#{lblInt.operation_amount}"/>
                            <f:selectItem itemValue="1" itemLabel="#{lblInt.settlement_amount}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                </h:panelGrid>
            </h:panelGroup>
            <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
                <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
                    <h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
                        <h:outputText/>
                        <bre:taggedCommandButton value="#{lblForm.save}" id="saveBtn"
                                                 action="#{MbInterchangeFee.saveFee}"
                                                 reRender="entityTable"
                                                 oncomplete="if(#{usession.noErrorResponse}) Richfaces.hideModalPanel('feeEditWindow')"
                                />
                        <bre:taggedCommandButton value="#{lblForm.cancel}" id="cancelBtn"
                                                 onclick="Richfaces.hideModalPanel('feeEditWindow');return false;"/>
                    </h:panelGrid>
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </h:panelGroup>
</rich:modalPanel>

<rich:modalPanel id="criteriaEditWindow" autosized="true" minWidth="300" minHeight="100">
    <f:facet name="header">
        <h:panelGroup id="criteriaWindowHeader">
            <h:outputText value="#{lblInt.add_edit_criteria}"/>
        </h:panelGroup>
    </f:facet>
    <f:facet name="controls">
    </f:facet>
    <h:panelGroup id="criteriaEditWindowDiv">
        <h:form id="criteriaWindowForm">
            <h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
                <h:panelGrid columns="2" styleClass="cardholderdata" columnClasses="firstColModal nowrap top, width250">
                    <h:outputLabel value="* #{lblInt.modifier}:" title="#{lblInt.modifier}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:inputTextarea id="modifier" cols="30" rows="10"
                                         value="#{MbInterchangeFee.activeCriteria.modifier}"
                                         label="#{lblInt.modifier}" required="true"/>
                        <rich:message for="modifier" styleClass="errorMarker" id="modifierError"/>
                        <bre:taggedCommandButton image="/images/edit.gif"
                                                 value="#{lblForm.wizard}"
                                                 acttion="#{MbInterchangeFee.resetParameter}"
                                                 reRender="modifierEditWindow"
                                                 onclick="showModifierEdit();return false;"/>
                    </h:panelGrid>
                    <h:outputLabel value="#{lblInt.oper_type}:" title="#{lblInt.oper_type}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="operType" value="#{MbInterchangeFee.activeCriteria.operType}"
                                         label="#{lblInt.oper_type}">
                            <f:selectItem itemValue=""/>
                            <f:selectItems value="#{DictUtils.operTypes}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.iss_country}:" title="#{lblInt.iss_country}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="issCountry" value="#{MbInterchangeFee.activeCriteria.issCountry}"
                                         label="#{lblInt.iss_country}">
                            <f:selectItem itemValue=""/>
                            <f:selectItems value="#{CountryUtils.allCountries}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.iss_region}:" title="#{lblInt.iss_region}"
                                   rendered="#{MbInterchangeFee.mcRegions!=null and not MbInterchangeFee.regionsEmpty}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0"
                                 rendered="#{MbInterchangeFee.mcRegions!=null and not MbInterchangeFee.regionsEmpty}">
                        <h:selectOneMenu id="issRegion" value="#{MbInterchangeFee.activeCriteria.issRegion}"
                                         label="#{lblInt.iss_region}">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{MbInterchangeFee.mcRegions}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.acq_country}:" title="#{lblInt.acq_country}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:selectOneMenu id="acqCountry" value="#{MbInterchangeFee.activeCriteria.acqCountry}"
                                         label="#{lblInt.acq_country}">
                            <f:selectItem itemValue=""/>
                            <f:selectItems value="#{CountryUtils.allCountries}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="#{lblInt.acq_region}:" title="#{lblInt.acq_region}"
                                   rendered="#{MbInterchangeFee.mcRegions!=null and not MbInterchangeFee.regionsEmpty}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0"
                                 rendered="#{MbInterchangeFee.mcRegions!=null and not MbInterchangeFee.regionsEmpty}">
                        <h:selectOneMenu id="acqRegion" value="#{MbInterchangeFee.activeCriteria.acqRegion}"
                                         label="#{lblInt.acq_region}">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{MbInterchangeFee.mcRegions}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <h:outputLabel value="* #{lblInt.priority}:" title="#{lblInt.priority}"/>
                    <h:panelGrid columns="1" cellspacing="0" cellpadding="0">
                        <h:inputText id="priority" value="#{MbInterchangeFee.activeCriteria.priority}"
                                     label="#{lblInt.priority}" required="true"/>
                        <rich:message for="priority" styleClass="errorMarker" id="priorityError"/>
                    </h:panelGrid>

                    <h:outputLabel value="* #{lblInt.start_date}:" title="#{lblInt.start_date}"/>
                    <h:panelGroup>
                        <h:inputText id="startDate" style="max-width:225px"
                                     required="true"
                                     label="#{lblInt.start_date}"
                                     value="#{MbInterchangeFee.activeCriteria.startDate}"
                                     onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('startDate')}, #{rich:element('startDateBtn')});">
                            <f:convertDateTime pattern="yyyy-MM-dd HH:mm"
                                               timeZone="#{CommonUtils.timeZone}"/>
                        </h:inputText>
                        <h:graphicImage
                                id="startDateBtn"
                                style="vertical-align: bottom; margin-left: 5px"
                                value="/images/calendar.gif"
                                onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('startDate')}, #{rich:element('startDateBtn')});"/>
                        <rich:message for="startDate" styleClass="errorMarker" id="startDateError"/>
                    </h:panelGroup>

                    <h:outputLabel value="#{lblInt.end_date}:" title="#{lblInt.end_date}"/>
                    <h:panelGroup>
                        <h:inputText id="endDate" style="max-width:225px"
                                     label="#{lblInt.end_date}"
                                     value="#{MbInterchangeFee.activeCriteria.endDate}"
                                     onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('endDate')}, #{rich:element('endDateBtn')});">
                            <f:convertDateTime pattern="yyyy-MM-dd HH:mm"
                                               timeZone="#{CommonUtils.timeZone}"/>
                        </h:inputText>
                        <h:graphicImage
                                id="endDateBtn"
                                style="vertical-align: bottom; margin-left: 5px"
                                value="/images/calendar.gif"
                                onclick="#{rich:component('calendar')}.customExpand(event, #{rich:element('endDate')}, #{rich:element('endDateBtn')});"/>
                    </h:panelGroup>
                </h:panelGrid>
            </h:panelGroup>
            <h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
                <h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
                    <h:panelGrid columns="3" columnClasses="width99P,,paddingR12">
                        <h:outputText/>
                        <bre:taggedCommandButton
                                value="#{lblForm.save}"
                                id="criteriaSaveBtn"
                                action="#{MbInterchangeFee.saveCriteria}"
                                reRender="criteriasTable"
                                oncomplete="if(#{usession.noErrorResponse}) Richfaces.hideModalPanel('criteriaEditWindow')"
                                />
                        <bre:taggedCommandButton
                                value="#{lblForm.cancel}"
                                id="criteriaCancelBtn"
                                onclick="Richfaces.hideModalPanel('criteriaEditWindow');return false;"
                                />
                    </h:panelGrid>
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </h:panelGroup>
</rich:modalPanel>

<ui:include src="/pages/utils/confirmPanel.jspx">
    <ui:param name="backingBean" value="#{MbInterchangeFee}"/>
    <ui:param name="yesAction" value="deleteFee"/>
    <ui:param name="warningMsg" value="#{lblMsg.confirm_delete}"/>
    <ui:param name="rerenderList" value="entityTable"/>
    <ui:param name="confirmQuestion" value=" "/>
    <ui:param name="subviewId" value="entityConf"/>
    <ui:param name="yes" value="#{lblForm.ok}"/>
    <ui:param name="no" value="#{lblForm.cancel}"/>
</ui:include>

<ui:include src="/pages/utils/confirmPanel.jspx">
    <ui:param name="backingBean" value="#{MbInterchangeFee}"/>
    <ui:param name="yesAction" value="deleteCriteria"/>
    <ui:param name="warningMsg" value="#{lblMsg.confirm_delete}"/>
    <ui:param name="rerenderList" value="criteriasTable, criteriaButtonsPanel"/>
    <ui:param name="confirmQuestion" value=" "/>
    <ui:param name="subviewId" value="criteriaConf"/>
    <ui:param name="yes" value="#{lblForm.ok}"/>
    <ui:param name="no" value="#{lblForm.cancel}"/>
</ui:include>

<h:form id="entityForm">
    <!-- result panel -->
    <h:panelGroup styleClass="search_result_block" layout="block">
        <h:panelGroup styleClass="search_result_block_left fix-ff"
                      layout="block">
            <h:panelGroup id="mainTableWrapper" layout="block"
                          styleClass="search_result_block_inner">
                <a4j:jsFunction name="updateTabs"
                                reRender="criteriasTab, buttonsPanel">
                </a4j:jsFunction>
                <rich:extendedDataTable id="entityTable" styleClass="res-table"
                                        tableState="#{MbInterchangeFee.tableState}"
                                        headerClass="res-table-header" rowClasses=",odd"
                                        selectedClass="res-table-selected" var="item"
                                        value="#{MbInterchangeFee.items}"
                                        selection="#{MbInterchangeFee.itemSelection}"
                                        rows="#{MbInterchangeFee.rowsNum}" selectionMode="single"
                                        width="100%" height="255px" enableContextMenu="true"
                                        onselectionchange="updateTabs()"
                                        noDataLabel="#{MbInterchangeFee.searching ? lblCommon.no_records_found : lblCommon.enter_search_criteria_above}">

                    <rich:column label="#{lblInt.id}" title="#{lblInt.id}" sortBy="#{'id'}" width="5%">
                        <f:facet name="header">
                            <a4j:outputPanel layout="none">
                                <h:outputText value="#{lblInt.id}" title="#{lblInt.id}"/>
                            </a4j:outputPanel>
                        </f:facet>
                        <h:outputText value="#{item.id}" title="#{item.id}"/>
                    </rich:column>
                    <rich:column label="#{lblInt.type}" title="#{lblInt.type}" sortBy="#{'type'}" width="15%">
                        <f:facet name="header">
                            <a4j:outputPanel layout="none">
                                <h:outputText value="#{lblInt.type}" title="#{lblInt.type}"/>
                            </a4j:outputPanel>
                        </f:facet>
                        <h:outputText rendered="#{item.type==0}" value="#{lblInt.fixed_value}"
                                      title="#{lblInt.fixed_value}"/>
                        <h:outputText rendered="#{item.type==1}" value="#{lblInt.percent}" title="#{lblInt.percent}"/>
                        <h:outputText rendered="#{item.type==2}" value="#{lblInt.min_fix_percent}"
                                      title="#{lblInt.min_fix_percent}"/>
                        <h:outputText rendered="#{item.type==3}" value="#{lblInt.max_fix_percent}"
                                      title="#{lblInt.max_fix_percent}"/>
                        <h:outputText rendered="#{item.type==4}" value="#{lblInt.fix_percent}"
                                      title="#{lblInt.fix_percent}"/>
                    </rich:column>
                    <rich:column label="#{lblInt.amount}" style="text-align: right" sortBy="#{'amount'}" width="10%">
                        <f:facet name="header">
                            <h:panelGroup style="overflow-x:hidden">
                                <h:outputText value="#{lblInt.amount}" title="#{lblInt.amount}"/>
                            </h:panelGroup>
                        </f:facet>
                        <h:panelGroup rendered="#{item.amount!=null}">
                            <div class="#{EntityIcons.objectsMapS['ENTT0046'][item.currency]}"
                                 style="float:right; margin: 0 0 0 10px;"/>
                        </h:panelGroup>
                        <h:outputLabel rendered="#{item.amount!=null}" value="#{item.amount}">
                            <f:convertNumber pattern="#####0.00####"/>
                        </h:outputLabel>
                        <h:outputLabel rendered="#{item.amount!=null}"
                                       value=" #{CurrencyUtils.currencyShortNamesMap[item.currency]}"/>
                        <h:outputText rendered="#{item.amount==null}" value="-"/>
                    </rich:column>
                    <rich:column label="#{lblInt.percent}" title="#{lblInt.percent}" sortBy="#{'percent'}"
                                 style="text-align: right" width="10%">
                        <f:facet name="header">
                            <a4j:outputPanel layout="none">
                                <h:outputText value="#{lblInt.percent}" title="#{lblInt.percent}"/>
                            </a4j:outputPanel>
                        </f:facet>
                        <h:outputText rendered="#{item.percent!=null}" value="#{item.percent}"
                                      title="#{item.percent}">
                            <f:convertNumber pattern="###0.00"/>
                        </h:outputText>
                        <h:outputText rendered="#{item.percent!=null}" value="%"/>
                        <h:outputText rendered="#{item.percent==null}" value="-"/>
                    </rich:column>
                    <rich:column label="#{lblInt.dest_currency}" title="#{lblInt.dest_currency}"
                                 sortBy="#{'destinationCurrency'}" width="10%">
                        <f:facet name="header">
                            <h:panelGroup style="overflow-x:hidden">
                                <h:outputText value="#{lblInt.dest_currency}" title="#{lblInt.dest_currency}"/>
                            </h:panelGroup>
                        </f:facet>

                        <div style="width: 45px; margin: 0 auto">
                            <div class="#{EntityIcons.objectsMapS['ENTT0046'][item.destinationCurrency]}"/>
                            <bm:entityDisplay contextType="ENTTOPER" bean="MbOperations"
                                              value="#{CurrencyUtils.currencyShortNamesMap[item.destinationCurrency]}"/>
                        </div>
                    </rich:column>
                    <rich:column label="#{lblInt.src_amount}" title="#{lblInt.src_amount}" sortBy="#{'sourceAmount'}"
                                 width="20%">
                        <f:facet name="header">
                            <a4j:outputPanel layout="none">
                                <h:outputText value="#{lblInt.src_amount}" title="#{lblInt.src_amount}"/>
                            </a4j:outputPanel>
                        </f:facet>
                        <h:outputText rendered="#{item.sourceAmount==0}" value="#{lblInt.operation_amount}"
                                      title="#{lblInt.operation_amount}"/>
                        <h:outputText rendered="#{item.sourceAmount==1}" value="#{lblInt.settlement_amount}"
                                      title="#{lblInt.settlement_amount}"/>
                    </rich:column>
                </rich:extendedDataTable>
            </h:panelGroup>
            <a4j:outputPanel ajaxRendered="true">
                <h:panelGroup id="show_more_panel" styleClass="show-more-vert show-more-result-tab" layout="block"/>
                <h:graphicImage url="/_img/hd_searchblock.gif"
                                styleClass="hd-searchblock"/>
                <h:panelGroup styleClass="collapse-vert table-collapse-vert"
                              layout="block"/>
            </a4j:outputPanel>
        </h:panelGroup>
    </h:panelGroup>
</h:form>

<!-- navigation footer-->
<h:form id="entityBtnForm">
    <h:panelGroup layout="block" styleClass="bottom_search_result_block" id="bottomSearchResultBlock">
        <h:panelGroup layout="block" styleClass="bottom_search_result_left">
            <h:panelGroup layout="block" styleClass="table_tools" id="tableTools">
                <h:panelGrid styleClass="fw field-cont" columns="5"
                             columnClasses="per-page-lbl,per-page-sel,nav-cont,pagecount, table_tools_state">
                    <h:outputLabel for="rows_num" value="#{lblCommon.rows_per_page}"
                                   title="#{lblCommon.rows_per_page}"/>
                    <h:selectOneMenu id="rows_num" value="#{MbInterchangeFee.rowsNum}"
                                     style="width:50px">
                        <a4j:support event="onchange" reRender="entityBtnForm, entityForm"/>
                        <f:selectItems value="#{CommonUtils.rowNumsList}"/>
                    </h:selectOneMenu>

                    <rich:datascroller maxPages="10" fastControls="hide"
                                       pagesVar="pages" styleClass="res-datascroller" id="dsentity"
                                       for="entityTable"
                                       reRender="pagesNum"
                                       pageIndexVar="pageIndex">
                        <f:facet name="first">
                            <h:outputText value="&lt;&lt;" styleClass="prev-next"/>
                        </f:facet>
                        <f:facet name="first_disabled">
                            <h:outputText value="&lt;&lt;" styleClass="prev-next-dis"/>
                        </f:facet>
                        <f:facet name="last">
                            <h:outputText value="&gt;&gt;" styleClass="prev-next"/>
                        </f:facet>
                        <f:facet name="last_disabled">
                            <h:outputText value="&gt;&gt;" styleClass="prev-next-dis"/>
                        </f:facet>
                        <f:facet name="previous">
                            <h:outputText value="#{lblCommon.prev}" styleClass="prev-next"/>
                        </f:facet>
                        <f:facet name="previous_disabled">
                            <h:outputText value="#{lblCommon.prev}" styleClass="prev-next-dis"/>
                        </f:facet>
                        <f:facet name="next">
                            <h:outputText value="#{lblCommon.next}" styleClass="prev-next"/>
                        </f:facet>
                        <f:facet name="next_disabled">
                            <h:outputText value="#{lblCommon.next}" styleClass="prev-next-dis"/>
                        </f:facet>
                        <f:facet name="pages">
                        </f:facet>
                    </rich:datascroller>

                    <h:panelGroup id="pagesNum">
                        <h:outputText styleClass="strongClass" value="#{pages} "/>
                        <h:outputText value=" #{lblCommon.pages}"/>
                        <h:outputText value="" style="padding-left: 20px; padding-right: 20px;"/>
                        <h:outputText styleClass="strongClass" value="#{MbInterchangeFee.items.rowCount}"/>
                        <h:outputText value=" #{lblCommon.records}"/>
                        <h:outputText value="" style="padding-left: 20px; padding-right: 20px;"/>
                    </h:panelGroup>

                    <h:panelGroup>
                        <h:graphicImage url="/images/green-tick.png" title="#{lblCommon.save_table_state}"
                                        styleClass="action_icon"
                                        onclick="saveTableState();"/>
                        <h:graphicImage url="/images/red-cross.png" title="#{lblCommon.delete_table_state}"
                                        styleClass="action_icon"
                                        onclick="deleteTableState();"/>
                        <a4j:queue name="tablestatequeue"/>
                        <a4j:jsFunction name="saveTableState" action="#{MbInterchangeFee.saveTableStateDB}"
                                        eventsQueue="tablestatequeue"/>
                        <a4j:jsFunction name="deleteTableState"
                                        action="#{MbInterchangeFee.deleteTableStateDB}"
                                        eventsQueue="tablestatequeue"/>
                    </h:panelGroup>
                </h:panelGrid>
            </h:panelGroup>
            <h:panelGrid id="buttonsPanel" columns="3" styleClass="buttons_block">
                <bre:taggedCommandButton id="addBtn"
                                         value="#{lblForm.add}"
                                         reRender="feeWindowForm"
                                         oncomplete="Richfaces.showModalPanel('feeEditWindow')"
                                         action="#{MbInterchangeFee.prepareAdd}"
                                         image="/images/create_doc.gif"/>
                <bre:taggedCommandButton id="editBtn"
                                         value="#{lblForm.edit}"
                                         reRender="feeWindowForm"
                                         oncomplete="Richfaces.showModalPanel('feeEditWindow')"
                                         disabled="#{MbInterchangeFee.activeItem == null or MbInterchangeFee.activeItem.id==null}"
                                         image="/images/edit.gif"/>
                <bre:taggedCommandButton id="deleteBtn"
                                         value="#{lblForm.delete}"
                                         oncomplete="#{rich:component('entityConf:confirmPanel')}.show()"
                                         disabled="#{MbInterchangeFee.activeItem == null or MbInterchangeFee.activeItem.id==null}"
                                         image="/images/delete.gif"/>
            </h:panelGrid>
        </h:panelGroup>
    </h:panelGroup>
</h:form>

<h:panelGroup styleClass="workplace" id="workplacePanel" layout="block">
    <rich:tabPanel switchType="client" id="details" tabClass="tab-cell"
                   activeTabClass="active-tab-cell" headerClass="tabs"
                   headerSpacing="0px" contentClass="tab-content">

        <rich:tab label="Criterias" name="criteriasTab">
            <f:facet name="label">
                <h:panelGroup styleClass="first tab-label" layout="block">
                    <h:outputText value="Criterias" title="Criterias"/>
                </h:panelGroup>
            </f:facet>
            <h:panelGroup layout="block" id="criteriasTab">

                <h:form id="criteriasForm">
                    <h:panelGroup id="traceWrapper" layout="block" styleClass="carddata-wrapper"
                                  style="height: 100%; overflow-y: auto;overflow-x: hidden;position:relative;">
                        <a4j:jsFunction name="selRow" reRender="criteriaButtonsPanel">
                            <a4j:actionparam name="param" assignTo="#{MbInterchangeFee.criteriaId}"/>
                        </a4j:jsFunction>
                        <rich:extendedDataTable id="criteriasTable" styleClass="res-table"
                                                headerClass="res-table-header" rowClasses=",odd"
                                                selectedClass="res-table-selected" var="item"
                                                onRowClick="selRow('#{item.id}')"
                                                value="#{MbInterchangeFee.feeCriterias}"
                                                selectionMode="single"
                                                width="100%" height="255px" enableContextMenu="true">

                            <rich:column label="#{lblInt.id}" title="#{lblInt.id}" sortBy="#{'id'}" width="3%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.id}" title="#{lblInt.id}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.id}" title="#{item.id}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.name}" title="#{lblInt.name}" sortBy="#{'name'}" width="7%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.name}" title="#{lblInt.name}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.name}" title="#{item.name}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.modifier}" title="#{lblInt.modifier}" sortBy="#{'modifier'}"
                                         width="15%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText escape="true" value="#{lblInt.modifier}"
                                                      title="#{lblInt.modifier}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.modifier}" title="#{item.modifier}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.acq_country}" title="#{lblInt.acq_country}"
                                         sortBy="#{'acqCountry'}" width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.acq_country}" title="#{lblInt.acq_country}"/>
                                    </a4j:outputPanel>
                                </f:facet>

                                <div class="#{CountryUtils.flag[item.acqCountry]}"/>
                                <h:outputText value="#{CountryUtils.countryNamesMap[item.acqCountry]}"
                                              title="#{CountryUtils.countryNamesMap[item.acqCountry]}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.acq_region}" title="#{lblInt.acq_region}"
                                         sortBy="#{'acqRegion'}" width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.acq_region}" title="#{lblInt.acq_region}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{MbInterchangeFee.regionsMap[item.acqRegion]}"
                                              title="#{item.acqRegion}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.iss_country}" title="#{lblInt.iss_country}"
                                         sortBy="#{'issCountry'}" width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.iss_country}" title="#{lblInt.iss_country}"/>
                                    </a4j:outputPanel>
                                </f:facet>

                                <div class="#{CountryUtils.flag[item.issCountry]}"/>
                                <h:outputText value="#{CountryUtils.countryNamesMap[item.issCountry]}"
                                              title="#{CountryUtils.countryNamesMap[item.issCountry]}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.iss_region}" title="#{lblInt.iss_region}"
                                         sortBy="#{'issRegion'}" width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.iss_region}" title="#{lblInt.iss_region}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{MbInterchangeFee.regionsMap[item.issRegion]}"
                                              title="#{item.issRegion}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.oper_type}" title="#{lblInt.oper_type}" sortBy="#{'operType'}"
                                         width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.oper_type}" title="#{lblInt.oper_type}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{DictUtils.operTypesMap[item.operType]}"
                                              title="#{item.operType}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.priority}" title="#{lblInt.priority}" sortBy="#{'priority'}"
                                         width="5%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.priority}" title="#{lblInt.priority}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.priority}" title="#{item.priority}"/>
                            </rich:column>
                            <rich:column label="#{lblInt.start_date}" title="#{lblInt.start_date}" sortBy="#{'startDate'}"
                                         width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.start_date}" title="#{lblInt.start_date}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.startDate}" title="#{item.startDate}">
                                    <f:convertDateTime type="date" pattern="#{usession.fullDatePatternSeconds}"
                                                       timeZone="#{CommonUtils.timeZone}"/>
                                </h:outputText>
                            </rich:column>
                            <rich:column label="#{lblInt.end_date}" title="#{lblInt.end_date}" sortBy="#{'endDate'}"
                                         width="10%">
                                <f:facet name="header">
                                    <a4j:outputPanel layout="none">
                                        <h:outputText value="#{lblInt.end_date}" title="#{lblInt.end_date}"/>
                                    </a4j:outputPanel>
                                </f:facet>
                                <h:outputText value="#{item.endDate}" title="#{item.endDate}">
                                    <f:convertDateTime type="date" pattern="#{usession.fullDatePatternSeconds}"
                                                       timeZone="#{CommonUtils.timeZone}"/>
                                </h:outputText>
                            </rich:column>
                        </rich:extendedDataTable>
                    </h:panelGroup>
                </h:form>
            </h:panelGroup>
        </rich:tab>

    </rich:tabPanel>
</h:panelGroup>

<script type="text/javascript">
    function updateHeight() {
        updateGridHeight();
    }
    //<![CDATA[
    layout =
    {
        SEARCH_FORM_ID: 'entitySearchForm',
        SEARCH_RESULT_FORM_ID: 'entityForm',
        SEARCH_RESULT_FORM_WRAPPER_ID: 'mainTableWrapper',
        SEARCH_RESULT_FOOTER_FORM_ID: 'entityBtnForm',
        TAB_PANEL_ID: 'workplacePanel',

        TAB_DATA: [
            {
                TAB_FORM_ID: 'entityDetailsForm',
                TAB_FORM_WRAPPER_ID: 'entityDetailsWrapper',
                CORRECTING_HEIGHT: Stretch.TABS + Stretch.BUTTONS
            }
        ]
    };
    updateHeight();
    jQuery(window).resize(updateHeight);
    //]]>
</script>
</ui:define>
</ui:composition>

</html>
