<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:bm="http://www.bpc.ru/jsf/misc"
	xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<ui:composition>

	<!-- PARAMETERS -->
	<!-- reRender -->
	
	<script type="text/javascript">//<!--
		function checkVouchersBatchFields() {
			var checked = true;
			
			if (document.getElementById("vouchersBatchEditModalPanelForm:status").disabled == false
					&& document.getElementById("vouchersBatchEditModalPanelForm:status").value == "") {
				document.getElementById("vouchersBatchEditModalPanelForm:statusErr").style.display = "inline";
				checked = false;
			}
			if (document.getElementById("vouchersBatchEditModalPanelForm:currency").disabled == false
					&& document.getElementById("vouchersBatchEditModalPanelForm:currency").value == "") {
				document.getElementById("vouchersBatchEditModalPanelForm:currencyErr").style.display = "inline";
				checked = false;
			}
			if (document.getElementById("vouchersBatchEditModalPanelForm:totalAmount").disabled == false
					&& document.getElementById("vouchersBatchEditModalPanelForm:totalAmount").value == "") {
				document.getElementById("vouchersBatchEditModalPanelForm:totalAmountErr").style.display = "inline";
				checked = false;
			}
			if (document.getElementById("vouchersBatchEditModalPanelForm:totalCount").disabled == false
					&& document.getElementById("vouchersBatchEditModalPanelForm:totalCount").value == "") {
				document.getElementById("vouchersBatchEditModalPanelForm:totalCountErr").style.display = "inline";
				checked = false;
			}
			if (document.getElementById("vouchersBatchEditModalPanelForm:cardNetworkId").disabled == false
					&& document.getElementById("vouchersBatchEditModalPanelForm:cardNetworkId").value == "") {
				document.getElementById("vouchersBatchEditModalPanelForm:cardNetworkIdErr").style.display = "inline";
				checked = false;
			}
			return checked;
		}
		//-->
	</script>

	<rich:modalPanel id="vouchersBatchEditModalPanel" autosized="true"
		minWidth="300" minHeight="100">
		<f:facet name="header">
			<h:panelGroup id="vouchersBatchEditModalPanelHeader">
				<h:outputText value="#{lblVch.edit_vouchers_batch}"
					rendered="#{MbVouchersBatches.editMode}" />
				<h:outputText value="#{lblVch.new_vouchers_batch}"
					rendered="#{MbVouchersBatches.newMode}" />
			</h:panelGroup>
		</f:facet>
		<f:facet name="controls">
		</f:facet>
		<h:form id="vouchersBatchEditModalPanelForm">
			<h:panelGroup layout="block" styleClass="cardholderdata-wrapper">
				<h:panelGrid columns="2" styleClass="cardholderdata"
					columnClasses="firstCol, width250">

					<h:outputLabel for="status" value="* #{lblCommon.status}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<h:selectOneMenu required="true" id="status"
							label="#{lblCommon.status}"
							value="#{MbVouchersBatches.editingItem.status}">
							<f:selectItems value="#{MbVouchersBatches.statuses}" />
							<a4j:support event="onchange" reRender="statusErr"
								limitToList="true" ajaxSingle="true" />
						</h:selectOneMenu>
						<h:outputFormat value="#{lblMsg.value_request}" styleClass="errorMarker"
							id="statusErr" style="display:none;">
							<f:param name="fieldName" value="#{lblCommon.status}"/>
						</h:outputFormat>
					</h:panelGrid>

					<h:outputLabel for="currency" value="* #{lblCommon.currency}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<h:selectOneMenu required="true" id="currency"
							label="#{lblCommon.currency}"
							disabled="#{MbVouchersBatches.editMode}"
							value="#{MbVouchersBatches.editingItem.currency}">
							<f:selectItem itemValue="" />
							<f:selectItems value="#{MbVouchersBatches.currencies}" />
							<a4j:support event="onchange" reRender="currencyErr, totalAmount"
								limitToList="true" ajaxSingle="true" />
						</h:selectOneMenu>
						<h:outputFormat value="#{lblMsg.value_request}" styleClass="errorMarker"
							id="currencyErr" style="display:none;">
							<f:param name="fieldName" value="#{lblCommon.currency}"/>
						</h:outputFormat>
					</h:panelGrid>

					<h:outputLabel for="totalAmount" value="* #{lblVch.total_amount}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<h:inputText id="totalAmount"
							value="#{MbVouchersBatches.editingItem.totalAmount}"
							label="#{lblVch.total_amount}"
							disabled="#{MbVouchersBatches.editMode}">
							<bm:numericMaskConverter numericType="bigdecimal" />
							<f:attribute name="decDigits"
								value="#{CurrencyUtils.currencyObjectsMap[MbVouchersBatches.editingItem.currency].exponent}" />
							<a4j:support event="onchange" reRender="totalAmountErr"
								limitToList="true" ajaxSingle="true" />
						</h:inputText>
						<bm:jsMask for="totalAmount"
							decDigits="#{CurrencyUtils.currencyObjectsMap[MbVouchersBatches.editingItem.currency].exponent}" />
						<h:outputFormat value="#{lblMsg.value_request}" styleClass="errorMarker"
							id="totalAmountErr" style="display:none;">
							<f:param name="fieldName" value="#{lblVch.total_amount}"/>
						</h:outputFormat>
					</h:panelGrid>

					<h:outputLabel for="totalCount" value="* #{lblVch.total_count}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<h:inputText required="true" id="totalCount"
							label="#{lblVch.total_count}"
							disabled="#{MbVouchersBatches.editMode}"
							value="#{MbVouchersBatches.editingItem.totalCount}">
							<a4j:support event="onchange" reRender="totalCountErr"
								limitToList="true" ajaxSingle="true" />
						</h:inputText>
						<h:outputFormat value="#{lblMsg.value_request}" styleClass="errorMarker"
							id="totalCountErr" style="display:none;">
							<f:param name="fieldName" value="#{lblVch.total_count}"/>
						</h:outputFormat>
					</h:panelGrid>

					<h:outputLabel for="cardNetworkId"
						value="* #{lblVch.card_network}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<h:selectOneMenu required="true" id="cardNetworkId"
							disabled="#{MbVouchersBatches.editMode}"
							label="#{lblVch.card_network}"
							value="#{MbVouchersBatches.editingItem.cardNetworkId}">
							<f:selectItem itemValue="" />
							<f:selectItems value="#{MbVouchersBatches.cardNetworks}" />
							<a4j:support event="onchange" reRender="cardNetworkIdErr"
								limitToList="true" ajaxSingle="true" />
						</h:selectOneMenu>
						<h:outputFormat value="#{lblMsg.value_request}" styleClass="errorMarker"
							id="cardNetworkIdErr" style="display:none;">
							<f:param name="fieldName" value="#{lblVch.card_network}"/>
						</h:outputFormat>
					</h:panelGrid>

					<h:outputLabel for="statusReason"
						rendered="#{MbVouchersBatches.editMode and usession.inRole['VIEW_ALL_VOUCHER_BATCHES']}"
						value="#{lblVch.status_reason}:" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0"
						rendered="#{MbVouchersBatches.editMode and usession.inRole['VIEW_ALL_VOUCHER_BATCHES']}">
						<h:selectOneMenu id="statusReason"
							
							label="#{lblVch.status_reason}"
							value="#{MbVouchersBatches.editingItem.statusReason}">
							<f:selectItem itemValue="" />
							<f:selectItems value="#{MbVouchersBatches.statusReasons}" />
							<a4j:support event="onchange" reRender="statusReasonErr"
								limitToList="true" ajaxSingle="true" />
						</h:selectOneMenu>
						<rich:message for="statusReason" id="statusReasonErr"
							styleClass="errorMarker" />
					</h:panelGrid>

					<h:outputLabel for="userName" value="#{lblVch.user_name}:"
						rendered="#{MbVouchersBatches.editMode and usession.inRole['VIEW_ALL_VOUCHER_BATCHES']}" />
					<h:panelGrid columns="1" cellpadding="0" cellspacing="0"
						rendered="#{MbVouchersBatches.editMode and usession.inRole['VIEW_ALL_VOUCHER_BATCHES']}">
						<h:selectOneMenu id="userName"
							label="#{lblVch.status_reason}"
							value="#{MbVouchersBatches.editingItem.userName}">
							<f:selectItem itemValue="" />
							<f:selectItems value="#{MbVouchersBatches.userNames}" />
							<a4j:support event="onchange" reRender="userNameErr"
								limitToList="true" ajaxSingle="true" />
						</h:selectOneMenu>
						<rich:message for="userName" id="userNameErr"
							styleClass="errorMarker" />
					</h:panelGrid>

				</h:panelGrid>
			</h:panelGroup>

			<h:panelGroup layout="block"
				styleClass="bottom_search_result_block_buttons">
				<h:panelGroup layout="block"
					styleClass="bottom_search_result_left_buttons">
					<h:panelGrid columns="3" columnClasses="width99P,,paddingR12">

						<h:outputText />

						<bre:taggedCommandButton value="#{lblForm.save}" type="submit"
							action="#{MbVouchersBatches.saveEditingVouchersBatch}"
							onclick="if (!checkVouchersBatchFields()) return false; disableModalPanelBtns(this)"
							oncomplete="enableModalPanelBtns(this); if (#{usession.noErrorResponse}) 
			                   			#{rich:component('vouchersBatchEditModalPanel')}.hide()"
							reRender="#{reRender}" />

						<bre:taggedCommandButton value="#{lblForm.cancel}"
							action="#{MbVouchersBatches.resetEditingVouchersBatch}"
							immediate="true" limitToList="true"
							oncomplete="#{rich:component('vouchersBatchEditModalPanel')}.hide()">
							<f:actionListener type="ru.bpc.jsf.A4JFormReset" />

						</bre:taggedCommandButton>
					</h:panelGrid>
				</h:panelGroup>
			</h:panelGroup>
		</h:form>
	</rich:modalPanel>
</ui:composition>
</html>