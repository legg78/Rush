<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:bm="http://www.bpc.ru/jsf/misc"
	xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<ui:composition>
	<f:loadBundle var="lblPrd" basename="ru.bpc.sv2.ui.bundles.Prd" />

	<h:form id="customerDetailsForm">
		<h:panelGroup layout="block" styleClass="langSelector">
			<h:panelGrid columns="2" styleClass="cardholderdata oneColumnTable"
					id="detailsData" columnClasses=",secondCol">
				<h:outputLabel for="lang" value="#{lblCommon.lang_selector}: "
						title="#{lblCommon.lang_selector}" />
				<ui:param name="callScript" value="updateContextHeight('#{empty subviewId ? 'contextPanelView' : subviewId}')" />
				<h:selectOneMenu id="lang"
						disabled="#{customersBean.activeCustomer.id == null}"
						value="#{customersBean.curLang}"
						valueChangeListener="#{customersBean.changeLanguage}">
					<a4j:support event="onchange" reRender="customerDetailsForm"
							limitToList="true" oncomplete="#{mode=='context' ? callScript : 'updateHeight()'};"/>
					<f:selectItems value="#{customersBean.languages}" />
				</h:selectOneMenu>
			</h:panelGrid>
		</h:panelGroup>
	
		<h:panelGroup id="customerDetailsWrapper" layout="block" styleClass="carddata-wrapper" 
				style="height: 100%; overflow-y: auto;overflow-x: hidden;position:relative;">
			<rich:dataTable id="customerDetailsTable"
					value="#{customersBean.emptyTable}" 
					var="field"
					styleClass="res-table noHeader" width="100%">
				<rich:columnGroup rowClasses=",odd" 
						columnClasses="firstCol alignLeft width20, width80 width250 noPadding">
					<rich:column styleClass="detailsCategory expandedBranch">
						<h:graphicImage url="/images/minus.gif" onclick="showHideDetails(this)"/>
						<h:outputLabel value="#{lblPrd.general_data}:" />
					</rich:column>
					<rich:column>
                        <script>updateHeight();</script>
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.customer_number}:" title="#{lblPrd.customer_number}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{customersBean.activeCustomer.customerNumber}"
								title="#{customersBean.activeCustomer.customerNumber}"/>
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.institution}:" title="#{lblCommon.institution}"/>
					</rich:column>
					<rich:column>
						<bm:entityDisplay  entityId="#{customersBean.activeCustomer.instId}"
										value="#{customersBean.activeCustomer.instName}"/>
						<h:outputLabel value="" rendered="#{customersBean.activeCustomer == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.id}:" title="#{lblCommon.id}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{customersBean.activeCustomer.id}"
								title="#{customersBean.activeCustomer.id}"/>
					</rich:column>
					
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.agent}:" title="#{lblCommon.agent}"/>
					</rich:column>

					<rich:column>

                        <bm:entityDisplay  entityId="#{customersBean.activeCustomer.agentNumber}"
                                          value="#{customersBean.activeCustomer.agentName}"/>
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.status}:" title="#{lblCommon.status}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.status]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.status]}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblOpr.status_reason}:" title="#{lblOpr.status_reason}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.statusReason]}"
									   title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.statusReason]}"/>
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.category}:" title="#{lblCommon.category}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel rendered="#{customersBean.activeCustomer.category != null}"
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.category]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.category]}"
								/>
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.category == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.relation}:" title="#{lblPrd.relation}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel rendered="#{customersBean.activeCustomer.relation != null}"
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.relation]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.relation]}"
								/>
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.relation == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblCommon.entity_type}:" title="#{lblCommon.entity_type}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.entityType]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.entityType]}"
								rendered="#{customersBean.activeCustomer != null and customersBean.activeCustomer.objectId != null}" />
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.entityType]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.entityType]}"
								rendered="#{customersBean.activeCustomer != null and customersBean.activeCustomer.objectId == null}" />
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.nationality}:" title="#{lblPrd.nationality}"/>
					</rich:column>
					<rich:column>
						<ui:remove><div class="#{CountryUtils.flag[customersBean.activeCustomer.nationality]}" /></ui:remove>
						<div class="#{EntityIcons.objectsMapS['ENTTACCT'][customersBean.activeCustomer.nationality]}" />
						<h:outputLabel
								value="#{CountryUtils.countryNamesMap[customersBean.activeCustomer.nationality]}"
								title="#{CountryUtils.countryNamesMap[customersBean.activeCustomer.nationality]}"
								rendered="#{customersBean.activeCustomer.nationality != null}" />
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.nationality == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.credit_rating}:" title="#{lblPrd.credit_rating}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.creditRating]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.creditRating]}"
								rendered="#{customersBean.activeCustomer.creditRating != null}" />
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.creditRating == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.money_laundry_risk}:" title="#{lblPrd.money_laundry_risk}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.moneyLaundryRisk]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.moneyLaundryRisk]}"
								rendered="#{customersBean.activeCustomer.moneyLaundryRisk != null}" />
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.moneyLaundryRisk == null}" />
					</rich:column>
	
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.money_laundry_reason}:" title="#{lblPrd.money_laundry_reason}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.moneyLaundryReason]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.moneyLaundryReason]}"
								rendered="#{customersBean.activeCustomer.moneyLaundryReason != null}" />
						<h:outputLabel value=""
								rendered="#{customersBean.activeCustomer.moneyLaundryReason == null}" />
					</rich:column>
				
					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.customer_role}:" title="#{lblPrd.customer_role}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel					
								value="#{customersBean.activeCustomer.extObjectName}"
								title="#{customersBean.activeCustomer.extObjectName}"
								/>
					</rich:column>

					<rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.employment_status}:" title="#{lblPrd.employment_status}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel
                                value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.employmentStatus]}"
                                title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.employmentStatus]}"
                                rendered="#{customersBean.activeCustomer.employmentStatus != null}" />
                        <h:outputLabel value=""
                                rendered="#{customersBean.activeCustomer.employmentStatus == null}" />
                    </rich:column>

                    <rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.employment_period}:" title="#{lblPrd.employment_period}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel
                                value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.employmentPeriod]}"
                                title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.employmentPeriod]}"
                                rendered="#{customersBean.activeCustomer.employmentPeriod != null}" />
                        <h:outputLabel value=""
                                rendered="#{customersBean.activeCustomer.employmentPeriod == null}" />
                    </rich:column>

					<rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.resident}:" title="#{lblPrd.resident}"/>
					</rich:column>
					<rich:column>
						<h:outputLabel value="#{customersBean.activeCustomer.resident ? lblCommon.yes : lblCommon.no}"
									   title="#{customersBean.activeCustomer.resident ? lblCommon.yes : lblCommon.no}"
									   rendered="#{customersBean.activeCustomer.resident != null}"/>
					</rich:column>

                    <rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.residence_type}:" title="#{lblPrd.residence_type}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel
                                value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.residenceType]}"
                                title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.residenceType]}"
                                rendered="#{customersBean.activeCustomer.residenceType != null}" />
                        <h:outputLabel value=""
                                rendered="#{customersBean.activeCustomer.residenceType == null}" />
                    </rich:column>

                    <rich:column breakBefore="true">
						<h:outputLabel value="#{lblPrd.marital_status}:" title="#{lblPrd.marital_status}"/>
					</rich:column>
                    <rich:column>
						<h:outputLabel value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.maritalStatus]}"
									   title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.maritalStatus]}" />
                    </rich:column>

                    <rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.marital_status_date}:" title="#{lblPrd.marital_status_date}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel value="#{customersBean.activeCustomer.maritalStatusDate}">
                            <f:convertDateTime pattern="#{usession.datePattern}" timeZone="#{CommonUtils.timeZone}" />
                        </h:outputLabel>
                    </rich:column>

                    <rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.income_range}:" title="#{lblPrd.income_range}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel
                                value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.incomeRange]}"
                                title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.incomeRange]}"
                                rendered="#{customersBean.activeCustomer.incomeRange != null}" />
                        <h:outputLabel value=""
                                rendered="#{customersBean.activeCustomer.incomeRange == null}" />
                    </rich:column>

                    <rich:column breakBefore="true">
                        <h:outputLabel value="#{lblPrd.number_of_children}:" title="#{lblPrd.number_of_children}"/>
                    </rich:column>
                    <rich:column>
                        <h:outputLabel
                                value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.numberOfChildren]}"
                                title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.numberOfChildren]}"
                                rendered="#{customersBean.activeCustomer.numberOfChildren != null}" />
                        <h:outputLabel value=""
                                rendered="#{customersBean.activeCustomer.numberOfChildren == null}" />
                    </rich:column>

					<rich:column
							breakBefore="true"
							rendered="#{customersBean.activeCustomer.referralCode != null}">
						<h:outputLabel
								value="#{lblPrd.referral_code}:" title="#{lblPrd.referral_code}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.referralCode != null}">
						<h:outputLabel value="#{customersBean.activeCustomer.referralCode}"
									   title="#{customersBean.activeCustomer.referralCode}"/>
					</rich:column>

					<rich:column
							breakBefore="true"
							rendered="#{customersBean.activeCustomer.maxAgingPeriod != null}">
						<h:outputLabel
								value="#{lblPrd.aging}:" title="#{lblPrd.aging}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.maxAgingPeriod != null}">
						<h:outputLabel value="#{customersBean.activeCustomer.maxAgingPeriod}"
						               title="#{customersBean.activeCustomer.maxAgingPeriod}"/>
					</rich:column>

					<rich:column styleClass="detailsCategory expandedBranch" breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:graphicImage url="/images/minus.gif" onclick="showHideDetails(this)"/>
						<h:outputLabel value="#{lblPrd.person_data}:" title="#{lblPrd.person_data}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
					</rich:column>

					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.title}:" title="#{lblCommon.title}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.title]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.title]}"
								/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.surname}:" title="#{lblCommon.surname}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel
								value="#{customersBean.activeCustomer.person.surname}"
								title="#{customersBean.activeCustomer.person.surname}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.name}:" title="#{lblCommon.name}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel
								value="#{customersBean.activeCustomer.person.firstName}"
								title="#{customersBean.activeCustomer.person.firstName}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.second_name}:" title="#{lblCommon.second_name}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{customersBean.activeCustomer.person.secondName}"
								title="#{customersBean.activeCustomer.person.secondName}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.suffix}:" title="#{lblCommon.suffix}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.suffix]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.suffix]}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.gender}:" title="#{lblCommon.gender}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.gender]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.person.gender]}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.birthday}:" title="#{lblCommon.birthday}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{customersBean.activeCustomer.person.birthday}">
							<f:convertDateTime pattern="#{usession.datePattern}" timeZone="#{CommonUtils.timeZone}" />
						</h:outputLabel>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{lblCommon.place_of_birth}:" title="#{lblCommon.place_of_birth}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.personCustomer}">
						<h:outputLabel value="#{customersBean.activeCustomer.person.placeOfBirth}"
								title="#{customersBean.activeCustomer.person.placeOfBirth}"/>
					</rich:column>
	
					<rich:column styleClass="detailsCategory expandedBranch" breakBefore="true"
							rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:graphicImage url="/images/minus.gif" onclick="showHideDetails(this)"/>
						<h:outputLabel value="#{lblPrd.company_data}:" title="#{lblPrd.company_data}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.companyCustomer}">
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{lblCommon.short_name}:" title="#{lblCommon.short_name}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{customersBean.activeCustomer.company.label}"
								title="#{customersBean.activeCustomer.company.label}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{lblCommon.embossed_name}:" title="#{lblCommon.embossed_name}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{customersBean.activeCustomer.company.embossedName}"
								title="#{customersBean.activeCustomer.company.embossedName}"/>
					</rich:column>
	
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{lblCommon.full_name}:" title="#{lblCommon.full_name}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel
								value="#{customersBean.activeCustomer.company.description}"
								title="#{customersBean.activeCustomer.company.description}"/>
					</rich:column>
					
					<rich:column breakBefore="true"
							rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel value="#{lblCommon.incorp_form}:" title="#{lblCommon.incorp_form}"/>
					</rich:column>
					<rich:column rendered="#{customersBean.activeCustomer.companyCustomer}">
						<h:outputLabel
								value="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.company.incorp_form]}"
								title="#{DictUtils.articlesByLang[customersBean.curLang][customersBean.activeCustomer.company.incorp_form]}"/>
					</rich:column>
				</rich:columnGroup>
			</rich:dataTable>
			<script>setDetailsState("customerDetailsForm:customerDetailsTable");</script>
		</h:panelGroup>

		<h:panelGroup layout="block" styleClass="bottom_search_result_block_buttons">
			<h:panelGroup layout="block" styleClass="bottom_search_result_left_buttons">
				<bre:taggedCommandButton id="calculateScoringBtn"
										 value="#{lblScr.credit_scoring}"
										 action="#{scoringBean.scoring}"
										 rendered="#{scoringBean != null and usession.inRole['EXECUTE_CREDIT_LIMIT_SCORING']}"
										 oncomplete="if (#{usession.noErrorResponse}) #{rich:component('scoringModalPanel')}.show()"
										 reRender="scoringModalPanel, scoringModalPanelForm"
										 style="margin-top:2px; margin-left: 2px;"/>
			</h:panelGroup>
		</h:panelGroup>
	</h:form>
	
	<script type="text/javascript">updateHeight();</script>
</ui:composition>
</html>
