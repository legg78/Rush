<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
		PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
		"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="cup">
	<select id="get-queue-process" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT out_element_value FROM com_ui_array_conv_elem_vw
			WHERE conv_id IN (SELECT id FROM com_ui_array_conversion_vw WHERE lang = 'LANGENG' AND LABEL = 'QUEUE_PROCESS')
			and in_element_value=#value#
	</select>

	<procedure id="set-estimated" parameterClass="java.lang.Long">
		{call PRC_API_STAT_PKG.SET_ESTIMATED_COUNT(i_estimated_count => #value#)}
	</procedure>

	<procedure id="set-session-file-to-process" parameterClass="java.lang.Long">
		{call PRC_API_SESSION_PKG.SET_SESSION_FILE_ID(i_session_file_id => #value#)}
	</procedure>

	<select id="get-subprocess-progress" parameterClass="java.lang.Long" resultClass="java.lang.Double">
		SELECT	progress_bar FROM prc_ui_progress_prc_vw WHERE external=0 AND session_id = #value#
	</select>

	<select id="get-output-files-id" parameterClass="java.lang.Long" resultClass="java.lang.Long">
		SELECT id FROM prc_session_file WHERE session_id=#value#
	</select>

	<select id="get-total-records" parameterClass="java.lang.Long" resultClass="java.lang.Long">
		SELECT SUM(record_count) FROM prc_session_file WHERE session_id=#value#
	</select>

	<select id="get-process-init-url" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT out_element_value FROM com_ui_array_conv_elem_vw
		WHERE conv_id IN (SELECT id FROM com_ui_array_conversion_vw WHERE lang = 'LANGENG' AND LABEL = 'Process to BPEL URL')
		and in_element_value=#value#
	</select>

	<select id="next_session_file_seq_value" resultClass="java.lang.Long">
		SELECT prc_session_file_seq.nextval FROM dual
	</select>
	<parameterMap id="update_file_session_map" class="java.util.Map">
		<parameter property="session_id"/>
		<parameter property="new_session_id"/>
	</parameterMap>
	<update id="update_file_session" parameterMap="update_file_session_map">
		UPDATE prc_session_file SET session_id=#new_session_id# WHERE session_id=#session_id#
	</update>


	<sql id="limitationOpen">
		SELECT *
		FROM (
	</sql>

	<sql id="limitationOpenCount">
		SELECT count(*)
		FROM (
	</sql>

	<sql id="limitationClose">
		) q
		<isNotNull property="limitation" prepend=" WHERE ">$limitation$</isNotNull>
	</sql>
	<sql id="paginatedOpen">
		SELECT *
		FROM(
		SELECT a.*, rownum r
		FROM(
		<include refid="limitationOpen"/>
	</sql>

	<sql id="paginatedClose">
		<include refid="limitationClose"/>
		) a
		WHERE rownum <![CDATA[<]]>= (#range.end# + 1)
		)
		WHERE r >= (#range.start# + 1)
	</sql>
	<resultMap id="mapping_fin_message"
			   class="ru.bpc.sv2.ps.cup.CupFinMessage">
		<result property="id" column="id"/>
		<result property="acceptorId" column="acceptor_id_code"/>
		<result property="agencyId" column="agency_id"/>
		<result property="settlementAmount" column="sttl_amount"/>
		<result property="transAmount" column="amt_tran"/>
		<result property="appVersionNum" column="app_version_no"/>
		<result property="appAlternChar" column="appl_charact"/>
		<result property="cryptogram" column="appl_crypt"/>
		<result property="authAmount" column="auth_amount"/>
		<result property="authMethod" column="auth_method"/>
		<result property="authRespId" column="auth_resp_id"/>
		<result property="billExchRate" column="bill_exch_rate"/>
		<result property="capacityOfTerm" column="cap_of_term"/>
		<result property="pan" column="card_number"/>
		<result property="cardSerialNum" column="card_serial_num"/>
		<result property="cardholderAccCurrency" column="cardholder_acc_currency"/>
		<result property="cardholderBillAmount" column="cardholder_bill_amount"/>
		<result property="cipherTextInfo" column="cipher_text_inf_data"/>
		<result property="currencyCode" column="code_of_trans_currency"/>
		<result property="collectOnlyFlag" column="collect_only_flag"/>
		<result property="termCountryCode" column="country_code_of_term"/>
		<result property="cupsNotice" column="cups_notice"/>
		<result property="cupsRefNum" column="cups_ref_num"/>
		<result property="dedicDocName" column="dedic_doc_name"/>
		<result property="doubleMessageId" column="double_message_id"/>
		<result property="fileId" column="file_id"/>
		<result property="fileName" column="file_name"/>
		<result property="hostInstId" column="host_inst_id"/>
		<result property="icConditionCode" column="ic_card_cond_code"/>
		<result property="icPosInputMode" column="ic_pos_input_mode"/>
		<result property="icTransCurrencyCode" column="ic_trans_currency_code"/>
		<result property="authId" column="id"/>
		<result property="operId" column="id"/>
		<result property="instId" column="inst_id"/>
		<result property="intOrg" column="int_org"/>
		<result property="interfaceSerial" column="interface_serial"/>
		<result property="isIncoming" column="is_incoming"/>
		<result property="isInvalid" column="is_invalid"/>
		<result property="isRejected" column="is_rejected"/>
		<result property="isReversal" column="is_reversal"/>
		<result property="issBankAppData" column="iss_bank_app_data"/>
		<result property="issue" column="issue"/>
		<result property="issueCode" column="issue_code"/>
		<result property="local" column="local"/>
		<result property="merchCat" column="mcc"/>
		<result property="merchantCountry" column="merchant_country"/>
		<result property="acceptorName" column="mrc_name"/>
		<result property="msgNumber" column="msg_number"/>
		<result property="networkId" column="network_id"/>
		<result property="origTransData" column="orig_trans_data"/>
		<result property="originalId" column="original_id"/>
		<result property="otherAmount" column="other_amount"/>
		<result property="paymentServiceType" column="payment_service_type"/>
		<result property="posConditionCode" column="pos_cond_code"/>
		<result property="posInputMode" column="pos_input_mode"/>
		<result property="readCapacity" column="read_cap_of_term"/>
		<result property="reasonCode" column="reason_code"/>
		<result property="receiveInstId" column="receive_inst_id"/>
		<result property="termVerifResult" column="result_term_verif"/>
		<result property="refNum" column="rrn"/>
		<result property="scriptResult" column="script_result_of_card_issuer"/>
		<result property="sendInstId" column="sending_inst_id"/>
		<result property="serviceFeeAmount" column="service_fee_amount"/>
		<result property="serviceFeeCurrency" column="service_fee_currency"/>
		<result property="serviceFeeExchRate" column="service_fee_exch_rate"/>
		<result property="sessionId" column="session_id"/>
		<result property="settlementExchRate" column="settlement_exch_rate"/>
		<result property="status" column="status"/>
		<result property="sysTraceNum" column="sys_trace_num"/>
		<result property="termCat" column="term_cat"/>
		<result property="acceptorTermId" column="term_id"/>
		<result property="terminalAuthDate" column="terminal_auth_date"/>
		<result property="settlementCurrency" column="sttl_currency"/>
		<result property="transInitChannel" column="tran_init_channel"/>
		<result property="transCat" column="trans_cat"/>
		<result property="appTransCnt" column="trans_cnt"/>
		<result property="transCode" column="trans_code"/>
		<result property="transCurrencyCode" column="tran_curr_code"/>
		<result property="transDate" column="trans_date"/>
		<result property="transFeaturesId" column="trans_features_id"/>
		<result property="transRespCode" column="trans_resp_code"/>
		<result property="transSerialCnt" column="trans_serial_cnt"/>
		<result property="transferred" column="transferred"/>
		<result property="authDate" column="transmission_date_time"/>
		<result property="unpredNumber" column="unpred_num"/>
		<result property="b2bBusinessType" column="b2b_business_type"/>
		<result property="b2bPaymentMedium" column="b2b_payment_medium"/>
	</resultMap>
	<select id="get_fin_messages"
			parameterClass="qparams" resultMap="mapping_fin_message">
		<include refid="paginatedOpen"/>
			SELECT
				 fm.acceptor_id_code
				,fm.agency_id
				,fm.amt_tran
				,fm.app_version_no
				,fm.appl_charact
				,fm.appl_crypt
				,fm.auth_amount
				,fm.auth_method
				,fm.auth_resp_id
				,fm.bill_exch_rate
				,fm.cap_of_term
				,fm.card_number
				,fm.card_serial_num
				,fm.cardholder_acc_currency
				,fm.cardholder_bill_amount
				,fm.cipher_text_inf_data
				,to_char(fm.code_of_trans_currency) as code_of_trans_currency
				,fm.collect_only_flag
				,to_number(fm.country_code_of_term) as country_code_of_term
				,fm.cups_notice
				,fm.cups_ref_num
				,fm.dedic_doc_name
				,fm.double_message_id
				,fm.file_id
				,fm.host_inst_id
				,fm.host_inst_name
				,fm.ic_card_cond_code
				,fm.ic_pos_input_mode
				,fm.ic_trans_currency_code
				,fm.id
				,fm.inst_id
				,fm.inst_name
				,fm.int_org
				,fm.interface_serial
				,fm.is_incoming
				,fm.is_invalid
				,fm.is_rejected
				,fm.is_reversal
				,fm.iss_bank_app_data
				,fm.issue
				,fm.issue_code
				,fm.local
				,to_char(fm.mcc) as mcc
				,fm.merchant_country
				,fm.mrc_name
				,fm.msg_number
				,fm.network_id
				,fm.network_name
				,fm.orig_trans_data
				,fm.original_id
				,fm.other_amount
				,fm.payment_service_type
				,fm.point
				,fm.pos_cond_code
				,fm.pos_input_mode
				,fm.proc_func_code
				,fm.read_cap_of_term
				,fm.reason_code
				,fm.receive_inst_id
				,fm.result_term_verif
				,fm.rrn
				,fm.script_result_of_card_issuer
				,fm.sending_inst_id
				,fm.serv_input_mode_code
				,fm.service_fee_amount
				,fm.service_fee_currency
				,fm.service_fee_exch_rate
				,fm.settlement_exch_rate
				,fm.status
				,fm.status_desc
				,fm.sttl_amount
				,fm.sttl_currency
				,fm.sys_trace_num
				,fm.term_cat
				,fm.term_id
				,fm.terminal_auth_date
				,fm.tran_curr_code
				,fm.tran_init_channel
				,fm.trans_cat
				,fm.trans_cnt
				,to_char(fm.trans_code) as trans_code
				,(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) as trans_date
				,fm.trans_features_id
				,fm.trans_resp_code
				,fm.trans_serial_cnt
				,fm.transferred
				,fm.transmission_date_time
				,fm.unpred_num
				,sf.session_id
				,sf.id session_file_id
				,sf.file_name file_name
				,fm.b2b_business_type
				,fm.b2b_payment_medium
			FROM
				cup_ui_fin_vw fm, prc_ui_session_file_vw sf, cup_file f
	        WHERE
				fm.file_id = f.id(+)
				and f.session_file_id = sf.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
		    <isEqual property="filters[].element" compareValue="lang">fm.lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="operId">fm.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="pan">fm.card_number LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">sf.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmount">fm.amt_tran >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">fm.amt_tran <![CDATA[<=]]>	#filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateFrom">(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateTo">(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) <![CDATA[<=]]>#filters[].value#	</isEqual>
			<isEqual property="filters[].element" compareValue="refNum">fm.rrn = #filters[].value#</isEqual>
		</iterate>
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="operId">fm.id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="sessionId">sf.session_id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="pan">fm.card_number $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="refNum">fm.rrn $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="settlementAmount">fm.amt_tran	$sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="transDate">trans_date $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="outgoing">fm.is_incoming $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
		<include refid="paginatedClose"/>
	</select>

	<select id="get_fin_messages_count"
			parameterClass="qparams"
			resultClass="int">
			SELECT
				count(fm.id)
			FROM
				cup_ui_fin_vw fm, prc_ui_session_file_vw sf, cup_file f
	        WHERE
				fm.file_id = f.id(+)
				and f.session_file_id = sf.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
		    <isEqual property="filters[].element" compareValue="lang">fm.lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="operId">fm.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="pan">fm.card_number LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">sf.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmount">fm.amt_tran >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">fm.amt_tran <![CDATA[<=]]>	#filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateFrom">to_date(fm.trans_date,'MMDDHH24MISS') >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateTo">to_date(fm.trans_date,'MMDDHH24MISS') <![CDATA[<=]]>#filters[].value#	</isEqual>
			<isEqual property="filters[].element" compareValue="refNum">fm.rrn = #filters[].value#</isEqual>
		</iterate>
	</select>

	<resultMap id="mapping_cup_fee"
			   class="ru.bpc.sv2.ps.cup.CupFee">
		<result property="id" column="id"/>
		<result property="feeType" column="fee_type"/>
		<result property="acquirerIin" column="acquirer_iin"/>
		<result property="forwardingIin" column="forwarding_iin"/>
		<result property="sysTraceNum" column="sys_trace_num"/>
		<result property="transmissionDateTime" column="transmission_date_time"/>
		<result property="cardNumber" column="card_number"/>
		<result property="merchantNumber" column="merchant_number"/>
		<result property="authRespCode" column="auth_resp_code"/>
		<result property="reversal" column="is_reversal"/>
		<result property="transTypeId" column="trans_type_id"/>
		<result property="receivingIin" column="receiving_iin"/>
		<result property="issuerIin" column="issuer_iin"/>
		<result property="sttlCurrency" column="sttl_currency"/>
		<result property="sttlSign" column="sttl_sign"/>
		<result property="sttlAmount" column="sttl_amount"/>
		<result property="interchangeFeeSign" column="interchange_fee_sign"/>
		<result property="interchangeFeeAmount" column="interchange_fee_amount"/>
		<result property="reimbursementFeeSign" column="reimbursement_fee_sign"/>
		<result property="reimbursementFeeAmount" column="reimbursement_fee_amount"/>
		<result property="serviceFeeSign" column="service_fee_sign"/>
		<result property="serviceFeeAmount" column="service_fee_amount"/>
		<result property="fileId" column="file_id"/>
		<result property="finMsgId" column="fin_msg_id"/>
		<result property="matchStatus" column="match_status"/>
		<result property="matchStatusDesc" column="match_status_desc"/>
		<result property="instId" column="inst_id"/>
		<result property="instName" column="inst_name"/>
		<result property="reasonCode" column="reason_code"/>
		<result property="operStatus" column="oper_status"/>
		<result property="operId" column="oper_id"/>
		<result property="networkRefnum" column="network_refnum"/>
		<result property="operAmount" column="oper_amount"/>
		<result property="operCurrency" column="oper_currency"/>
		<result property="fileName" column="file_name"/>

	</resultMap>
	<select id="get-cup-file-fees"
			parameterClass="qparams" resultMap="mapping_cup_fee">
		<include refid="paginatedOpen"/>
		SELECT
			a.*
		FROM
			(SELECT
				cf.*,
				op.status oper_status,
				op.id oper_id,
				op.network_refnum,
				op.oper_amount,
				op.oper_currency,
				sf.file_name file_name
			FROM
				cup_ui_fee_vw cf, cup_file f,
				opr_operation op, prc_ui_session_file_vw sf
			WHERE
				nvl(cf.trans_type_id, -1) != 2
				and op.id(+) = cf.id
				and cf.file_id = f.session_file_id(+)
				and cf.file_id = sf.id(+)
				<iterate prepend="AND" conjunction="AND" property="filters">
					<isEqual property="filters[].element" compareValue="lang">cf.lang = #filters[].value#</isEqual>
					<isEqual property="filters[].element" compareValue="fileId">f.id = #filters[].value#</isEqual>
				</iterate>
			UNION ALL
			SELECT
				cf.*,
				op.status oper_status,
				op.id oper_id,
				op.network_refnum,
				op.oper_amount,
				op.oper_currency,
				sf.file_name file_name
			FROM
				cup_ui_fee_vw cf, cup_file f,
				opr_operation op, prc_ui_session_file_vw sf
			WHERE
				cf.trans_type_id = 2
				and op.id(+) = cf.fin_msg_id
				and cf.file_id = f.session_file_id(+)
				and cf.file_id = sf.id(+)
				<iterate prepend="AND" conjunction="AND" property="filters">
					<isEqual property="filters[].element" compareValue="lang">cf.lang = #filters[].value#</isEqual>
					<isEqual property="filters[].element" compareValue="fileId">f.id = #filters[].value#</isEqual>
				</iterate>
			) a
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="id">a.id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="feeType">a.fee_type $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="operStatus">a.oper_status $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="reversal">a.is_reversal $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="cardNumber">a.card_number $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="operId">a.oper_id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="networkRefnum">a.network_refnum $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="operAmount">a.oper_amount $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="sttlAmount">a.sttl_amount $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="fileName">a.file_name $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
		<include refid="paginatedClose"/>
	</select>

	<select id="get-cup-file-fees-count"
			parameterClass="qparams"
			resultClass="int">
		SELECT
			count(a.id)
		FROM
			(SELECT
				cf.id
			FROM
				cup_ui_fee_vw cf, cup_file f,
				opr_operation op
			WHERE
				nvl(cf.trans_type_id, -1) != 2
				and op.id(+) = cf.id
				and cf.file_id = f.session_file_id(+)
				<iterate prepend="AND" conjunction="AND" property="filters">
					<isEqual property="filters[].element" compareValue="lang">cf.lang = #filters[].value#</isEqual>
					<isEqual property="filters[].element" compareValue="fileId">f.id = #filters[].value#</isEqual>
				</iterate>
			UNION ALL
			SELECT
				cf.id
			FROM
				cup_ui_fee_vw cf, cup_file f,
				opr_operation op
			WHERE
				cf.trans_type_id = 2
				and op.id(+) = cf.fin_msg_id
				and cf.file_id = f.session_file_id(+)
				<iterate prepend="AND" conjunction="AND" property="filters">
					<isEqual property="filters[].element" compareValue="lang">cf.lang = #filters[].value#</isEqual>
					<isEqual property="filters[].element" compareValue="fileId">f.id = #filters[].value#</isEqual>
				</iterate>
			) a
	</select>

	<resultMap id="mapping_dispute" class="ru.bpc.sv2.ps.cup.CupDispute">
		<result property="acceptorsIdCode" column="acceptors_id_code"/>
		<result property="acceptorsName" column="acceptors_name"/>
		<result property="acceptorsTermId" column="acceptors_term_id"/>
		<result property="agentIdCode" column="agent_id_code"/>
		<result property="authRespCode" column="auth_resp_code"/>
		<result property="cardholderAccCurrency" column="cardholder_acc_currency"/>
		<result property="cardholderBillAmount" column="cardholder_bill_amount"/>
		<result property="cardholderBillExchRate" column="cardholder_bill_exch_rate"/>
		<result property="cardholderServiceFee" column="cardholder_service_fee"/>
		<result property="clearOperId" column="clear_oper_id"/>
		<result property="commissionPayable" column="commission_payable"/>
		<result property="commissionReceivable" column="commission_receivable"/>
		<result property="exchDate" column="exch_date"/>
		<result property="interchangeServiceFee" column="interchange_service_fee"/>
		<result property="issuer" column="issuer"/>
		<result property="merchantType" column="merchant_type"/>
		<result property="messageType" column="message_type"/>
		<result property="origSysTraceNum" column="orig_sys_trace_num"/>
		<result property="origTransDateTime" column="orig_trans_date_time"/>
		<result property="origTransProcCode" column="orig_trans_proc_code"/>
		<result property="pan" column="pan"/>
		<result property="posCondCode" column="pos_cond_code"/>
		<result property="posEntryMode" column="pos_entry_mode"/>
		<result property="processingCode" column="processing_code"/>
		<result property="receivingInnCode" column="receiving_inn_code"/>
		<result property="responseCode" column="response_code"/>
		<result property="rrn" column="rrn"/>
		<result property="sendersIdCode" column="senders_id_code"/>
		<result property="sessionId" column="session_id"/>
		<result property="sttlAmount" column="sttl_amount"/>
		<result property="sttlCurrency" column="sttl_currency"/>
		<result property="sttlDate" column="sttl_date"/>
		<result property="sttlExchRate" column="sttl_exch_rate"/>
		<result property="sysTraceNum" column="sys_trace_num"/>
		<result property="transAmount" column="trans_amount"/>
		<result property="transCurrency" column="trans_currency"/>
		<result property="transmissionDate" column="transmission_date"/>
	</resultMap>

	<select id="get_disputes"
			parameterClass="qparams" resultMap="mapping_dispute">
		<include refid="paginatedOpen"/>
		SELECT
		id,
		acceptors_id_code,
		acceptors_name,
		acceptors_term_id,
		agent_id_code,
		auth_resp_code,
		cardholder_acc_currency,
		cardholder_bill_amount,
		cardholder_bill_exch_rate,
		cardholder_service_fee,
		clear_oper_id,
		commission_payable,
		commission_receivable,
		exch_date,
		interchange_service_fee,
		issuer,
		merchant_type,
		message_type,
		orig_sys_trace_num,
		orig_trans_date_time,
		orig_trans_proc_code,
		pan,
		pos_cond_code,
		pos_entry_mode,
		processing_code,
		receiving_inn_code,
		response_code,
		rrn,
		senders_id_code,
		session_id,
		sttl_amount,
		sttl_currency,
		sttl_date,
		sttl_exch_rate,
		sys_trace_num,
		trans_amount,
		trans_currency,
		transmission_date
		FROM cup_dispute
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="pan">pan LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountFrom">trans_amount >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">trans_amount <![CDATA[<=]]>
				#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="transmissionDate">trunc(transmission_date) >=
				trunc(#filters[].value#)
			</isEqual>
			<isEqual property="filters[].element" compareValue="transmissionDateTo">trunc(transmission_date) <![CDATA[<=]]>
				trunc(#filters[].value#)
			</isEqual>
			<isEqual property="filters[].element" compareValue="rrn">rrn = #filters[].value#</isEqual>
		</iterate>
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="pan">pan $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="sessionId">session_id $sorting[].direction$
				</isEqual>
				<isEqual property="sorting[].property" compareValue="transAmount">trans_amount $sorting[].direction$
				</isEqual>
				<isEqual property="sorting[].property" compareValue="transmissionDate">transmission_date
					$sorting[].direction$
				</isEqual>
				<isEqual property="sorting[].property" compareValue="rrn">rrn $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
		<include refid="paginatedClose"/>
	</select>

	<select id="get_disputes_count" parameterClass="qparams" resultClass="long">
		SELECT COUNT(1) FROM cup_dispute
		<iterate prepend="WHERE" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="pan">pan LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmount">trans_amount >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">trans_amount <![CDATA[<=]]>
				#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="transmissionDate">transmission_date >=
				#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="transmissionDateTo">transmission_date <![CDATA[<=]]>
				#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="rrn">rrn = #filters[].value#</isEqual>
		</iterate>
	</select>

	<resultMap id="mapping_auth" class="ru.bpc.sv2.ps.cup.CupAuth">
		<result property="rrn" column="rrn"/>
		<result property="acceptorIdCode" column="acceptor_id_code"/>
		<result property="agencyId" column="agency_id"/>
		<result property="amtTran" column="amt_tran"/>
		<result property="appVersionNo" column="app_version_no"/>
		<result property="applCharact" column="appl_charact"/>
		<result property="applCrypt" column="appl_crypt"/>
		<result property="authAmount" column="auth_amount"/>
		<result property="authMethod" column="auth_method"/>
		<result property="authRespId" column="auth_resp_id"/>
		<result property="capOfTerm" column="cap_of_term"/>
		<result property="cardSerialNum" column="card_serial_num"/>
		<result property="cipherTextInfData" column="cipher_text_inf_data"/>
		<result property="codeOfTransCurrency" column="code_of_trans_currency"/>
		<result property="confirmedSessionId" column="confirmed_session_id"/>
		<result property="countryCodeOfTerm" column="country_code_of_term"/>
		<result property="dedicDocName" column="dedic_doc_name"/>
		<result property="icCardCondCode" column="ic_card_cond_code"/>
		<result property="interfaceSerial" column="interface_serial"/>
		<result property="issBankAppData" column="iss_bank_app_data"/>
		<result property="mcc" column="mcc"/>
		<result property="mrcName" column="mrc_name"/>
		<result property="operId" column="oper_id"/>
		<result property="otherAmount" column="other_amount"/>
		<result property="pan" column="pan"/>
		<result property="point" column="point"/>
		<result property="procFuncCode" column="proc_func_code"/>
		<result property="readCapOfTerm" column="read_cap_of_term"/>
		<result property="resultTermVerif" column="result_term_verif"/>
		<result property="reversal" column="reversal"/>
		<result property="scriptResultOfCardIssuer" column="script_result_of_card_issuer"/>
		<result property="sendingInstId" column="sending_inst_id"/>
		<result property="servInputModeCode" column="serv_input_mode_code"/>
		<result property="sysTraceNum" column="sys_trace_num"/>
		<result property="termCat" column="term_cat"/>
		<result property="termId" column="term_id"/>
		<result property="tranCurrCode" column="tran_curr_code"/>
		<result property="tranInitChannel" column="tran_init_channel"/>
		<result property="transCat" column="trans_cat"/>
		<result property="transCnt" column="trans_cnt"/>
		<result property="transDate" column="trans_date"/>
		<result property="transRespCode" column="trans_resp_code"/>
		<result property="transSerialCnt" column="trans_serial_cnt"/>
		<result property="transType" column="trans_type"/>
		<result property="transmissionDateTime" column="transmission_date_time"/>
		<result property="unpredNum" column="unpred_num"/>
	</resultMap>

	<select id="get_auth" parameterClass="string" resultMap="mapping_auth">
		SELECT
		 	rrn,
			acceptor_id_code,
			agency_id,
			amt_tran,
			app_version_no,
			appl_charact,
			appl_crypt,
			auth_amount,
			auth_method,
			auth_resp_id,
			cap_of_term,
			card_serial_num,
			cipher_text_inf_data,
			code_of_trans_currency,
			confirmed_session_id,
			country_code_of_term,
			dedic_doc_name,
			ic_card_cond_code,
			interface_serial,
			iss_bank_app_data,
			mcc,
			mrc_name,
			oper_id,
			other_amount,
			pan,
			point,
			proc_func_code,
			read_cap_of_term,
			result_term_verif,
			reversal,
			script_result_of_card_issuer,
			sending_inst_id,
			serv_input_mode_code,
			sys_trace_num,
			term_cat,
			term_id,
			tran_curr_code,
			tran_init_channel,
			trans_cat,
			trans_cnt,
			trans_date,
			trans_resp_code,
			trans_serial_cnt,
			trans_type,
			transmission_date_time,
			unpred_num
		FROM cup_auth WHERE rrn=#value#
	</select>

	<select id="get_clearing_operation" parameterClass="string" resultMap="mapping_fin_message">
		SELECT
			oper_id,
			acceptor_id,
			acceptor_name,
			acceptor_term_id,
			agency_id,
			app_altern_char,
			app_trans_cnt,
			app_version_num,
			auth_amount,
			auth_date,
			auth_id,
			auth_method,
			auth_resp_id,
			bill_exch_rate,
			capacity_of_term,
			card_serial_num,
			cardholder_acc_currency,
			cardholder_bill_amount,
			cipher_text_info,
			cryptogram,
			cups_notice,
			cups_ref_num,
			currency_code,
			dedic_doc_name,
			double_message_id,
			ic_condititon_code,
			int_org,
			interface_serial,
			iss_bank_app_data,
			issue,
			issue_code,
			merch_cat,
			orig_trans_data,
			other_amount,
			pan,
			payment_service_type,
			pos_input_mode,
			read_capacity,
			reason_code,
			receive_inst_id,
			ref_num,
			script_result,
			send_inst_id,
			service_fee_amount,
			service_fee_currency,
			service_fee_exch_rate,
			session_id,
			settlement_amount,
			settlement_currency,
			settlement_exch_rate,
			sys_trace_num,
			term_cat,
			term_country_code,
			term_verif_result,
			terminal_auth_date,
			trans_amount,
			trans_cat,
			trans_code,
			trans_currency_code,
			trans_date,
			trans_features_id,
			trans_init_channel,
			trans_resp_code,
			trans_serial_cnt,
			transferred,
			unpred_number,
			ic_trans_currency_code,
			ic_pos_input_mode,
			0 as outgoing
		FROM cup_clearing_operation WHERE ref_num=#value#
	</select>

	<resultMap id="mapping_session" class="ru.bpc.sv2.ps.ModuleSession">
		<result property="id" column="id"/>
		<result property="created" column="created"/>
		<result property="fileName" column="filename"/>
		<result property="result" column="result" javaType="boolean"/>
		<result property="succeed" column="succeed"/>
		<result property="total" column="total"/>
	</resultMap>

	<select id="get_sessions" parameterClass="qparams" resultMap="mapping_session">
		<include refid="paginatedOpen"/>
		SELECT
		id,
		created,
		filename,
		result,
		succeed,
		total
		FROM
		cup_session
		WHERE
		1=1
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="id">id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="createdFrom">created >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="createdTo">created <![CDATA[<=]]>#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">filename LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="result">result =
				#filters[].value,javaType=boolean,jdbcType=NUMERIC#
			</isEqual>
		</iterate>
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="id">id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="created">created $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="fileName">filename $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="result">result $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="succeed">succeed $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="total">total $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
		<include refid="paginatedClose"/>
	</select>

	<resultMap id="mapping_session_log" class="ru.bpc.sv2.ps.ModuleSessionTrace">
		<result property="eventDate" column="event_date"/>
		<result property="logLevel" column="log_level"/>
		<result property="logger" column="logger"/>
		<result property="message" column="message"/>
	</resultMap>

	<select id="get_session_log" parameterClass="java.lang.Long" resultMap="mapping_session_log">
		SELECT event_date, log_level, logger, message FROM cup_session_log WHERE session_id=#value#
	</select>

	<select id="get_sessions_count" parameterClass="qparams" resultClass="int">
		SELECT
		COUNT(*)
		FROM
		cup_session
		WHERE
		1=1
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="id">id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="createdFrom">created >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="createdTo">created <![CDATA[<=]]>#filters[].value#
			</isEqual>
			<isEqual property="filters[].element" compareValue="fileName">filename LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="result">result =
				#filters[].value,javaType=boolean,jdbcType=NUMERIC#
			</isEqual>
		</iterate>
	</select>

	<resultMap id="map-get-cup-files" class="ru.bpc.sv2.ps.cup.CupFile">
		<result column="id" property="id" jdbcType="NUMBER" javaType="java.lang.Long"/>
		<result column="is_incoming" property="isIncoming" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="is_rejected" property="isRejected" jdbcType="NUMBER" javaType="java.lang.Boolean"/>
		<result column="inst_id" property="instituteId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="inst_name" property="instituteName" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="network_id" property="networkId" jdbcType="NUMBER" javaType="java.lang.Integer"/>
		<result column="trans_date" property="transDate" jdbcType="DATE" javaType="java.util.Date"/>
		<result column="pack_no" property="packNum" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="version" property="version" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="crc" property="crc" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="encoding" property="encoding" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="file_type" property="fileType" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result column="file_number" property="fileNumber" jdbcType="VARCHAR" javaType="java.lang.Integer"/>
		<result column="action_code" property="actionCode" jdbcType="VARCHAR" javaType="java.lang.Integer"/>
	</resultMap>

	<select id="get-cup-files" parameterClass="qparams" resultMap="map-get-cup-files">
		<include refid="paginatedOpen"/>
		SELECT
			  c.id
			, c.is_incoming
			, c.is_rejected
			, c.network_id
			, c.trans_date
			, c.inst_id
			, c.inst_name
			, c.action_code
			, c.file_number
			, c.pack_no
			, c.version
			, c.crc
			, c.encoding
			, c.file_type
		FROM
			  cup_ui_file_vw c
			, ost_ui_institution_sys_vw i
		WHERE
			  c.inst_id = i.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">i.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileNumber">c.file_number like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="instituteId">c.inst_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="dateFrom">c.trans_date >= TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
			<isEqual property="filters[].element" compareValue="dateTo">c.trans_date <![CDATA[<=]]> TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
		</iterate>
		ORDER BY
			  c.id DESC
		<include refid="paginatedClose"/>
	</select>

	<select id="get-cup-files-count" parameterClass="qparams" resultClass="int">
		SELECT
			  count(*)
		FROM
			  cup_ui_file_vw c
			, ost_ui_institution_sys_vw i
		WHERE
			  c.inst_id = i.id(+)
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="lang">i.lang(+) = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="fileNumber">c.file_number like #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="instituteId">c.inst_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="dateFrom">c.trans_date >= TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
			<isEqual property="filters[].element" compareValue="dateTo">c.trans_date <![CDATA[<=]]> TO_DATE(#filters[].value#, 'DD.MM.YYYY')</isEqual>
		</iterate>
	</select>

	<select id="get-cup-file-fin-messages"
			parameterClass="qparams" resultMap="mapping_fin_message">
		<include refid="paginatedOpen"/>
		SELECT
			  fm.acceptor_id_code
			, fm.agency_id
			, fm.amt_tran
			, fm.app_version_no
			, fm.appl_charact
			, fm.appl_crypt
			, fm.auth_amount
			, fm.auth_method
			, fm.auth_resp_id
			, fm.bill_exch_rate
			, fm.cap_of_term
			, fm.card_number
			, fm.card_serial_num
			, fm.cardholder_acc_currency
			, fm.cardholder_bill_amount
			, fm.cipher_text_inf_data
			, to_char(fm.code_of_trans_currency) as code_of_trans_currency
			, fm.collect_only_flag
			, to_number(fm.country_code_of_term) as country_code_of_term
			, fm.cups_notice
			, fm.cups_ref_num
			, fm.dedic_doc_name
			, fm.double_message_id
			, fm.file_id
			, fm.host_inst_id
			, fm.host_inst_name
			, fm.ic_card_cond_code
			, fm.ic_pos_input_mode
			, fm.ic_trans_currency_code
			, fm.id
			, fm.inst_id
			, fm.inst_name
			, fm.int_org
			, fm.interface_serial
			, fm.is_incoming
			, fm.is_invalid
			, fm.is_rejected
			, fm.is_reversal
			, fm.iss_bank_app_data
			, fm.issue
			, fm.issue_code
			, fm.local
			, to_char(fm.mcc) as mcc
			, fm.merchant_country
			, fm.mrc_name
			, fm.msg_number
			, fm.network_id
			, fm.network_name
			, fm.orig_trans_data
			, fm.original_id
			, fm.other_amount
			, fm.payment_service_type
			, fm.point
			, fm.pos_cond_code
			, fm.pos_input_mode
			, fm.proc_func_code
			, fm.read_cap_of_term
			, fm.reason_code
			, fm.receive_inst_id
			, fm.result_term_verif
			, fm.rrn
			, fm.script_result_of_card_issuer
			, fm.sending_inst_id
			, fm.serv_input_mode_code
			, fm.service_fee_amount
			, fm.service_fee_currency
			, fm.service_fee_exch_rate
			, fm.settlement_exch_rate
			, fm.sttl_amount
			, fm.sttl_currency
			, fm.status
			, fm.status_desc
			, fm.sys_trace_num
			, fm.term_cat
			, fm.term_id
			, fm.terminal_auth_date
			, fm.tran_curr_code
			, fm.tran_init_channel
			, fm.trans_cat
			, fm.trans_cnt
			, to_char(fm.trans_code) as trans_code
			,(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) as trans_date
			, fm.trans_features_id
			, fm.trans_resp_code
			, fm.trans_serial_cnt
			, fm.transferred
			, fm.transmission_date_time
			, fm.unpred_num
			, sf.session_id
			, sf.id session_file_id
			, sf.file_name
			, fm.b2b_business_type
			, fm.b2b_payment_medium
		FROM
			  cup_ui_fin_vw fm
			, prc_ui_session_file_vw sf
			, cup_file f
			, cup_ui_file_vw c
		WHERE
			  fm.file_id = f.id(+)
		AND
		      f.session_file_id = sf.id(+)
		AND
			  fm.file_id = c.id
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="fileId">c.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="lang">fm.lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="operId">fm.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="pan">fm.card_number LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">sf.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmount">fm.amt_tran >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">fm.amt_tran <![CDATA[<=]]>	#filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateFrom">(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateTo">(case when fm.trans_date > to_char(sysdate, 'MMDD') then to_date(fm.trans_date || to_char(ADD_MONTHS(SYSDATE, -12), 'YY'), 'MMDDYY') else to_date(fm.trans_date || to_char(sysdate, 'YY'), 'MMDDYY') end) <![CDATA[<=]]>#filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="refNum">fm.rrn = #filters[].value#</isEqual>
		</iterate>
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="operId">fm.id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="sessionId">sf.session_id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="pan">fm.card_number $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="refNum">fm.rrn $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="settlementAmount">fm.amt_tran	$sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="transDate">trans_date $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="outgoing">fm.is_incoming $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
		<include refid="paginatedClose"/>
	</select>

	<select id="get-cup-file-fin-messages-count" parameterClass="qparams" resultClass="int">
		SELECT
			  count(1)
		FROM
			  cup_ui_fin_vw fm
			, prc_ui_session_file_vw sf
			, cup_file f
			, cup_ui_file_vw c
		WHERE
			  fm.file_id = f.id(+)
		AND
		      f.session_file_id = sf.id(+)
		AND
			  fm.file_id = c.id
		<iterate prepend="AND" conjunction="AND" property="filters">
			<isEqual property="filters[].element" compareValue="fileId">c.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="lang">fm.lang = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="operId">fm.id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="pan">fm.card_number LIKE #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="sessionId">sf.session_id = #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmount">fm.amt_tran >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transAmountTo">fm.amt_tran <![CDATA[<=]]>	#filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateFrom">to_date(fm.trans_date,'MMDDHH24MISS') >= #filters[].value#</isEqual>
			<isEqual property="filters[].element" compareValue="transDateTo">to_date(fm.trans_date,'MMDDHH24MISS') <![CDATA[<=]]>#filters[].value#	</isEqual>
			<isEqual property="filters[].element" compareValue="refNum">fm.rrn = #filters[].value#</isEqual>
		</iterate>
		<iterate prepend="ORDER BY" conjunction=", " property="sorting">
			<isNotEqual property="sorting[].direction" compareValue="AUTO">
				<isEqual property="sorting[].property" compareValue="operId">fm.id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="sessionId">sf.session_id $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="pan">fm.card_number $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="refNum">fm.rrn $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="settlementAmount">fm.amt_tran	$sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="transDate">trans_date $sorting[].direction$</isEqual>
				<isEqual property="sorting[].property" compareValue="outgoing">fm.is_incoming $sorting[].direction$</isEqual>
			</isNotEqual>
		</iterate>
	</select>
</sqlMap>