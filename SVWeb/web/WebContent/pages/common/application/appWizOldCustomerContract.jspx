<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:bpct="http://www.bpc.ru/jsf/tiles" xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext"
	xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j">
	<ui:composition>

		<link rel="stylesheet" type="text/css"
			href="#{request.contextPath}/css/pages/common/application/wizardStartPage.css" />
		<link rel="stylesheet" type="text/css"
			href="#{request.contextPath}/css/pages/common/application/appWizOldCustomerContract.css" />

		<f:loadBundle var="lblOst" basename="ru.bpc.sv2.ui.bundles.Ost" />
		<f:loadBundle var="lblApp" basename="ru.bpc.sv2.ui.bundles.App" />
		<f:loadBundle var="lblIss" basename="ru.bpc.sv2.ui.bundles.Iss" />
		<f:loadBundle var="lblPrd" basename="ru.bpc.sv2.ui.bundles.Prd" />

		<bpct:customerSearchModalPanels id="custSearchPanels"
			extraIdColon="stepPageInclude:" beanName="MbAppWizOldCustomerContract"
			selectMethodName="selectCustomer" reRenderList="customerNumber" />

		<h:form id="appWizOldCustomerContract">

			<h:panelGrid styleClass="filter-table field-cont twoColumnTable"
				columns="2" columnClasses="firstCol250px,secondCol250px">

				<h:outputLabel value="* #{lblIss.customer_number}: "
					title="#{lblIss.customer_number}"
					styleClass="#{MbAppWizOldCustomerContract.customerValid ? 'valid' : 'invalid'}" 
					rendered="#{MbAppWizOldCustomerContract.oldCustomer}"/>
				<h:panelGrid columns="2" cellpadding="0" cellspacing="0" id="customer" 
					rendered="#{MbAppWizOldCustomerContract.oldCustomer}">
					<h:inputText value="#{MbAppWizOldCustomerContract.customerNumber}" style="width: 200px;"
						id="customerNumber" readonly="true"
						 />
					<h:panelGroup>
						<h:graphicImage url="/_img/icon_search.png" styleClass="searchComponent-icon" id="selectCustomer">
									<a4j:support immediate="true" event="onclick" 
										oncomplete="Richfaces.showModalPanel('customerSearchModalPanel');"
										reRender="customerSearchModalPanel" limitToList="true" ajaxSingle="true"
										action="#{MbAppWizOldCustomerContract.initCustomerModal}">
									</a4j:support>
						</h:graphicImage>	
						
						<h:graphicImage url="/_img/icon_clear.png" id="customerClear">
									<a4j:support immediate="true" event="onclick"
										reRender="customer" limitToList="true"
										action="#{MbAppWizOldCustomerContract.clearCustomerNumber}"/>
						</h:graphicImage>
					</h:panelGroup>	
				</h:panelGrid>
				
				<h:outputLabel value="* #{lblApp.customer_type}: "
					title="#{lblApp.customer_type}"
					styleClass="#{MbAppWizOldCustomerContract.customerValid ? 'valid' : 'invalid'}" 
					rendered="#{!MbAppWizOldCustomerContract.oldCustomer}"/>
				<h:panelGrid columns="1" cellpadding="0" cellspacing="0"
					rendered="#{!MbAppWizOldCustomerContract.oldCustomer}">
					<h:selectOneMenu id="customerType"
						value="#{MbAppWizOldCustomerContract.customerType}" label="#{lblApp.customer_type}">
						<f:selectItem itemValue="" />
						<f:selectItems value="#{MbAppWizOldCustomerContract.customerTypes}" />
					</h:selectOneMenu>
					<rich:message for="customerType" styleClass="errorMarker"
						id="customerTypeError" />
				</h:panelGrid>

				<h:outputLabel value="* #{lblPrd.contract_number}: "
					title="#{lblPrd.contract_number}"
					styleClass="#{MbAppWizOldCustomerContract.contractValid ? 'valid' : 'invalid'}" />
				<h:panelGrid columns="2" cellpadding="0" cellspacing="0" id="contract">
					<h:inputText readonly="true"
						value="#{MbAppWizOldCustomerContract.contractNumber}" id="contractNumber"
						readOnly="true" style="width: 200px;"
						/>
					<h:panelGroup>	
						<h:graphicImage url="/_img/icon_search.png" styleClass="searchComponent-icon" id="selectContract">
									<a4j:support immediate="true" event="onclick" 
										oncomplete="Richfaces.showModalPanel('contractsModalPanel');"
										reRender="contractsModalPanel" limitToList="true" ajaxSingle="true"
										action="#{MbAppWizOldCustomerContract.initContractModal}">
									</a4j:support>
						</h:graphicImage>
						<h:graphicImage url="/_img/icon_clear.png" id="contractClear">
									<a4j:support immediate="true" event="onclick"
										reRender="contract" limitToList="true"
										action="#{MbAppWizOldCustomerContract.clearContractNumber}"/>
						</h:graphicImage>
					</h:panelGroup>	
				</h:panelGrid>

				<h:outputLabel value="#{lblApp.app_template}: " title="#{lblApp.app_template}" />
				<h:panelGrid columns="1" cellpadding="0" cellspacing="0">
					<h:selectOneMenu value="#{MbAppWizOldCustomerContract.template}"
						disabled="#{MbAppWizOldCustomerContract.contractNumber == null}"
						id="template" label="#{lblApp.app_template}">
						<f:selectItem itemValue="" />
						<f:selectItems value="#{MbAppWizOldCustomerContract.templates}" />
					</h:selectOneMenu>
				</h:panelGrid>

			</h:panelGrid>

			<ui:include src="/pages/common/application/appWizActions.jspx" />

		</h:form>

		<ui:include src="/pages/common/application/contractsModalPanel.jspx">
			<ui:param name="reRenderList"
				value="appWizOldCustomerContract:contractNumber, appWizOldCustomerContract:template, appWizOldCustomerContract:customerNumber" />
			<ui:param name="beanName" value="MbAppWizOldCustomerContract" />
			<ui:param name="selectMethodName" value="selectContract" />
			<ui:param name="viewIdColon" value="stepPageInclude:" />
		</ui:include>
		<a4j:keepAlive beanName="MbAppWizOldCustomerContract" ajaxOnly="true" />
	</ui:composition>
</html>
