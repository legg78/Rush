<?xml version="1.0" encoding="UTF-8"?>
<html	xmlns="http://www.w3.org/1999/xhtml"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:a4j="http://richfaces.org/a4j"
		xmlns:rich="http://richfaces.org/rich"
		xmlns:bm="http://www.bpc.ru/jsf/misc"
		xmlns:bre="http://www.bpc.ru/jsf/richfaces-ext">
<ui:composition>
	<f:loadBundle var="lblFcl" basename="ru.bpc.sv2.ui.bundles.Fcl"/>
	<f:loadBundle var="lblCommon" basename="ru.bpc.sv2.ui.bundles.Common"/>
	<h:panelGroup id="mainTableWrapper" layout="block"
						styleClass="search_result_block_inner">
    	<rich:extendedDataTable enableContextMenu="false" 
           	id="mainTable"
           	styleClass="res-table" 
           	headerClass="res-table-header"
           	rowClasses=",odd"
           	selectedClass="res-table-selected"  
           	var="item" 
           	value="#{MbLimitsSearch.limits}"
           	selection="#{MbLimitsSearch.itemSelection}"
           	rows="#{MbLimitsSearch.rowsNum}"
           	height="255px"
           	selectionMode="single"
            noDataLabel="#{MbLimitsSearch.searching?lblCommon['no_records_found'] : lblCommon['enter_search_criteria_above']}"
            reRender="limitsBtnPanel:btns_limit, detailsTab">
           
		<a4j:support event="onselectionchange" eventsQueue="queue"
				reRender="limitsBtnPanel:btns_limit, detailsTab" />
           
		<rich:column title="Id" id="id" sortBy="#{'id'}" width="10%">
			<f:facet name="header">
				 <a4j:outputPanel layout="none">
					<script>updateHeight();</script>
					<h:outputText value="#{lblCommon.id}" title="#{lblCommon.id}" />
				</a4j:outputPanel>	
			</f:facet>
			<h:outputText value="#{item.id}" />
		</rich:column>	                   
        
        <rich:column title="Limit type" id="limitType" sortBy="#{'limitType'}" 
        		sortExpression="ASCENDING" width="15%">
			<f:facet name="header">
				<h:outputText value="#{lblFcl.limit_type}" title="#{lblFcl.limit_type}" />
			</f:facet>
			<h:outputText value="#{DictUtils.articles[item.limitType]}" 
					title="#{DictUtils.articles[item.limitType]}"
					rendered="#{item.limitType != null}" />
			<h:outputText value="" title="" rendered="#{item.limitType == null}" />
        </rich:column>
        
        <rich:column title="Cycle id" width="10%">
			<f:facet name="header">
            	<h:outputText value="#{lblFcl.cycle_id}" title="#{lblFcl.cycle_id}" />
			</f:facet>
			<h:outputText value="#{item.cycleId}" />
        </rich:column>
        
        <rich:column title="Count limit" width="10%" sortBy="#{'countLimit'}">
			<f:facet name="header">
            	<h:outputText value="#{lblFcl.count_limit}" title="#{lblFcl.count_limit}" />
			</f:facet>
			<h:outputText value="#{item.countLimit}" />
        </rich:column>
        
        <rich:column title="Sum limit" width="10%" sortBy="#{'sumLimit'}">
			<f:facet name="header">
            	<h:outputText value="#{lblFcl.sum_limit}" title="#{lblFcl.sum_limit}" />
			</f:facet>
			<h:outputText value="#{item.sumLimit}" title="#{item.sumLimit}"
					converter="bpc.CurrencyConverter">
				<f:attribute name="exponent" 
						value="#{CurrencyUtils.currencyObjectsMap[item.currency].exponent}"/>
			</h:outputText>
        </rich:column>
        
        <rich:column title="Currency" width="20%" sortBy="#{'currency'}">
			<f:facet name="header">
				<h:outputText value="#{lblCommon.currency}" title="#{lblCommon.currency}" />
			</f:facet>
			<div class="#{EntityIcons.objectsMapS['ENTT0046'][item.currency]}"/>
			<h:outputText value="#{item.currency} - #{CurrencyUtils.currencyMap[item.currency]}" 
					 title="#{CurrencyUtils.currencyMap[item.currency]}"
					 rendered="#{item.currency != null}" />
			<h:outputText value="" title="" rendered="#{item.currency == null}" />
        </rich:column>

        <rich:column title="Posting method" width="15%" sortBy="#{'postMethod'}">
			<f:facet name="header">
				<h:outputText value="#{lblFcl.post_method}" title="#{lblFcl.post_method}" />
			</f:facet>
			<h:outputText value="#{DictUtils.articles[item.postMethod]}" 
					 title="#{DictUtils.articles[item.postMethod]}"
					 rendered="#{item.postMethod != null}" />
			<h:outputText value="" title="" rendered="#{item.postMethod == null}" />
        </rich:column>

        <rich:column title="InstName" width="10%" sortBy="#{'instName'}">
			<f:facet name="header">
				<h:outputText value="#{lblCommon.institution}" title="#{lblCommon.institution}" />
			</f:facet>
			<bm:entityDisplay  entityId="#{item.instId}"
									value="#{item.instName}"/>
        </rich:column>
       	<f:facet name="footer">
        	
		</f:facet>
    </rich:extendedDataTable>
    </h:panelGroup>
</ui:composition>
</html>
