<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
<ui:composition>
	<h:panelGroup styleClass="crumbs" layout="block">
    	<a4j:repeat value="#{menu.currentNode.ancestorPath}" var="item" first="0" rows="1">
           	<h:outputText styleClass="crumbsbegin" value="#{item}"/>
        </a4j:repeat>
        <a4j:repeat value="#{menu.currentNode.ancestorPath}" var="item" first="1">
           	<h:panelGroup id="end_crumb"><h:outputText value="#{item}"/></h:panelGroup>
        </a4j:repeat>
        <a4j:repeat value="#{menu.currentRoute}" var="item">
       		<h:panelGroup id="end_crumb">
       			<h:outputText value="#{item.pageName}"/>
       		</h:panelGroup>
		</a4j:repeat>
		<h:panelGroup id="end_crumb1" rendered="#{not empty menu.currentNode.name and (empty menu.currentRoute or not overridePageName)}">
        	<h:outputText value="#{menu.currentNode.name}"/>
        </h:panelGroup>
		<h:panelGroup id="end_crumb2" rendered="#{empty menu.currentNode.name or not empty menu.currentRoute or overridePageName}">
        	<h:outputText value="#{pageName}"/>
        </h:panelGroup>
		<h:panelGroup id="end_crumb3" rendered="#{not empty appendix}">
        	<h:outputText value="#{appendix}"/>
        </h:panelGroup>        
	</h:panelGroup>
	<h:panelGroup layout="block">
		<a4j:form id="add_fav_form">
		<h:inputHidden id="currentSectionId" value="#{param['sectionId']}"/>		
		<h:inputHidden id="currentSectionIdSubmit" value="#{menu.currentSectionId}"/>
		
		<a4j:commandLink action="#{favs.saveToFavourites}" style="#{(param['sectionId'] == null or menu.favourites[param['sectionId']]==true)?'display:none':'display:inline'}"
				id="addToFavs" oncomplete="rerenderFavourites();this.style.display = 'none';$('add_fav_form:removeFromFavs').style.display = 'inline'" 
				value="#{lblCommon.add_to_bookmarks}" ajaxSingle="true" limitToList="true"
				styleClass="addfavoritslink"
				reRender="favouritesMenu, favoritesForm" 
				process="add_fav_form:currentSectionIdSubmit" 
				onclick="$('add_fav_form:currentSectionIdSubmit').value = $('add_fav_form:currentSectionId').value;">				
			<a4j:actionparam assignTo="#{favs.currentPageName}" value="${pageName}"></a4j:actionparam>
		</a4j:commandLink>
		
		<a4j:commandLink action="#{favs.removeFromFavourites}" style="#{(menu.favourites[param['sectionId']]==null or menu.favourites[param['sectionId']]==false)?'display:none':'display:inline'}"
				id="removeFromFavs" oncomplete="rerenderFavourites();$('add_fav_form:addToFavs').style.display = 'inline';this.style.display = 'none'" 
				value="#{lblCommon.remove_from_bookmarks}" ajaxSingle="true" limitToList="true"
				reRender="favouritesMenu, favoritesForm"
				styleClass="addfavoritslink removefavoritslink" 
				onclick="$('add_fav_form:currentSectionIdSubmit').value = $('add_fav_form:currentSectionId').value;"
				process="add_fav_form:currentSectionIdSubmit">							
		</a4j:commandLink>
		
		</a4j:form>
		
		<h:commandLink action="changeLocale" id="LANGENG" rendered="false"
				>
			<h:outputText value=" Eng"/>
		</h:commandLink>
		<h:commandLink action="changeLocale" id="LANGRUS" rendered="false"
				>
			<h:outputText value=" Rus"/>
		</h:commandLink>
	</h:panelGroup>
	
</ui:composition>
</html>